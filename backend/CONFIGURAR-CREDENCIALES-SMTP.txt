â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONFIGURACIÃ“N DE CREDENCIALES SMTP - SISTEMA DE EMAILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“§ TODAS LAS INSTANCIAS QUE NECESITAN CONFIGURACIÃ“N

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
INSTANCIA 1: EMAILS DE LA PLATAFORMA APONNT (4 tipos)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ UBICACIÃ“N: Tabla "aponnt_email_config" en PostgreSQL

ğŸ”§ COMANDO PARA ACTUALIZAR (ejecutar en node):
-----------------------------------------------------------------

cd C:\Bio\sistema_asistencia_biometrico\backend

node -e "
const { sequelize } = require('./src/config/database');
(async () => {
  await sequelize.authenticate();

  // 1. TRANSACCIONAL (noreply@aponnt.com)
  await sequelize.query(\`
    UPDATE aponnt_email_config
    SET smtp_password = 'TU_APP_PASSWORD_AQUI'
    WHERE config_type = 'transactional'
  \`);

  // 2. SOPORTE (soporte@aponnt.com)
  await sequelize.query(\`
    UPDATE aponnt_email_config
    SET smtp_password = 'TU_APP_PASSWORD_AQUI'
    WHERE config_type = 'support'
  \`);

  // 3. FACTURACIÃ“N (facturacion@aponnt.com)
  await sequelize.query(\`
    UPDATE aponnt_email_config
    SET smtp_password = 'TU_APP_PASSWORD_AQUI'
    WHERE config_type = 'billing'
  \`);

  // 4. MARKETING (marketing@aponnt.com)
  await sequelize.query(\`
    UPDATE aponnt_email_config
    SET smtp_password = 'TU_APP_PASSWORD_AQUI'
    WHERE config_type = 'marketing'
  \`);

  console.log('âœ… Passwords actualizados');
  await sequelize.close();
})();
"

-----------------------------------------------------------------

ğŸ“ ALTERNATIVA SQL DIRECTA (si tenÃ©s psql):
-----------------------------------------------------------------

psql postgresql://postgres:Aedr15150302@localhost:5432/attendance_system

-- Luego ejecutar:

UPDATE aponnt_email_config
SET smtp_password = 'TU_APP_PASSWORD'
WHERE config_type = 'transactional';

UPDATE aponnt_email_config
SET smtp_password = 'TU_APP_PASSWORD'
WHERE config_type = 'support';

UPDATE aponnt_email_config
SET smtp_password = 'TU_APP_PASSWORD'
WHERE config_type = 'billing';

UPDATE aponnt_email_config
SET smtp_password = 'TU_APP_PASSWORD'
WHERE config_type = 'marketing';

-----------------------------------------------------------------


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
INSTANCIA 2: EMAIL DE CADA EMPRESA (ISI, Cliente A, B, C...)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ UBICACIÃ“N: Tabla "email_configurations" en PostgreSQL

ğŸ”§ OPCIÃ“N A - VIA API REST (Recomendado):
-----------------------------------------------------------------

curl -X POST http://localhost:9998/api/email/config/company \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <TU_ADMIN_TOKEN>" \
  -d '{
    "company_id": 1,
    "institutional_email": "noreply@isi.com.ar",
    "display_name": "ISI - Sistema de Asistencia",
    "smtp_host": "smtp.gmail.com",
    "smtp_port": 587,
    "smtp_user": "noreply@isi.com.ar",
    "smtp_password": "app-password-de-isi",
    "daily_limit": 500,
    "monthly_limit": 10000
  }'

-----------------------------------------------------------------

ğŸ”§ OPCIÃ“N B - VIA NODE SCRIPT:
-----------------------------------------------------------------

cd C:\Bio\sistema_asistencia_biometrico\backend

node -e "
const { sequelize } = require('./src/config/database');
(async () => {
  await sequelize.authenticate();

  await sequelize.query(\`
    INSERT INTO email_configurations (
        company_id, institutional_email, display_name,
        smtp_host, smtp_port, smtp_user, smtp_password,
        is_verified, is_active, verified_at,
        daily_limit, monthly_limit, created_at
    ) VALUES (
        1,
        'noreply@isi.com.ar',
        'ISI - Sistema de Asistencia',
        'smtp.gmail.com',
        587,
        'noreply@isi.com.ar',
        'PASSWORD_DE_ISI_AQUI',
        true, true, NOW(),
        500, 10000, NOW()
    ) ON CONFLICT (company_id) DO UPDATE SET
        smtp_password = EXCLUDED.smtp_password,
        updated_at = NOW()
  \`);

  console.log('âœ… Email de empresa configurado');
  await sequelize.close();
})();
"

-----------------------------------------------------------------


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CÃ“MO OBTENER APP PASSWORD DE GMAIL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. IR A: https://myaccount.google.com/apppasswords

2. LOGIN con tu cuenta de Gmail

3. SELECCIONAR:
   - App: "Mail"
   - Device: "Other (Custom name)" â†’ escribir "Aponnt Backend"

4. CLICK en "Generate"

5. COPIAR el password de 16 caracteres
   Ejemplo: "abcd efgh ijkl mnop"

6. USAR ese password en los comandos de arriba (sin espacios)

âš ï¸ IMPORTANTE: NO usar tu password normal de Gmail, solo el App Password


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
OTROS PROVEEDORES SMTP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“§ OUTLOOK/HOTMAIL:
   smtp_host: smtp-mail.outlook.com
   smtp_port: 587
   smtp_user: tu-email@outlook.com
   smtp_password: App password de Outlook

ğŸ“§ SENDGRID:
   smtp_host: smtp.sendgrid.net
   smtp_port: 587
   smtp_user: apikey
   smtp_password: TU_API_KEY_DE_SENDGRID

ğŸ“§ AWS SES:
   smtp_host: email-smtp.us-east-1.amazonaws.com
   smtp_port: 587
   smtp_user: TU_SMTP_USERNAME_DE_AWS
   smtp_password: TU_SMTP_PASSWORD_DE_AWS


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VALIDAR CONFIGURACIÃ“N
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Una vez configuradas las credenciales, probar con:

curl -X POST http://localhost:9998/api/email/config/validate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <TOKEN>" \
  -d '{
    "smtp_host": "smtp.gmail.com",
    "smtp_port": 587,
    "smtp_user": "noreply@aponnt.com",
    "smtp_password": "tu-app-password",
    "from_email": "noreply@aponnt.com",
    "display_name": "Aponnt Sistema",
    "test_recipient_email": "tu-email-personal@gmail.com"
  }'

âœ… SI FUNCIONA verÃ¡s:
{
  "success": true,
  "message": "ConfiguraciÃ³n SMTP vÃ¡lida",
  "testEmailSent": true
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RESUMEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INSTANCIA 1: Tabla aponnt_email_config
         â”œâ”€â”€ transactional (noreply@aponnt.com)
         â”œâ”€â”€ support (soporte@aponnt.com)
         â”œâ”€â”€ billing (facturacion@aponnt.com)
         â””â”€â”€ marketing (marketing@aponnt.com)

INSTANCIA 2: Tabla email_configurations
         â””â”€â”€ 1 configuraciÃ³n por cada empresa (ISI, Cliente A, B, C...)

TOTAL: 4 configs de Aponnt + N configs de empresas


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FIN DEL DOCUMENTO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
