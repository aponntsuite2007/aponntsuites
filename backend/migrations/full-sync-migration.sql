ALTER TABLE "UserShifts" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "UserShifts" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "UserShifts" ADD COLUMN IF NOT EXISTS "UserUserId" UUID;
ALTER TABLE "UserShifts" ADD COLUMN IF NOT EXISTS "ShiftId" UUID;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "query" TEXT;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "query_normalized" TEXT;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "results_count" INTEGER DEFAULT 0;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "results_summary" JSONB;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "clicked_result_id" TEXT;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "clicked_result_source" VARCHAR(50);
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "clicked_result_position" INTEGER;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "was_helpful" BOOLEAN;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "feedback_comment" TEXT;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "search_time_ms" INTEGER;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "user_department_id" INTEGER;
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "search_context" VARCHAR(50);
ALTER TABLE "a_mi_me_paso_searches" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "absence_type" VARCHAR(50);
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "requested_days" INTEGER;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "approved_days" INTEGER;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "assigned_doctor_id" UUID;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "assignment_date" TIMESTAMP;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "case_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "certificate_id" INTEGER;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "employee_description" TEXT;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "employee_attachments" JSONB DEFAULT '[]';
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "medical_conclusion" TEXT;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "final_diagnosis" TEXT;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "is_justified" BOOLEAN;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "justification_reason" TEXT;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "doctor_response_date" TIMESTAMP;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "case_closed_date" TIMESTAMP;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "closed_by" UUID;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "notify_art" BOOLEAN DEFAULT false;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "art_notified" BOOLEAN DEFAULT false;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "art_notification_date" TIMESTAMP;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "art_case_number" VARCHAR(100);
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "last_modified_by" UUID;
ALTER TABLE "absence_cases" ADD COLUMN IF NOT EXISTS "notification_group_id" UUID;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "requested_action" VARCHAR(20);
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "was_allowed" BOOLEAN;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "denial_reason" TEXT;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "resource_type" VARCHAR(50);
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "resource_id" VARCHAR(100);
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "request_path" TEXT;
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "access_audit_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(50);
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "recipient_user_id" UUID;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "related_visitor_id" INTEGER;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "related_user_id" UUID;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "related_kiosk_id" INTEGER;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "related_attendance_id" UUID;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN DEFAULT false;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMPTZ;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "action_taken" BOOLEAN DEFAULT false;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(100);
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "action_notes" TEXT;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "action_taken_by" UUID;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "action_taken_at" TIMESTAMPTZ;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMPTZ;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "access_notifications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "role_key" VARCHAR(50);
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "role_name" VARCHAR(100);
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "category" TEXT DEFAULT 'otros';
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10) DEFAULT 'üè∑Ô∏è';
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "color" VARCHAR(20) DEFAULT '#6c757d';
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "requires_certification" BOOLEAN DEFAULT false;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "certification_validity_months" INTEGER DEFAULT 12;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "scoring_bonus" NUMERIC(3,2) DEFAULT 0.05;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "required_training" JSONB DEFAULT '[]';
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "responsibilities" JSONB DEFAULT '[]';
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "additional_role_types" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "task_type" VARCHAR(100);
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "task_category" VARCHAR(50) DEFAULT 'ONBOARDING';
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'NORMAL';
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "related_entity_type" VARCHAR(50);
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "related_entity_id" UUID;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "instructions" TEXT;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "context_data" JSONB;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "attachments" JSONB;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "assigned_to" UUID;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "escalation_date" DATE;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'PENDING';
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "resolution" VARCHAR(50);
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "resolution_notes" TEXT;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "resolved_by" UUID;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMP;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMP;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "reminder_count" INTEGER DEFAULT 0;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "last_reminder_at" TIMESTAMP;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50) DEFAULT 'SYSTEM';
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "administrative_tasks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "service" VARCHAR(50);
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "token_hash" VARCHAR(64);
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "sign_hash" VARCHAR(64);
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "generation_time" TIMESTAMP;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "expiration_time" TIMESTAMP;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "tra_xml" TEXT;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "response_xml" TEXT;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "success" BOOLEAN DEFAULT false;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "environment" VARCHAR(20);
ALTER TABLE "afip_auth_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "punto_venta" INTEGER;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "tipo_comprobante" INTEGER;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "numero_comprobante" BIGINT;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "cae" VARCHAR(14);
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "cae_vencimiento" DATE;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "request_xml" TEXT;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "response_xml" TEXT;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "resultado" VARCHAR(1);
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "fecha_proceso" DATE;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "errores" TEXT;
ALTER TABLE "afip_cae_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "task_code" VARCHAR(50);
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "task_type" VARCHAR(50);
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'MEDIUM';
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "due_date" TIMESTAMP;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "assigned_to" INTEGER;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "assigned_role" VARCHAR(50);
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'PENDING';
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "completed_by" INTEGER;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "completion_notes" TEXT;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "aponnt_admin_tasks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "secondary_phone" VARCHAR(50);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(20);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "photo_url" TEXT;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "bio" TEXT;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "linkedin_url" VARCHAR(255);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "category" TEXT;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "specialty" VARCHAR(200);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "sub_specialties" TEXT[];
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "license_number" VARCHAR(100);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "license_issuer" VARCHAR(100);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "license_expiry" DATE;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "certifications" JSONB DEFAULT '[]';
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "availability" JSONB DEFAULT '{}';
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "service_regions" TEXT[] DEFAULT '{}';
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "remote_available" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "hourly_rate" NUMERIC(10,2);
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "payment_terms" TEXT;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "rating_average" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "rating_count" INTEGER DEFAULT 0;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "contracts_completed" INTEGER DEFAULT 0;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "active_contracts" INTEGER DEFAULT 0;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "verification_notes" TEXT;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "is_featured" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "tags" TEXT[] DEFAULT '{}';
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_associates" ADD COLUMN IF NOT EXISTS "password_hash" VARCHAR(255) DEFAULT NULL;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "email_type" VARCHAR(50);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "from_email" VARCHAR(255);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "from_name" VARCHAR(255);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "reply_to" VARCHAR(255);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "smtp_host" VARCHAR(255);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "smtp_port" INTEGER;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "smtp_user" VARCHAR(255);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "smtp_password" TEXT;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "smtp_secure" BOOLEAN DEFAULT true;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "app_password" TEXT;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "recovery_phone" VARCHAR(50);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "backup_email" VARCHAR(255);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "last_test_at" TIMESTAMP;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "test_status" VARCHAR(50);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "aponnt_email_config" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "contract_id" UUID;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "budget_id" UUID;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "pre_invoice_code" VARCHAR(50);
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "cliente_cuit" VARCHAR(15);
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "cliente_razon_social" VARCHAR(255);
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "cliente_condicion_iva" VARCHAR(50) DEFAULT 'RI';
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "cliente_domicilio_fiscal" TEXT;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "cliente_email" VARCHAR(255);
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "items" JSONB DEFAULT '[]';
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "periodo_desde" DATE;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "periodo_hasta" DATE;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "descuento_porcentaje" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "descuento_importe" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "neto_gravado" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "iva_21" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "iva_10_5" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "iva_27" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "otros_impuestos" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "condicion_venta" VARCHAR(50) DEFAULT 'CTA_CTE';
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'PENDING_REVIEW';
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "invoiced_at" TIMESTAMP;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "invoiced_by" INTEGER;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMP;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "rejected_by" INTEGER;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "observations" TEXT;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "admin_notes" TEXT;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "aponnt_pre_invoices" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100) DEFAULT 'SYSTEM';
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "staff_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(20);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(50);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "role_id" UUID;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "reports_to_staff_id" UUID;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "country" VARCHAR(2);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "nationality" VARCHAR(2);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "level" INTEGER;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "area" VARCHAR(50);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "language_preference" VARCHAR(2) DEFAULT 'es';
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "contract_type" VARCHAR(20);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "hire_date" DATE;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "termination_date" DATE;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(50);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "bank_account_type" VARCHAR(20);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "accepts_support_packages" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "accepts_auctions" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "whatsapp_number" VARCHAR(50);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "global_rating" NUMERIC(3,2) DEFAULT 0.00;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "updated_by" UUID;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "pyramid_commission_percentage_override" NUMERIC(5,2) DEFAULT NULL;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "alias_cbu" VARCHAR(100);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "account_type" VARCHAR(50);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "account_number" VARCHAR(100);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "payment_method_preference" VARCHAR(50) DEFAULT 'TRANSFERENCIA';
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "virtual_wallet_provider" VARCHAR(100);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "virtual_wallet_account" VARCHAR(255);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(50);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "tax_condition" VARCHAR(100);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "accepts_electronic_payment" BOOLEAN DEFAULT true;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "bank_data_verified" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "bank_data_verified_at" TIMESTAMP;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "bank_data_verified_by" UUID;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "profile_photo" VARCHAR(500);
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "password" VARCHAR(255) DEFAULT NULL;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "username" VARCHAR(100) DEFAULT NULL;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "last_login_at" TIMESTAMP;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "first_login" BOOLEAN DEFAULT true;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "biometric_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_staff" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(50) DEFAULT NULL;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "staff_id" UUID;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "assignment_note" TEXT;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "deactivated_at" TIMESTAMP;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "deactivated_by" UUID;
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_staff_companies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "role_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "role_code" VARCHAR(10);
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "role_name" VARCHAR(100);
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "role_name_i18n" JSONB DEFAULT '{}';
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "role_area" VARCHAR(50);
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "level" INTEGER;
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "is_sales_role" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "is_country_specific" BOOLEAN DEFAULT false;
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "reports_to_role_code" VARCHAR(10);
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "responsibilities" JSONB DEFAULT '[]';
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "aponnt_staff_roles" ADD COLUMN IF NOT EXISTS "pyramid_commission_percentage" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "notification_group_id" UUID;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "employee_1_id" VARCHAR(100);
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "employee_2_id" VARCHAR(100);
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "swap_date" DATE;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "original_shift_id" INTEGER;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "replacement_shift_id" INTEGER;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'approved';
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "employee_1_can_clock" BOOLEAN DEFAULT false;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "employee_2_can_clock" BOOLEAN DEFAULT true;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "generates_overtime" BOOLEAN DEFAULT false;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "overtime_hours" NUMERIC(5,2);
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "violates_rest_period" BOOLEAN DEFAULT false;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "art_notified" BOOLEAN DEFAULT false;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "art_notified_at" TIMESTAMP;
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "art_reference" VARCHAR(100);
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP DEFAULT now();
ALTER TABLE "approved_shift_swaps" ADD COLUMN IF NOT EXISTS "executed_at" TIMESTAMP;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "artName" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "artCode" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "primaryContactName" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "primaryContactRole" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "whatsappNumber" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "emergencyPhone" VARCHAR(255);
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "notificationPreferences" JSON DEFAULT '{"whatsapp":true,"sms":false,"email":true}';
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "notificationTriggers" JSON DEFAULT '{"accidents":true,"occupational_diseases":true,"work_related_injuries":true,"long_absences":true,"recurring_cases":true}';
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "thresholds" JSON DEFAULT '{"long_absence_days":15,"recurring_case_count":3,"recurring_case_period_months":6}';
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "businessHours" JSON DEFAULT '{"start":"08:00","end":"18:00","timezone":"America/Argentina/Buenos_Aires"}';
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "companyId" UUID;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "lastNotificationSent" TIMESTAMPTZ;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "totalNotificationsSent" INTEGER DEFAULT 0;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "customFields" JSON;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "art_configurations" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "asset_assignment_id" INTEGER;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "contract_type" VARCHAR(30);
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "contract_number" VARCHAR(100);
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "contract_start_date" DATE;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "contract_end_date" DATE;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "dms_contract_document_id" INTEGER;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "contract_file_path" VARCHAR(500);
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "terms_and_conditions" TEXT;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "employee_signature_date" DATE;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "company_signature_date" DATE;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "employee_signed_by" UUID;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "company_signed_by" UUID;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "termination_date" DATE;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "termination_reason" TEXT;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "generated_html" TEXT;
ALTER TABLE "asset_contracts" ADD COLUMN IF NOT EXISTS "generated_variables" JSONB DEFAULT '{}';
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "action_pattern" TEXT;
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(100);
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "handler_service" VARCHAR(100);
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "handler_method" VARCHAR(100);
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "required_params" JSONB DEFAULT '[]';
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "required_role" TEXT[] DEFAULT '{}';
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "examples" JSONB DEFAULT '[]';
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "execution_count" INTEGER DEFAULT 0;
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "last_executed_at" TIMESTAMP;
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "assistant_action_handlers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "question" TEXT;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "answer" TEXT;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "knowledge_entry_id" UUID;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "context" JSONB DEFAULT '{}';
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "screen_name" VARCHAR(100);
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "answer_source" VARCHAR(50) DEFAULT 'ollama';
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "confidence" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "response_time_ms" INTEGER;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "helpful" BOOLEAN;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "feedback_comment" TEXT;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "feedback_at" TIMESTAMPTZ;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "diagnostic_triggered" BOOLEAN DEFAULT false;
ALTER TABLE "assistant_conversations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "user_role" VARCHAR(50);
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "question" TEXT;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "question_normalized" TEXT;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "context" JSONB;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "answer" TEXT;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "answer_source" VARCHAR(50) DEFAULT 'ollama';
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "model_used" VARCHAR(100) DEFAULT 'llama3.1:8b';
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "tokens_used" INTEGER;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "response_time_ms" INTEGER;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(3,2);
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "diagnostic_triggered" BOOLEAN DEFAULT false;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "diagnostic_execution_id" UUID;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "diagnostic_results" JSONB;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "suggested_actions" JSONB;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "quick_replies" JSONB;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "helpful" BOOLEAN;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "feedback_comment" TEXT;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "feedback_at" TIMESTAMP;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "reused_count" INTEGER DEFAULT 0;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "improved_answer" TEXT;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "verified_by_admin" UUID;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "assistant_knowledge_base" ADD COLUMN IF NOT EXISTS "feedback_text" TEXT;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "contract_id" INTEGER;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "assignment_reason" TEXT;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "assignment_type" VARCHAR(50) DEFAULT 'manual';
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP DEFAULT now();
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "deactivated_at" TIMESTAMP;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "deactivated_by" UUID;
ALTER TABLE "associate_employee_assignments" ADD COLUMN IF NOT EXISTS "deactivation_reason" TEXT;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "cache_key" VARCHAR(255);
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "cache_type" VARCHAR(50);
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "dimension_1" VARCHAR(50);
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "dimension_1_value" VARCHAR(255);
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "dimension_2" VARCHAR(50);
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "dimension_2_value" VARCHAR(255);
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "cached_data" JSONB;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "calculated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "hit_count" INTEGER DEFAULT 0;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "last_hit_at" TIMESTAMP;
ALTER TABLE "attendance_analytics_cache" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "pattern_id" VARCHAR(50);
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "pattern_name" VARCHAR(255);
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "pattern_category" VARCHAR(50);
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "detection_date" DATE;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "occurrences_count" INTEGER DEFAULT 1;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "detection_period_start" DATE;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "detection_period_end" DATE;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "threshold_value" NUMERIC(10,2);
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "actual_value" NUMERIC(10,2);
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "scoring_impact" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN DEFAULT false;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "action_taken" TEXT;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "action_taken_at" TIMESTAMP;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "action_taken_by" UUID;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMP;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "attendance_patterns" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(50);
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "department_id" BIGINT;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "shift_id" BIGINT;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "branch_id" BIGINT;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "scoring_total" NUMERIC(5,2) DEFAULT 100.00;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "scoring_punctuality" NUMERIC(5,2) DEFAULT 100.00;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "scoring_absence" NUMERIC(5,2) DEFAULT 100.00;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "scoring_late_arrival" NUMERIC(5,2) DEFAULT 100.00;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "scoring_early_departure" NUMERIC(5,2) DEFAULT 100.00;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "total_days" INTEGER DEFAULT 0;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "present_days" INTEGER DEFAULT 0;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "absent_days" INTEGER DEFAULT 0;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "late_arrivals_count" INTEGER DEFAULT 0;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "early_departures_count" INTEGER DEFAULT 0;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "tolerance_usage_rate" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "avg_late_minutes" INTEGER DEFAULT 0;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "overtime_hours_total" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "active_patterns" TEXT[];
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "positive_patterns" TEXT[];
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "negative_patterns" TEXT[];
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "last_calculated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "calculation_period_start" DATE;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "calculation_period_end" DATE;
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "profile_category" VARCHAR(50);
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "attendance_profiles" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "date" DATE;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "checkInTime" TIMESTAMPTZ;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "checkOutTime" TIMESTAMPTZ;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "checkInMethod" TEXT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "checkOutMethod" TEXT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "workingHours" NUMERIC(4,2) DEFAULT 0;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "status" TEXT DEFAULT 'present';
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "BranchId" UUID;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "UserId" UUID;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "authorization_status" VARCHAR(20);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "authorization_token" VARCHAR(255);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "authorized_by_user_id" UUID;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "authorized_at" TIMESTAMP;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "authorization_notes" TEXT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "notified_authorizers" JSONB DEFAULT '[]';
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "authorization_requested_at" TIMESTAMP;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "kiosk_id" INTEGER;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "origin_type" VARCHAR(20) DEFAULT 'kiosk';
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "break_out" TIMESTAMP;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "break_in" TIMESTAMP;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "is_justified" BOOLEAN DEFAULT false;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "absence_type" VARCHAR(50);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "absence_reason" TEXT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "justified_by" UUID;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "justified_at" TIMESTAMPTZ;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "medical_certificate_id" INTEGER;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "check_in_latitude" NUMERIC(10,8);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "check_in_longitude" NUMERIC(11,8);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "check_in_accuracy" NUMERIC(6,2);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "check_out_latitude" NUMERIC(10,8);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "check_out_longitude" NUMERIC(11,8);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "check_out_accuracy" NUMERIC(6,2);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(50);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "checkInLocation" VARCHAR(255);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "checkOutLocation" VARCHAR(255);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "clock_in_location" TEXT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "clock_out_location" TEXT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "clock_in_ip" VARCHAR(45);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "clock_out_ip" VARCHAR(45);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "break_time" INTEGER DEFAULT 0;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "overtime_hours" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "approved_by" BIGINT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "is_processed" BOOLEAN DEFAULT false;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "processing_queue" INTEGER;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "work_date" DATE;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "department_id" BIGINT;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "is_late" BOOLEAN DEFAULT false;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "minutes_late" INTEGER DEFAULT 0;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "authorization_id" UUID;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "weather_pattern" VARCHAR(20) DEFAULT 'UNKNOWN';
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "weather_temperature" NUMERIC(5,2) DEFAULT NULL;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "weather_condition" VARCHAR(30) DEFAULT NULL;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "weather_is_night" BOOLEAN DEFAULT false;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "weather_captured_at" TIMESTAMPTZ;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "overtime_destination" VARCHAR(20);
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "hour_bank_transaction_id" INTEGER;
ALTER TABLE "attendances" ADD COLUMN IF NOT EXISTS "shift_id" UUID;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "action" VARCHAR(100);
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "module_id" VARCHAR(50);
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "entity_id" VARCHAR(100);
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "old_values" JSONB;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "new_values" JSONB;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "session_id" VARCHAR(100);
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "success" BOOLEAN DEFAULT true;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "audit_logs" ADD COLUMN IF NOT EXISTS "test_description" TEXT;
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "report_type" VARCHAR(50);
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "generated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "generated_by" VARCHAR(100);
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "parameters" JSONB;
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "digital_signature" VARCHAR(64);
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "verification_code" VARCHAR(32);
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "file_path" VARCHAR(255);
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "file_size_bytes" INTEGER;
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'generated';
ALTER TABLE "audit_reports" ADD COLUMN IF NOT EXISTS "is_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "execution_id" UUID;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "test_name" VARCHAR(200);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "test_type" VARCHAR(50) DEFAULT 'e2e';
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "test_category" VARCHAR(100);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "duration_ms" INTEGER;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "error_type" VARCHAR(100);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "error_stack" TEXT;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "screenshot_path" VARCHAR(500);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "fix_attempted" BOOLEAN DEFAULT false;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "fix_strategy" VARCHAR(100);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "fix_code" TEXT;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "fix_applied" BOOLEAN DEFAULT false;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "fix_successful" BOOLEAN;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "environment" VARCHAR(50) DEFAULT 'local';
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "triggered_by" VARCHAR(50) DEFAULT 'manual';
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "test_description" TEXT;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "error_file" VARCHAR(500);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "error_line" INTEGER;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "error_context" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "endpoint" VARCHAR(500);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "http_method" VARCHAR(10);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "request_body" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "request_headers" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "response_status" INTEGER;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "response_body" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "response_time_ms" INTEGER;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "metrics" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "fix_result" VARCHAR(50);
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "suggestions" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "test_data" JSONB;
ALTER TABLE "audit_test_logs" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "failure_type" VARCHAR(50);
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "stdout" TEXT;
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "stderr" TEXT;
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "is_known_issue" BOOLEAN DEFAULT false;
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "auto_fixed" BOOLEAN DEFAULT false;
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "fix_applied_at" TIMESTAMPTZ;
ALTER TABLE "autonomous_qa_failures" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "autonomous_qa_healings" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "autonomous_qa_healings" ADD COLUMN IF NOT EXISTS "failure_id" INTEGER;
ALTER TABLE "autonomous_qa_healings" ADD COLUMN IF NOT EXISTS "healing_type" VARCHAR(100);
ALTER TABLE "autonomous_qa_healings" ADD COLUMN IF NOT EXISTS "healing_description" TEXT;
ALTER TABLE "autonomous_qa_healings" ADD COLUMN IF NOT EXISTS "success" BOOLEAN;
ALTER TABLE "autonomous_qa_healings" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "autonomous_qa_healings" ADD COLUMN IF NOT EXISTS "applied_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "db_active_connections" INTEGER;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "db_total_connections" INTEGER;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "db_max_connections" INTEGER;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "db_pool_usage_percent" NUMERIC(5,2);
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "memory_total" BIGINT;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "memory_used" BIGINT;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "memory_free" BIGINT;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "memory_usage_percent" NUMERIC(5,2);
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "cpu_cores" INTEGER;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "cpu_usage_percent" NUMERIC(5,2);
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "is_healthy" BOOLEAN;
ALTER TABLE "autonomous_qa_health" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "autonomous_qa_stats" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "autonomous_qa_stats" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "autonomous_qa_stats" ADD COLUMN IF NOT EXISTS "modules_tested" INTEGER;
ALTER TABLE "autonomous_qa_stats" ADD COLUMN IF NOT EXISTS "passed" INTEGER;
ALTER TABLE "autonomous_qa_stats" ADD COLUMN IF NOT EXISTS "failed" INTEGER;
ALTER TABLE "autonomous_qa_stats" ADD COLUMN IF NOT EXISTS "success_rate" NUMERIC(5,2);
ALTER TABLE "autonomous_qa_stats" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "employee_benefit_id" INTEGER;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "workflow_id" INTEGER;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "approval_level" INTEGER;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "approver_user_id" UUID;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "decision" VARCHAR(30);
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "decision_date" TIMESTAMP;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "decision_notes" TEXT;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMP;
ALTER TABLE "benefit_approval_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "benefit_type_id" INTEGER;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "approval_level" INTEGER;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "approver_type" VARCHAR(30);
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "approver_role_id" INTEGER;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "approver_user_id" UUID;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "approval_logic" VARCHAR(10) DEFAULT 'ALL';
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "sequence_order" INTEGER;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "timeout_days" INTEGER DEFAULT 7;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "auto_approve_on_timeout" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_approval_workflows" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "benefit_type_id" INTEGER;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "document_type_id" INTEGER;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "requires_renewal" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "renewal_frequency_months" INTEGER;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "validate_on_assignment" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "validate_on_renewal" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "alert_days_before_expiration" INTEGER DEFAULT 30;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "requirements_description" TEXT;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_document_requirements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "employee_benefit_id" INTEGER;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "allowance_type" VARCHAR(30);
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "max_quantity" INTEGER;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "consumed_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "consumed_quantity" INTEGER DEFAULT 0;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "auto_renew" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'active';
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_expense_allowances" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "allowance_id" INTEGER;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "expense_type" VARCHAR(50);
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "expense_date" DATE;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(15,2);
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "quantity" INTEGER DEFAULT 1;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "supporting_documents" JSONB DEFAULT '[]';
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "verification_status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "verification_notes" TEXT;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "reimbursement_status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "reimbursement_date" DATE;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "reimbursement_amount" NUMERIC(15,2);
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_expense_submissions" ADD COLUMN IF NOT EXISTS "submitted_by" UUID;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "benefit_type_id" INTEGER;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "payroll_concept_type_id" INTEGER;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "application_condition" VARCHAR(50);
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "fixed_amount" NUMERIC(15,2);
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "percentage_of_benefit" NUMERIC(5,2);
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "min_amount" NUMERIC(15,2);
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "auto_apply_in_payroll" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "require_valid_documents" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_payroll_concepts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(150);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(150);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "benefit_nature" VARCHAR(30);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "recurrence_period" VARCHAR(20);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "approval_levels" INTEGER DEFAULT 1;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "requires_documentation" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "is_taxable" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "affects_salary_base" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "has_max_limit" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "default_max_amount" NUMERIC(15,2);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "default_max_quantity" INTEGER;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "has_expiration" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "default_duration_months" INTEGER;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "requires_renewal" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "renewal_advance_days" INTEGER DEFAULT 30;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "alert_days_before_expiration" TEXT[] DEFAULT ARRAY[30, 15, 7, 1];
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "integrates_with_payroll" BOOLEAN DEFAULT false;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "payroll_concept_type_id" INTEGER;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7);
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "benefit_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "template_id" UUID;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "emotion_analysis" JSONB;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "emotion_confidence" NUMERIC(5,4);
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "behavior_patterns" JSONB;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "behavior_confidence" NUMERIC(5,4);
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "facial_features" JSONB;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "facial_landmarks" JSONB;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "health_indicators" JSONB;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "fatigue_score" NUMERIC(5,4);
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "stress_score" NUMERIC(5,4);
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "processed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "processing_time_ms" INTEGER;
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "analysis_version" VARCHAR(20) DEFAULT '1.0.0';
ALTER TABLE "biometric_ai_analysis" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "alert_id" BIGINT;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "tenant_id" INTEGER;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "user_id" BIGINT;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "scan_id" BIGINT;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "alert_type" VARCHAR(50);
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "recommendations" JSONB;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "acknowledged_by" VARCHAR(100);
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMPTZ;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMPTZ;
ALTER TABLE "biometric_alerts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "measurement_date" DATE;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "department_id" TEXT;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "shift_id" TEXT;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "aggregation_level" VARCHAR(50) DEFAULT 'department_shift';
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "sample_size" INTEGER DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(3,2) DEFAULT 0.80;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "fatigue_level" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "stress_level" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "wellbeing_index" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_neutral" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_happy" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_sad" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_angry" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_surprised" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_fearful" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_disgusted" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "emotion_contempt" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "weather_impact" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "day_impact" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "seasonal_impact" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "holiday_impact" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_analytics_aggregated" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "employee_id" TEXT;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "performed_by" TEXT;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "user_name" TEXT;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "old_employee_id" TEXT;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "new_employee_id" TEXT;
ALTER TABLE "biometric_audit_log" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "kiosk_id" INTEGER;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "attempt_number" INTEGER;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "success" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "failure_reason" VARCHAR(100);
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "quality_score" INTEGER;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "processing_time_ms" INTEGER;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "attendance_id" UUID;
ALTER TABLE "biometric_capture_attempts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "confidence_threshold" NUMERIC(4,2) DEFAULT 0.85;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "quality_threshold" NUMERIC(4,2) DEFAULT 70.0;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "ai_analysis_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "emotion_analysis_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "fatigue_detection_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "behavior_analysis_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "realtime_alerts_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "email_reports_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "alert_email" VARCHAR(255);
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "batch_processing_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "cache_templates" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "retention_days" INTEGER DEFAULT 90;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "max_devices_per_user" INTEGER DEFAULT 3;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "device_registration_required" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_company_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_type" VARCHAR(50);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_given" BOOLEAN;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_date" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_text" TEXT;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_version" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "acceptance_method" VARCHAR(50);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "revoked" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "revoked_date" TIMESTAMPTZ;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "revoked_reason" TEXT;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "revoked_ip_address" VARCHAR(45);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMPTZ;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_document_hash" VARCHAR(64);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_document_url" TEXT;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_token" UUID;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_token_expires_at" TIMESTAMP;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_email_sent_at" TIMESTAMP;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_link_accessed_at" TIMESTAMP;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_link_access_count" INTEGER DEFAULT 0;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_response_timestamp" TIMESTAMP;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_response_hash" VARCHAR(64);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "consent_geolocation" JSONB;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "device_fingerprint" TEXT;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "biometric_validation_hash" VARCHAR(64);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "biometric_validation_image_url" TEXT;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "biometric_validation_confidence" NUMERIC(5,2);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "email_thread" JSONB;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "immutable_signature" VARCHAR(128);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "signature_algorithm" VARCHAR(20) DEFAULT 'HMAC-SHA256';
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "invalidated_reason" VARCHAR(255);
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "invalidated_at" TIMESTAMP;
ALTER TABLE "biometric_consents" ADD COLUMN IF NOT EXISTS "previous_consent_id" INTEGER;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "type" TEXT;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "fingerIndex" INTEGER;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "template" TEXT;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "quality" INTEGER DEFAULT 0;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "algorithm" VARCHAR(255) DEFAULT 'default';
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "createdBy" UUID;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "lastUsed" TIMESTAMPTZ;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "usageCount" INTEGER DEFAULT 0;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "deviceId" VARCHAR(255);
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "UserId" UUID;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "biometric_data" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(255);
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "similarity" NUMERIC(5,3);
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(5,3);
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "was_registered" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "attendance_id" UUID;
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "operation_type" VARCHAR(20);
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "skip_reason" VARCHAR(100);
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "detection_timestamp" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "processing_time_ms" INTEGER;
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "kiosk_mode" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_detections" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(255);
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "device_name" VARCHAR(255);
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "device_type" VARCHAR(50) DEFAULT 'mobile';
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "os_info" VARCHAR(255);
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "app_version" VARCHAR(50);
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "hardware_info" JSONB;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "last_seen" TIMESTAMP;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "registration_date" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "allow_registration" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "allow_verification" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "allow_monitoring" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "location_name" VARCHAR(255);
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "location_coordinates" JSONB;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "registered_by" UUID;
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_devices" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "scan_timestamp" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_anger" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_contempt" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_disgust" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_fear" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_happiness" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_neutral" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_sadness" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotion_surprise" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "dominant_emotion" VARCHAR(20);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotional_valence" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "emotional_arousal" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "eye_occlusion_left" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "eye_occlusion_right" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "head_pose_pitch" NUMERIC(6,2);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "head_pose_roll" NUMERIC(6,2);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "head_pose_yaw" NUMERIC(6,2);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "smile_intensity" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "fatigue_score" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "has_glasses" BOOLEAN;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "glasses_type" VARCHAR(20);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "facial_hair_moustache" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "facial_hair_beard" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "facial_hair_sideburns" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "estimated_age" INTEGER;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "time_of_day" VARCHAR(20);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "day_of_week" INTEGER;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "stress_score" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "wellness_score" INTEGER;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "processing_time_ms" INTEGER;
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "data_source" VARCHAR(50) DEFAULT 'azure-face-api';
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "azure_face_id" VARCHAR(255);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(5,4);
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_emotional_analysis" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "biometric_type" VARCHAR(20);
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "success" BOOLEAN;
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(5,2);
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(255);
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "device_location" VARCHAR(255);
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "biometric_events" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "biometric_photos_stats" ADD COLUMN IF NOT EXISTS "total_with_photo" BIGINT;
ALTER TABLE "biometric_photos_stats" ADD COLUMN IF NOT EXISTS "total_without_photo" BIGINT;
ALTER TABLE "biometric_photos_stats" ADD COLUMN IF NOT EXISTS "total_expired" BIGINT;
ALTER TABLE "biometric_photos_stats" ADD COLUMN IF NOT EXISTS "total_expiring_soon" BIGINT;
ALTER TABLE "biometric_photos_stats" ADD COLUMN IF NOT EXISTS "total_valid" BIGINT;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "scan_id" BIGINT;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "tenant_id" INTEGER;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "user_id" BIGINT;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "scan_data" JSONB;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "template_hash" VARCHAR(128);
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "template_vector" TEXT[];
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(5,4);
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "anti_spoofing_score" NUMERIC(5,4);
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "ai_analysis" JSONB;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "wellness_score" INTEGER;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "alert_count" INTEGER DEFAULT 0;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50);
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "source_device_id" VARCHAR(100);
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "processing_time_ms" INTEGER;
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "processing_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_scans" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "face_recognition_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "fingerprint_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "iris_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "voice_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "min_confidence_threshold" NUMERIC(5,2) DEFAULT 85.0;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "max_attempts" INTEGER DEFAULT 3;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "template_update_interval" INTEGER DEFAULT 30;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "settings" JSONB;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "biometric_settings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(255);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "embedding_encrypted" TEXT;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "embedding_hash" VARCHAR(64);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "algorithm" VARCHAR(50) DEFAULT 'face-api-js-v0.22.2';
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "model_version" VARCHAR(50) DEFAULT 'faceRecognitionNet';
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "template_version" VARCHAR(20) DEFAULT '1.0.0';
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(5,3);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(5,3);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "face_size_ratio" NUMERIC(5,3);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "position_score" NUMERIC(5,3);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "lighting_score" NUMERIC(5,3);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "is_primary" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "is_validated" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "match_count" INTEGER DEFAULT 0;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "last_matched" TIMESTAMP;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "capture_session_id" VARCHAR(100);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "capture_timestamp" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "encryption_algorithm" VARCHAR(50) DEFAULT 'AES-256-CBC';
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "encryption_key_version" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "gdpr_consent" BOOLEAN DEFAULT false;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "retention_expires" TIMESTAMP;
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "embedding_magnitude" NUMERIC(10,6);
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "biometric_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "branch_office_id" INTEGER;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "nombre" VARCHAR(255);
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "codigo" VARCHAR(50);
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "punto_venta" INTEGER;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "punto_venta_descripcion" VARCHAR(255);
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "domicilio_fiscal" VARCHAR(500);
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "codigo_postal" VARCHAR(10);
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "localidad" VARCHAR(100);
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "provincia" VARCHAR(100);
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "pais" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "comprobantes_habilitados" JSONB DEFAULT '[]';
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_factura_a" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_factura_b" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_factura_c" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_nc_a" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_nc_b" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_nc_c" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_nd_a" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_nd_b" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "ultimo_numero_nd_c" INTEGER DEFAULT 0;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "branch_offices_fiscal" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "code" VARCHAR(255);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(255);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,8);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(11,8);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "radius" INTEGER DEFAULT 50;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "country" VARCHAR(100);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "state_province" VARCHAR(100);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "postal_code" VARCHAR(20);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(50) DEFAULT 'America/Argentina/Buenos_Aires';
ALTER TABLE "branches" ADD COLUMN IF NOT EXISTS "is_main" BOOLEAN DEFAULT false;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "budget_code" VARCHAR(50);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "budget_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "selected_modules" JSONB;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "contracted_employees" INTEGER;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "price_per_employee" NUMERIC(10,2);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(12,2);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "total_monthly" NUMERIC(12,2);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "client_contact_name" VARCHAR(255);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "client_contact_email" VARCHAR(255);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "client_contact_phone" VARCHAR(50);
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'PENDING';
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMP;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "viewed_at" TIMESTAMP;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "accepted_at" TIMESTAMP;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMP;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50) DEFAULT 'TRANSFERENCIA';
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "lead_id" UUID;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "previous_budget_id" UUID;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "replaces_budget_id" UUID;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "replaced_by_budget_id" UUID;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "is_upgrade" BOOLEAN DEFAULT false;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "is_downgrade" BOOLEAN DEFAULT false;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "added_modules" JSONB;
ALTER TABLE "budgets" ADD COLUMN IF NOT EXISTS "removed_modules" JSONB;
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "validation_code" VARCHAR(50);
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "validation_name" VARCHAR(100);
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "validation_type" VARCHAR(30);
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "validation_params" JSONB;
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20) DEFAULT 'error';
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "auto_reject" BOOLEAN DEFAULT false;
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "business_validations" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "calendar_integration_id" INTEGER;
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "notification_group_id" UUID;
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(100);
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "external_event_id" VARCHAR(255);
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "event_start" TIMESTAMP;
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "event_end" TIMESTAMP;
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "event_title" VARCHAR(255);
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "synced_at" TIMESTAMP DEFAULT now();
ALTER TABLE "calendar_events" ADD COLUMN IF NOT EXISTS "last_updated" TIMESTAMP;
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(100);
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "calendar_provider" VARCHAR(20);
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "access_token" TEXT;
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "refresh_token" TEXT;
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "calendar_id" VARCHAR(255);
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "sync_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "last_sync" TIMESTAMP;
ALTER TABLE "calendar_integrations" ADD COLUMN IF NOT EXISTS "sync_errors" JSONB;
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "verification_code" VARCHAR(6);
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "verification_code_expires" TIMESTAMP;
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "location" JSONB DEFAULT '{}';
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "professional_title" VARCHAR(255);
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "years_experience" INTEGER;
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "skills" JSONB DEFAULT '[]';
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "education" JSONB DEFAULT '[]';
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "experience" JSONB DEFAULT '[]';
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "cv_file_path" VARCHAR(500);
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "cv_original_name" VARCHAR(255);
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "preferences" JSONB DEFAULT '{}';
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "visibility" VARCHAR(20) DEFAULT 'public';
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "last_login" TIMESTAMP;
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "profile_views" INTEGER DEFAULT 0;
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "candidate_profiles" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "severity_default" VARCHAR(20) DEFAULT 'moderate';
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "requires_medication" BOOLEAN DEFAULT false;
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "requires_monitoring" BOOLEAN DEFAULT false;
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "chronic_conditions_catalog" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "invoice_id" UUID;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "liquidation_type" VARCHAR(50);
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "liquidation_code" VARCHAR(50);
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "liquidation_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "invoice_amount" NUMERIC(12,2);
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "invoice_number" VARCHAR(100);
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "invoice_date" DATE;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "total_commissionable" NUMERIC(12,2);
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "total_commission_amount" NUMERIC(12,2);
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "commission_breakdown" JSONB;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'CALCULATED';
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "payment_batch_id" UUID;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "payment_scheduled_date" DATE;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "payment_executed_date" DATE;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50) DEFAULT 'TRANSFERENCIA';
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50) DEFAULT 'SYSTEM';
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "commission_liquidations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "liquidation_id" UUID;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "payment_code" VARCHAR(50);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "payment_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "commission_amount" NUMERIC(12,2);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "tax_withholding" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "net_amount" NUMERIC(12,2);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "commission_type" VARCHAR(50);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "commission_percentage" NUMERIC(5,2);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50) DEFAULT 'TRANSFERENCIA';
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(255);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "account_type" VARCHAR(50);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "account_number" VARCHAR(100);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(22);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "alias" VARCHAR(100);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "wallet_provider" VARCHAR(100);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "wallet_account" VARCHAR(255);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'PENDING';
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "executed_date" DATE;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "confirmation_code" VARCHAR(100);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "transaction_id" VARCHAR(255);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "failure_reason" TEXT;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "failure_date" TIMESTAMP;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "retry_count" INTEGER DEFAULT 0;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "last_retry_at" TIMESTAMP;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "reconciled" BOOLEAN DEFAULT false;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "reconciled_at" TIMESTAMP;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "reconciled_by" UUID;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "receipt_url" VARCHAR(500);
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "receipt_generated_at" TIMESTAMP;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMP;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "payment_batch_id" UUID;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "commission_payments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "sender_id" UUID;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "sender_type" VARCHAR(20) DEFAULT 'user';
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "communication_type" VARCHAR(20);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "communication_channel" VARCHAR(255);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(500);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "html_content" TEXT;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "related_entity_type" VARCHAR(50);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "related_entity_id" UUID;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "notification_log_id" UUID;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "notification_group_id" UUID;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'sent';
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMPTZ;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMPTZ;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMPTZ;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "complied_at" TIMESTAMPTZ;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "delivery_confirmation" JSONB;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "delivery_provider" VARCHAR(50);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "provider_message_id" VARCHAR(255);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "is_legally_valid" BOOLEAN DEFAULT true;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "legal_validity_reason" TEXT;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "urgency" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "response_deadline" TIMESTAMPTZ;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN DEFAULT false;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(50);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "action_completed" BOOLEAN DEFAULT false;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "action_completed_at" TIMESTAMPTZ;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "error_code" VARCHAR(50);
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "retry_count" INTEGER DEFAULT 0;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "last_retry_at" TIMESTAMPTZ;
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "communication_logs" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "slug" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "contact_email" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(50);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT false;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "displayName" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "max_employees" INTEGER DEFAULT 50;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "modules_data" JSONB;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "modules_pricing" JSONB;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "monthly_total" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "license_type" VARCHAR(50) DEFAULT 'basic';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "legal_name" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(50);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "city" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "province" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "country" VARCHAR(255) DEFAULT 'Argentina';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "website" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "registration_number" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(255) DEFAULT 'America/Argentina/Buenos_Aires';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "locale" VARCHAR(10) DEFAULT 'es-AR';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "logo" TEXT;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "primary_color" VARCHAR(7) DEFAULT '#0066CC';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "secondary_color" VARCHAR(7) DEFAULT '#666666';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "subscription_type" TEXT DEFAULT 'basic';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "max_branches" INTEGER DEFAULT 5;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "is_trial" BOOLEAN DEFAULT false;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "trial_ends_at" TIMESTAMPTZ;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "subscription_expires_at" TIMESTAMPTZ;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "features" JSONB DEFAULT '{"medical": false, "reports": true, "apiAccess": false, "biometric": true, "multiuser": true, "attendance": true, "departments": true, "gpsTracking": false, "offlineMode": false, "realTimeSync": true, "customBranding": false, "ssoIntegration": false, "advancedReports": false}';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "pricing_info" JSONB DEFAULT '{}';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "password_policy" JSONB DEFAULT '{"maxAge": null, "minLength": 6, "requireNumbers": false, "requireSymbols": false, "requireLowercase": false, "requireUppercase": false}';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "two_factor_required" BOOLEAN DEFAULT false;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "session_timeout" INTEGER DEFAULT 480;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "settings" JSONB DEFAULT '{}';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "last_config_update" TIMESTAMPTZ;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "display_name" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "postal_code" VARCHAR(20) DEFAULT '';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "vendor" VARCHAR(255) DEFAULT '';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "commission_percentage" NUMERIC(5,2) DEFAULT 10.0;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(50) DEFAULT '';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "pricing" JSONB;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "modules" JSONB DEFAULT '[]';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "contracted_employees" INTEGER DEFAULT 1;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "monthly_subtotal" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "monthly_tax" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "state" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "fallback_notification_email" VARCHAR(255);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "fallback_notification_whatsapp" VARCHAR(20);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "active_modules" TEXT;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "created_by_staff_id" UUID;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "assigned_vendor_id" UUID;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "support_vendor_id" UUID;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "sales_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "support_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "multi_branch_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "onboarding_status" VARCHAR(50) DEFAULT 'PENDING';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "requiere_supervision_factura" BOOLEAN DEFAULT false;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "activated_at" TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "onboarding_trace_id" VARCHAR(100);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "modules_trial" JSONB DEFAULT '[]';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "support_sla_plan_id" UUID;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "config" JSONB DEFAULT '{}';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "is_aponnt_master" BOOLEAN DEFAULT false;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "activated_by" INTEGER;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "offboarding_status" VARCHAR(50) DEFAULT 'active';
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "offboarding_initiated_at" TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "offboarding_warning_sent_at" TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "offboarding_grace_deadline" TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "offboarding_confirmed_by" UUID;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "offboarding_confirmed_at" TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "data_export_url" VARCHAR(500);
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "data_export_generated_at" TIMESTAMP;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "cancellation_reason" TEXT;
ALTER TABLE "companies" ADD COLUMN IF NOT EXISTS "cancellation_invoice_id" UUID;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(50);
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(30);
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "reference_id" VARCHAR(100);
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN DEFAULT false;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMPTZ;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "dismissed_at" TIMESTAMPTZ;
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "action_url" VARCHAR(255);
ALTER TABLE "company_account_notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "associate_id" UUID;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "contract_type" TEXT;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "scope_type" TEXT DEFAULT 'all_company';
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "assigned_branches" TEXT[] DEFAULT '{}';
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "assigned_departments" TEXT[] DEFAULT '{}';
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "role_id" INTEGER;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "custom_permissions" JSONB;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "start_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "status" TEXT DEFAULT 'pending';
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "terms_accepted" BOOLEAN DEFAULT false;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "terms_accepted_at" TIMESTAMP;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "hourly_rate_agreed" NUMERIC(10,2);
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "terminated_by" UUID;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "terminated_at" TIMESTAMP;
ALTER TABLE "company_associate_contracts" ADD COLUMN IF NOT EXISTS "termination_reason" TEXT;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "benefit_type_id" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "is_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "max_quantity" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "max_beneficiaries_per_employee" INTEGER DEFAULT 1;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "duration_months" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "renewal_required" BOOLEAN;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "renewal_advance_days" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "approval_levels" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "eligible_roles" TEXT[];
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "eligible_departments" TEXT[];
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "min_seniority_months" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "payment_frequency" VARCHAR(20);
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "payment_day" INTEGER;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "terms_and_conditions" TEXT;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_benefit_policies" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "branch_code" VARCHAR(20);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "branch_name" VARCHAR(200);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "state_province" VARCHAR(100);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "postal_code" VARCHAR(20);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "email" VARCHAR(200);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "local_tax_id" VARCHAR(50);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "local_registration_number" VARCHAR(100);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "local_labor_authority" VARCHAR(200);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "default_pay_day" INTEGER DEFAULT 5;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "pay_frequency_override" VARCHAR(20);
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(50) DEFAULT 'America/Argentina/Buenos_Aires';
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "is_headquarters" BOOLEAN DEFAULT false;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "default_agreement_id" INTEGER;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "default_template_id" INTEGER;
ALTER TABLE "company_branches" ADD COLUMN IF NOT EXISTS "payroll_settings" JSONB DEFAULT '{}';
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "direction" VARCHAR(10) DEFAULT 'inbound';
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "department" VARCHAR(30) DEFAULT 'support';
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "from_user_id" UUID;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "from_staff_id" UUID;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "from_name" VARCHAR(255);
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(255);
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'unread';
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "requires_response" BOOLEAN DEFAULT false;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "response_deadline" TIMESTAMPTZ;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMPTZ;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "read_by" UUID;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "replied_at" TIMESTAMPTZ;
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "company_communications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "dependency_code" VARCHAR(50);
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "dependency_name" VARCHAR(150);
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "dependency_name_i18n" JSONB DEFAULT '{}';
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "dependency_type_id" INTEGER;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "config" JSONB DEFAULT '{}';
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7);
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_dependencies" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_host" VARCHAR(255);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_port" INTEGER DEFAULT 587;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_user" VARCHAR(255);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_password" VARCHAR(500);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_secure" BOOLEAN DEFAULT false;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_from_email" VARCHAR(255);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_from_name" VARCHAR(255);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "smtp_reply_to" VARCHAR(255);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_host" VARCHAR(255);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_port" INTEGER DEFAULT 993;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_user" VARCHAR(255);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_password" VARCHAR(500);
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_secure" BOOLEAN DEFAULT true;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_folder" VARCHAR(100) DEFAULT 'INBOX';
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_last_poll" TIMESTAMP;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "imap_last_uid" INTEGER DEFAULT 0;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "bidirectional_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "poll_interval_seconds" INTEGER DEFAULT 60;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "is_validated" BOOLEAN DEFAULT false;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "validated_at" TIMESTAMP;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "last_error" TEXT;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "error_count" INTEGER DEFAULT 0;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "emails_sent_today" INTEGER DEFAULT 0;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "emails_sent_month" INTEGER DEFAULT 0;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "daily_limit" INTEGER DEFAULT 500;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "monthly_limit" INTEGER DEFAULT 10000;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "last_email_sent_at" TIMESTAMP;
ALTER TABLE "company_email_config" ADD COLUMN IF NOT EXISTS "last_reset_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "email_config_id" UUID;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "process_key" VARCHAR(100);
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "process_name" VARCHAR(255);
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_email_process_mapping" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "cuit" VARCHAR(13);
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "razon_social" VARCHAR(255);
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "condicion_iva" VARCHAR(50);
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "inicio_actividades" DATE;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "certificate_pem" TEXT;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "private_key_encrypted" TEXT;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "certificate_expiration" TIMESTAMP;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "certificate_type" VARCHAR(20) DEFAULT 'TESTING';
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "afip_environment" VARCHAR(20) DEFAULT 'TESTING';
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "cached_token" TEXT;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "cached_sign" TEXT;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "token_expiration" TIMESTAMP;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "company_fiscal_config" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "message_uid" INTEGER;
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "message_id" VARCHAR(500);
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "from_email" VARCHAR(255);
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(1000);
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMP;
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "processed_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "processing_status" VARCHAR(50) DEFAULT 'PROCESSED';
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "linked_inbound_id" UUID;
ALTER TABLE "company_inbox_processed" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "company_medical_staff" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "company_medical_staff" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_medical_staff" ADD COLUMN IF NOT EXISTS "partner_id" UUID;
ALTER TABLE "company_medical_staff" ADD COLUMN IF NOT EXISTS "is_primary" BOOLEAN DEFAULT false;
ALTER TABLE "company_medical_staff" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_medical_staff" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_medical_staff" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "system_module_id" UUID;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "precio_mensual" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "fecha_asignacion" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "is_bundled" BOOLEAN DEFAULT false;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "bundled_with" UUID;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "auto_activated" BOOLEAN DEFAULT false;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "contracted_price" NUMERIC(10,2);
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "employee_tier" VARCHAR(20);
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "suspended_at" TIMESTAMP;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "suspended_reason" TEXT;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "last_billed_at" TIMESTAMP;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "next_billing_at" TIMESTAMP;
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "usage_stats" JSONB DEFAULT '{}';
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "configuration" JSONB DEFAULT '{}';
ALTER TABLE "company_modules" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "summary" VARCHAR(500);
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "type" VARCHAR(50);
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "related_experience_ids" TEXT[];
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "related_process_ids" TEXT[];
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "image_url" VARCHAR(500);
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "video_url" VARCHAR(500);
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "attachments" JSONB;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "published_by" UUID;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "published_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "is_published" BOOLEAN DEFAULT true;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "is_pinned" BOOLEAN DEFAULT false;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "pin_expires_at" TIMESTAMP;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "views_count" INTEGER DEFAULT 0;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "likes_count" INTEGER DEFAULT 0;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "comments_count" INTEGER DEFAULT 0;
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_news" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_non_working_days" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_non_working_days" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_non_working_days" ADD COLUMN IF NOT EXISTS "date" DATE;
ALTER TABLE "company_non_working_days" ADD COLUMN IF NOT EXISTS "reason" VARCHAR(255);
ALTER TABLE "company_non_working_days" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(10,4);
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "total_cost" NUMERIC(10,4);
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'USD';
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "suspension_reason" VARCHAR(255);
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "billing_year" INTEGER;
ALTER TABLE "company_notification_billing_log" ADD COLUMN IF NOT EXISTS "billing_month" INTEGER;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "price_per_unit" NUMERIC(10,4) DEFAULT 0.01;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'USD';
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "monthly_quota" INTEGER;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "is_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "suspension_reason" VARCHAR(255);
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "suspended_at" TIMESTAMP;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "suspended_by" INTEGER;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_notification_pricing" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "year" INTEGER;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "month" INTEGER;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "total_sent" INTEGER DEFAULT 0;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "total_delivered" INTEGER DEFAULT 0;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "total_failed" INTEGER DEFAULT 0;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "total_cost" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'USD';
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "is_invoiced" BOOLEAN DEFAULT false;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "invoice_id" VARCHAR(100);
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "invoiced_at" TIMESTAMP;
ALTER TABLE "company_notification_usage" ADD COLUMN IF NOT EXISTS "last_updated" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "triggered_by_staff_id" INTEGER;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "export_file_path" TEXT;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "drive_url" TEXT;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "drive_file_id" TEXT;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "records_exported" JSONB DEFAULT '{}';
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "records_deleted" JSONB DEFAULT '{}';
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "company_offboarding_events" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "threshold_method" VARCHAR(30) DEFAULT 'manual';
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "hybrid_weights" JSONB DEFAULT '{"manual": 0.3, "quartile": 0.4, "benchmark": 0.3}';
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "global_thresholds" JSONB DEFAULT '{"fatigue": {"low": 30, "high": 70, "medium": 50, "critical": 85}, "accident": {"low": 30, "high": 70, "medium": 50, "critical": 85}, "turnover": {"low": 30, "high": 70, "medium": 50, "critical": 85}, "legal_claim": {"low": 30, "high": 70, "medium": 50, "critical": 85}, "performance": {"low": 30, "high": 70, "medium": 50, "critical": 85}}';
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "global_weights" JSONB DEFAULT '{"fatigue": 0.25, "accident": 0.25, "turnover": 0.15, "legal_claim": 0.20, "performance": 0.15}';
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "enable_segmentation" BOOLEAN DEFAULT false;
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "default_benchmark_code" VARCHAR(50) DEFAULT 'ADM-GENERAL';
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "quartile_recalc_frequency" VARCHAR(20) DEFAULT 'weekly';
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "last_quartile_calculation" TIMESTAMP;
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "calculated_quartiles" JSONB;
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "company_risk_config" ADD COLUMN IF NOT EXISTS "updated_by" UUID;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "assignment_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "support_type" VARCHAR(50);
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "assigned_vendor_id" UUID;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "original_vendor_id" UUID;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "assigned_by_user_id" UUID;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_support_assignments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "task_name" VARCHAR(255);
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "task_description" TEXT;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "task_code" VARCHAR(50);
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "task_category" VARCHAR(100);
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "task_type" VARCHAR(100);
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "estimated_hours" NUMERIC(5,2);
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "priority_default" VARCHAR(50);
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT false;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "approval_role" VARCHAR(50);
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "is_template" BOOLEAN DEFAULT false;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_tasks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "tax_template_id" INTEGER;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "custom_tax_id" VARCHAR(50);
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "custom_condition_code" VARCHAR(20);
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "custom_currencies" JSONB;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "concept_overrides" JSONB DEFAULT '{}';
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "factura_a_numero" INTEGER DEFAULT 1;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "factura_b_numero" INTEGER DEFAULT 1;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "factura_c_numero" INTEGER DEFAULT 1;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "remito_numero" INTEGER DEFAULT 1;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "recibo_numero" INTEGER DEFAULT 1;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "punto_venta" INTEGER DEFAULT 1;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "actividad_principal" VARCHAR(200);
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "descuento_maximo" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "recargo_maximo" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "company_tax_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "cube_id" VARCHAR(100);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "dimension_time" VARCHAR(50);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "dimension_time_value" VARCHAR(50);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "dimension_org" VARCHAR(50);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "dimension_org_value" VARCHAR(255);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "dimension_geo" VARCHAR(50);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "dimension_geo_value" VARCHAR(255);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "measure_name" VARCHAR(50);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "measure_value" NUMERIC(15,4);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "measure_unit" VARCHAR(20);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "comparison_baseline_value" NUMERIC(15,4);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "comparison_diff_absolute" NUMERIC(15,4);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "comparison_diff_percent" NUMERIC(7,2);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "sample_size" INTEGER;
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "confidence_level" NUMERIC(5,2);
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "calculated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "comparative_analytics" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "rule_code" VARCHAR(50);
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "legal_reference" VARCHAR(255);
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "rule_type" VARCHAR(30);
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "check_frequency" VARCHAR(20);
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "validation_query" TEXT;
ALTER TABLE "compliance_rules" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "rule_code" VARCHAR(50);
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(100);
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "violation_date" TIMESTAMP DEFAULT now();
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "violation_data" JSONB;
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMP;
ALTER TABLE "compliance_violations" ADD COLUMN IF NOT EXISTS "resolution_notes" TEXT;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "concept_id" INTEGER;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "dependency_id" INTEGER;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "on_failure" VARCHAR(20) DEFAULT 'SKIP';
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "failure_message" VARCHAR(255);
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "multiplier_mode" VARCHAR(20) DEFAULT 'NONE';
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "evaluation_order" INTEGER DEFAULT 0;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "concept_dependencies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "audit_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "user_consent_id" UUID;
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "old_status" VARCHAR(20);
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "new_status" VARCHAR(20);
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "changed_by" INTEGER;
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "consent_audit_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "consent_id" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "old_branch_id" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "old_country_id" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "old_country_code" VARCHAR(3);
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "old_renewal_months" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "old_consent_status" VARCHAR(50);
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "old_expires_at" TIMESTAMP;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "new_branch_id" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "new_country_id" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "new_country_code" VARCHAR(3);
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "new_renewal_months" INTEGER;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "change_type" VARCHAR(50);
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "action_taken" VARCHAR(50);
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "triggered_by" VARCHAR(50) DEFAULT 'SYSTEM';
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "consent_change_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "consent_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "consent_key" VARCHAR(100);
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "full_text" TEXT;
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "applicable_roles" TEXT[];
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "is_required" BOOLEAN DEFAULT false;
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "consent_definitions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20);
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(50) DEFAULT 'consent_form';
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "language" VARCHAR(10) DEFAULT 'es-AR';
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "title" TEXT;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "pdf_url" TEXT;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "pdf_hash" VARCHAR(64);
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "regulations" JSONB;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "effective_from" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "effective_until" TIMESTAMP;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "created_by_user_id" UUID;
ALTER TABLE "consent_legal_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "screen_key" VARCHAR(100);
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "element_key" VARCHAR(100);
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "help_type" VARCHAR(20) DEFAULT 'tooltip';
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "content_html" TEXT;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "step_order" INTEGER;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "show_condition" JSONB DEFAULT '{}';
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "image_url" TEXT;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "video_url" TEXT;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "position" VARCHAR(20) DEFAULT 'auto';
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "style" JSONB DEFAULT '{}';
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 0;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "view_count" INTEGER DEFAULT 0;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "helpful_count" INTEGER DEFAULT 0;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "not_helpful_count" INTEGER DEFAULT 0;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "quick_start" TEXT;
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "common_issues" JSONB DEFAULT '[]';
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "walkthrough_steps" JSONB DEFAULT '[]';
ALTER TABLE "contextual_help" ADD COLUMN IF NOT EXISTS "documentation_url" TEXT;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "contract_id" UUID;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "apk_type" VARCHAR(50);
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "apk_name" VARCHAR(100);
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "max_devices" INTEGER;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "max_users" INTEGER;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "activated_at" TIMESTAMP;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "deactivated_at" TIMESTAMP;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contract_apk_licenses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "contract_id" UUID;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "recipients" JSONB;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "details" JSONB;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "days_until_expiry" INTEGER;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "notification_error" TEXT;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contract_renewal_logs" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100) DEFAULT 'SYSTEM';
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(150);
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(150);
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(30);
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "applicable_to_benefit_types" TEXT[] DEFAULT ARRAY[];
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "requires_witness" BOOLEAN DEFAULT false;
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "requires_notarization" BOOLEAN DEFAULT false;
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "requires_registration" BOOLEAN DEFAULT false;
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "contract_template_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "template_type_id" INTEGER;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "country_name" VARCHAR(100);
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "template_html" TEXT;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "required_variables" JSONB DEFAULT '[]';
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "legal_references" TEXT;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "country_specific_requirements" JSONB DEFAULT '{}';
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "additional_clauses" TEXT;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "contract_templates" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "budget_id" UUID;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "contract_code" VARCHAR(50);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "contract_type" VARCHAR(50) DEFAULT 'EULA';
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "contract_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "template_version" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "template_content" TEXT;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "selected_modules" JSONB;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "contracted_employees" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "total_monthly" NUMERIC(12,2);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50) DEFAULT 'TRANSFERENCIA';
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signature_required" BOOLEAN DEFAULT true;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signature_method" VARCHAR(50);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signer_name" VARCHAR(255);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signer_email" VARCHAR(255);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signer_dni" VARCHAR(50);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signer_role" VARCHAR(100);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signed_at" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signature_ip" VARCHAR(100);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signature_hash" VARCHAR(255);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signature_certificate" TEXT;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'DRAFT';
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "viewed_at" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "activated_at" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "legal_representative" JSONB;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "contract_number" VARCHAR(50);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "quote_id" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "seller_id" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "support_partner_id" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "modules_data" JSONB DEFAULT '[]';
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "monthly_total" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "start_date" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "end_date" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "termination_date" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "termination_reason" TEXT;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "billing_cycle" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "payment_day" INTEGER DEFAULT 10;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "payment_terms_days" INTEGER DEFAULT 10;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "late_payment_surcharge_percentage" NUMERIC(5,2) DEFAULT 10;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "suspension_days_threshold" INTEGER DEFAULT 20;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "termination_days_threshold" INTEGER DEFAULT 30;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "seller_commission_percentage" NUMERIC(5,2);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "seller_sale_commission_percentage" NUMERIC(5,2);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "seller_support_commission_percentage" NUMERIC(5,2);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "support_commission_percentage" NUMERIC(5,2);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "pdf_file_path" VARCHAR(500);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "signed_pdf_file_path" VARCHAR(500);
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "client_signature_date" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "company_signature_date" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "terms_and_conditions" TEXT;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "sla_terms" JSONB;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "renewal_notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "renewal_date" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "grace_period_end" DATE;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "contracted_apks" JSONB DEFAULT '[]';
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "next_renewal_alert_date" DATE;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "auto_extension_count" INTEGER DEFAULT 0;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "renewal_alert_sent_at" TIMESTAMP;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "original_end_date" DATE;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "template_id" UUID;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "previous_contract_id" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "replaces_contract_id" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "replaced_by_contract_id" INTEGER;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "marketing_lead_id" UUID;
ALTER TABLE "contracts" ADD COLUMN IF NOT EXISTS "sales_lead_id" UUID;
ALTER TABLE "cost_budgets" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "cost_budgets" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "cost_budgets" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "cost_budgets" ADD COLUMN IF NOT EXISTS "cost_category" VARCHAR(50);
ALTER TABLE "cost_budgets" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "cost_budgets" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "cost_budgets" ADD COLUMN IF NOT EXISTS "alert_threshold_percent" INTEGER DEFAULT 90;
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(100);
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "notification_group_id" UUID;
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "cost_category" VARCHAR(50);
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "transaction_date" TIMESTAMP DEFAULT now();
ALTER TABLE "cost_transactions" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(2);
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "country_name" VARCHAR(100);
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "allows_individual_tracking" BOOLEAN DEFAULT true;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "requires_explicit_consent" BOOLEAN DEFAULT true;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "consent_renewal_days" INTEGER;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "image_retention_max_days" INTEGER DEFAULT 30;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "detection_retention_max_days" INTEGER DEFAULT 365;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "required_legal_documents" JSONB;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "legal_framework" TEXT;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "regulatory_body" TEXT;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "alert_mode" VARCHAR(20) DEFAULT 'INDIVIDUAL';
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "max_fine_info" TEXT;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "last_updated" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "country_safety_regulations" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "check_type" VARCHAR(50);
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "table_name" VARCHAR(50);
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "record_id" VARCHAR(100);
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "issue_description" TEXT;
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "auto_fixed" BOOLEAN DEFAULT false;
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "fix_description" TEXT;
ALTER TABLE "data_integrity_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "department_aliases" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "department_aliases" ADD COLUMN IF NOT EXISTS "alias" VARCHAR(100);
ALTER TABLE "department_aliases" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "department_aliases" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "department_aliases" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "description" TEXT DEFAULT '';
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "address" VARCHAR(255) DEFAULT '';
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "gps_lat" NUMERIC(10,8);
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "gps_lng" NUMERIC(11,8);
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "coverage_radius" INTEGER DEFAULT 50;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMPTZ;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "branch_id" UUID;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "default_kiosk_id" INTEGER;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "authorized_kiosks" JSONB DEFAULT '[]';
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "allow_gps_attendance" BOOLEAN DEFAULT false;
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "notification_recipients" JSONB DEFAULT '[]';
ALTER TABLE "departments" ADD COLUMN IF NOT EXISTS "manager_user_id" UUID;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "payroll_run_id" INTEGER;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "payroll_period" VARCHAR(20);
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "concept_id" INTEGER;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "dependency_id" INTEGER;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "evaluation_result" BOOLEAN;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "evaluation_details" JSONB DEFAULT '{}';
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "action_taken" VARCHAR(20);
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "original_amount" NUMERIC(15,2);
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "final_amount" NUMERIC(15,2);
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "reduction_reason" TEXT;
ALTER TABLE "dependency_evaluations" ADD COLUMN IF NOT EXISTS "evaluated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(30);
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "type_name" VARCHAR(100);
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "type_name_i18n" JSONB DEFAULT '{}';
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50) DEFAULT 'file-text';
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7) DEFAULT '#6c757d';
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "requires_expiration" BOOLEAN DEFAULT true;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "requires_file" BOOLEAN DEFAULT false;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "requires_family_member" BOOLEAN DEFAULT false;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN DEFAULT false;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "dependency_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "document_version" INTEGER;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "user_name" VARCHAR(255);
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "user_role" VARCHAR(50);
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(30);
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "action_detail" TEXT;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "session_id" VARCHAR(100);
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "device_type" VARCHAR(20);
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "success" BOOLEAN DEFAULT true;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "dms_access_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "request_id" UUID;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "alert_type" VARCHAR(30);
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20) DEFAULT 'warning';
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "is_dismissed" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "trigger_date" DATE;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMP;
ALTER TABLE "dms_document_alerts" ADD COLUMN IF NOT EXISTS "dismissed_at" TIMESTAMP;
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "color" VARCHAR(20);
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "dms_document_categories" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "metadata_key" VARCHAR(100);
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "metadata_value" TEXT;
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "data_type" VARCHAR(20) DEFAULT 'string';
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "is_searchable" BOOLEAN DEFAULT true;
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "is_required" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_document_metadata" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "grantee_type" VARCHAR(20);
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "grantee_id" UUID;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "grantee_role" VARCHAR(50);
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "permission_level" VARCHAR(20);
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "can_view" BOOLEAN DEFAULT true;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "can_download" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "can_edit" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "can_sign" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "can_approve" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "can_share" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "can_delete" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "valid_from" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "valid_until" TIMESTAMP;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "granted_by" UUID;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "granted_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "revoked_by" UUID;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "revoked_at" TIMESTAMP;
ALTER TABLE "dms_document_permissions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(50);
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "requested_from_type" VARCHAR(20);
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "requested_from_id" UUID;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "requested_from_name" VARCHAR(255);
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "requested_by" UUID;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "requested_by_name" VARCHAR(255);
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "uploaded_at" TIMESTAMP;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "reminder_sent_at" TIMESTAMP;
ALTER TABLE "dms_document_requests" ADD COLUMN IF NOT EXISTS "reminder_count" INTEGER DEFAULT 0;
ALTER TABLE "dms_document_statuses" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "dms_document_statuses" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "dms_document_statuses" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dms_document_statuses" ADD COLUMN IF NOT EXISTS "color" VARCHAR(20);
ALTER TABLE "dms_document_statuses" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "dms_document_statuses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(50);
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT false;
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "max_size_mb" INTEGER DEFAULT 10;
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "allowed_extensions" TEXT[];
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "retention_days" INTEGER DEFAULT 3650;
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "dms_document_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "version_number" INTEGER;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "original_filename" VARCHAR(255);
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "stored_filename" VARCHAR(255);
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "storage_path" VARCHAR(500);
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "file_size_bytes" BIGINT;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "checksum_sha256" VARCHAR(64);
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "change_summary" TEXT;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "changed_fields" JSONB;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_document_versions" ADD COLUMN IF NOT EXISTS "created_from_ip" VARCHAR(45);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(50);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "external_reference" VARCHAR(100);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(10);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(50);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "folder_id" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "parent_document_id" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "original_filename" VARCHAR(255);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "stored_filename" VARCHAR(255);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "storage_path" VARCHAR(500);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "file_size_bytes" BIGINT;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "file_extension" VARCHAR(20);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "checksum_sha256" VARCHAR(64);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "owner_type" VARCHAR(50) DEFAULT 'user';
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "owner_id" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "owner_name" VARCHAR(255);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "source_module" VARCHAR(50);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "source_entity_type" VARCHAR(50);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "source_entity_id" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'DRAFT';
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "previous_status" VARCHAR(30);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "status_changed_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "status_changed_by" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "status_reason" TEXT;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "is_current_version" BOOLEAN DEFAULT true;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "superseded_by_id" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "supersedes_id" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "version_notes" TEXT;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "effective_date" DATE;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "expiration_alert_days" INTEGER DEFAULT 30;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "last_expiration_alert_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "requires_signature" BOOLEAN DEFAULT false;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "is_signed" BOOLEAN DEFAULT false;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "signature_data" JSONB;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "signed_by" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "signed_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "signature_ip" VARCHAR(45);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "visibility" VARCHAR(20) DEFAULT 'private';
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "is_confidential" BOOLEAN DEFAULT false;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "is_sensitive" BOOLEAN DEFAULT false;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "access_level" INTEGER DEFAULT 1;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "is_locked" BOOLEAN DEFAULT false;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "locked_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "locked_by" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "locked_reason" TEXT;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "lock_expires_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "is_checked_out" BOOLEAN DEFAULT false;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "checked_out_by" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "checked_out_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "checkout_expires_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "content_text" TEXT;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "search_vector" tsvector;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "tags" TEXT[] DEFAULT ARRAY[];
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "retention_until" DATE;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "disposal_action" VARCHAR(20);
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "disposal_date" DATE;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "updated_by" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "is_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "deleted_by" UUID;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "deletion_reason" TEXT;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "view_count" INTEGER DEFAULT 0;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "download_count" INTEGER DEFAULT 0;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "share_count" INTEGER DEFAULT 0;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "last_accessed_at" TIMESTAMP;
ALTER TABLE "dms_documents" ADD COLUMN IF NOT EXISTS "last_accessed_by" UUID;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "parent_id" UUID;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "full_path" VARCHAR(1000);
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "depth" INTEGER DEFAULT 0;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "owner_type" VARCHAR(50) DEFAULT 'company';
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "owner_id" UUID;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "inherit_permissions" BOOLEAN DEFAULT true;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "default_visibility" VARCHAR(20) DEFAULT 'private';
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN DEFAULT false;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "folder_type" VARCHAR(50);
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_folders" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "workflow_id" UUID;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "step_number" INTEGER;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "assigned_to" UUID;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "assigned_role" VARCHAR(50);
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "decision" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "decision_comment" TEXT;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "decision_at" TIMESTAMP;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "delegated_to" UUID;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "delegated_at" TIMESTAMP;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "delegation_reason" TEXT;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "due_at" TIMESTAMP;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "reminded_at" TIMESTAMP;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "reminder_count" INTEGER DEFAULT 0;
ALTER TABLE "dms_workflow_approvals" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "document_id" UUID;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "current_step" INTEGER DEFAULT 1;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "total_steps" INTEGER;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "steps_data" JSONB DEFAULT '[]';
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "deadline" TIMESTAMP;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "started_by" UUID;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "completed_by" UUID;
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_workflow_instances" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "steps" JSONB DEFAULT '[]';
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "trigger_on_types" TEXT[] DEFAULT ARRAY[];
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN DEFAULT false;
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "dms_workflow_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "code" VARCHAR(10);
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(100);
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "document_categories" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "code" VARCHAR(30);
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "name" VARCHAR(50);
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(50);
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "is_final" BOOLEAN DEFAULT false;
ALTER TABLE "document_statuses" ADD COLUMN IF NOT EXISTS "allowed_transitions" TEXT[] DEFAULT ARRAY[];
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(10);
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(150);
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(150);
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "retention_years" INTEGER;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "requires_expiration" BOOLEAN DEFAULT false;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "requires_signature" BOOLEAN DEFAULT false;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "is_sensitive" BOOLEAN DEFAULT false;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "is_auto_generated" BOOLEAN DEFAULT false;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "required_metadata" JSONB DEFAULT '[]';
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "optional_metadata" JSONB DEFAULT '[]';
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "allowed_extensions" TEXT[] DEFAULT ARRAY['pdf';
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "max_file_size_mb" INTEGER DEFAULT 10;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "default_visibility" VARCHAR(20) DEFAULT 'private';
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "allowed_roles" TEXT[] DEFAULT ARRAY['admin';
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "document_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "execution_id" VARCHAR(36);
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'running';
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "mode" VARCHAR(20);
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "phases_executed" JSONB DEFAULT '[]';
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "modules_tested" JSONB DEFAULT '[]';
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "total_tests" INTEGER DEFAULT 0;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "tests_passed" INTEGER DEFAULT 0;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "tests_failed" INTEGER DEFAULT 0;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "tests_skipped" INTEGER DEFAULT 0;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "overall_score" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "production_ready" BOOLEAN DEFAULT false;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "duration" INTEGER DEFAULT 0;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "e2e_advanced_executions" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "rule_name" VARCHAR(200);
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "rule_description" TEXT;
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "expected_behavior" TEXT;
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "actual_behavior" TEXT;
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "test_data" JSONB;
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "violated" BOOLEAN DEFAULT false;
ALTER TABLE "e2e_business_rules_violations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "scenario_type" VARCHAR(100);
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "scenario_config" JSONB;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "duration_seconds" INTEGER;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "system_recovered" BOOLEAN;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "recovery_time_seconds" INTEGER;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "data_loss_occurred" BOOLEAN DEFAULT false;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "errors_during_chaos" INTEGER DEFAULT 0;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "requests_lost" INTEGER DEFAULT 0;
ALTER TABLE "e2e_chaos_scenarios" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "execution_id" VARCHAR(36);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "overall_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "e2e_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "load_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "security_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "multi_tenant_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "database_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "monitoring_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "edge_cases_score" NUMERIC(5,2);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "production_ready" BOOLEAN DEFAULT false;
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "confidence_level" VARCHAR(20);
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "blockers" JSONB DEFAULT '[]';
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "calculation_breakdown" JSONB DEFAULT '{}';
ALTER TABLE "e2e_confidence_scores" ADD COLUMN IF NOT EXISTS "calculated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "issue_type" VARCHAR(100);
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "table_name" VARCHAR(100);
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "record_id" VARCHAR(100);
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "details" JSONB;
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "e2e_data_integrity_issues" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "batch_name" VARCHAR(200);
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "level" INTEGER DEFAULT 3;
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "start_time" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "end_time" TIMESTAMPTZ;
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "total_users_generated" INTEGER DEFAULT 0;
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "total_operations" INTEGER DEFAULT 0;
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "total_vulnerabilities_found" INTEGER DEFAULT 0;
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "phases_completed" JSONB DEFAULT '[]';
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "overall_status" VARCHAR(50) DEFAULT 'running';
ALTER TABLE "e2e_enterprise_test_batches" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "concurrent_users" INTEGER;
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "latency_p50_ms" INTEGER;
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "latency_p95_ms" INTEGER;
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "latency_p99_ms" INTEGER;
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "throughput_rps" NUMERIC(10,2);
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "error_rate_percent" NUMERIC(5,2);
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "db_connections_used" INTEGER;
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "memory_usage_mb" INTEGER;
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "cpu_usage_percent" NUMERIC(5,2);
ALTER TABLE "e2e_performance_degradation" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "operation_type" VARCHAR(50);
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "endpoint" VARCHAR(255);
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "latency_ms" INTEGER;
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "concurrent_users" INTEGER;
ALTER TABLE "e2e_performance_metrics" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "attack_type" VARCHAR(100);
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "endpoint" VARCHAR(255);
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "payload" TEXT;
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "was_blocked" BOOLEAN;
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "response_status" INTEGER;
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "response_body" TEXT;
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "vulnerability_severity" VARCHAR(20);
ALTER TABLE "e2e_security_vulnerabilities" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_stress_metrics" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_stress_metrics" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_stress_metrics" ADD COLUMN IF NOT EXISTS "metric_name" VARCHAR(100);
ALTER TABLE "e2e_stress_metrics" ADD COLUMN IF NOT EXISTS "metric_value" NUMERIC(15,2);
ALTER TABLE "e2e_stress_metrics" ADD COLUMN IF NOT EXISTS "unit" VARCHAR(50);
ALTER TABLE "e2e_stress_metrics" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_stress_test_users" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "e2e_stress_test_users" ADD COLUMN IF NOT EXISTS "batch_id" UUID;
ALTER TABLE "e2e_stress_test_users" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "e2e_stress_test_users" ADD COLUMN IF NOT EXISTS "user_email" VARCHAR(255);
ALTER TABLE "e2e_stress_test_users" ADD COLUMN IF NOT EXISTS "user_name" VARCHAR(255);
ALTER TABLE "e2e_stress_test_users" ADD COLUMN IF NOT EXISTS "user_role" VARCHAR(50);
ALTER TABLE "e2e_stress_test_users" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "execution_id" VARCHAR(36);
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "phase_name" VARCHAR(50);
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "tests_passed" INTEGER DEFAULT 0;
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "tests_failed" INTEGER DEFAULT 0;
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "tests_skipped" INTEGER DEFAULT 0;
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "duration" INTEGER DEFAULT 0;
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "error_stack" TEXT;
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "metrics" JSONB DEFAULT '{}';
ALTER TABLE "e2e_test_results_detailed" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "app_key" VARCHAR(100);
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "name" TEXT;
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "app_type" VARCHAR(50);
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "platform" VARCHAR(100);
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'planned';
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "progress" INTEGER DEFAULT 0;
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20);
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "url" VARCHAR(500);
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "entry_file" VARCHAR(500);
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "depends_on_modules" TEXT[] DEFAULT '{}';
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "users" TEXT[] DEFAULT '{}';
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "tech_stack" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "features" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_applications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "file_path" VARCHAR(1000);
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "file_type" VARCHAR(50);
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "file_category" VARCHAR(50);
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "exports" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "imports" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "functions" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "classes" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "endpoints" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "file_size" INTEGER;
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "line_count" INTEGER;
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "last_modified" TIMESTAMP;
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "checksum" VARCHAR(64);
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "scanned_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_file_cache" ADD COLUMN IF NOT EXISTS "is_valid" BOOLEAN DEFAULT true;
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "phase_key" VARCHAR(100);
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "name" TEXT;
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'planned';
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "progress" INTEGER DEFAULT 0;
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(10) DEFAULT 'medium';
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "target_date" DATE;
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "completion_date" DATE;
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "depends_on" TEXT[] DEFAULT '{}';
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "assigned_to" VARCHAR(100);
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "tags" TEXT[] DEFAULT '{}';
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_phases" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "task_code" VARCHAR(50);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "phase_id" UUID;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "name" TEXT;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "progress" INTEGER DEFAULT 0;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(10) DEFAULT 'medium';
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "auto_detected" BOOLEAN DEFAULT false;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "detection_method" VARCHAR(100);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "detection_rule" JSONB;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "last_detection_check" TIMESTAMP;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "assigned_module" VARCHAR(100);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "depends_on" TEXT[] DEFAULT '{}';
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "blocks" TEXT[] DEFAULT '{}';
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "assigned_to" VARCHAR(100);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "assigned_type" VARCHAR(20);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMP;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "verified_by_test" VARCHAR(100);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "estimated_hours" NUMERIC(5,1);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "actual_hours" NUMERIC(5,1);
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "tags" TEXT[] DEFAULT '{}';
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_tasks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "workflow_key" VARCHAR(100);
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "name" TEXT;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "trigger_type" VARCHAR(50);
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "trigger_config" JSONB;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "steps" JSONB DEFAULT '[]';
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "is_auto_generated" BOOLEAN DEFAULT false;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "source_file" VARCHAR(500);
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "source_line" INTEGER;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "execution_count" INTEGER DEFAULT 0;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "last_executed_at" TIMESTAMP;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "avg_duration_ms" INTEGER;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "tutorial_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "tutorial_content" JSONB;
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "ecosystem_workflows" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "email_config_audit_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "email_config_audit_log" ADD COLUMN IF NOT EXISTS "email_type" VARCHAR(50);
ALTER TABLE "email_config_audit_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "email_config_audit_log" ADD COLUMN IF NOT EXISTS "changed_by_staff_id" UUID;
ALTER TABLE "email_config_audit_log" ADD COLUMN IF NOT EXISTS "changes" JSONB;
ALTER TABLE "email_config_audit_log" ADD COLUMN IF NOT EXISTS "changed_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "institutional_email" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "display_name" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "smtp_host" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "smtp_port" INTEGER;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "smtp_user" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "smtp_password" TEXT;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "smtp_secure" BOOLEAN DEFAULT false;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "verification_token" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "last_verification_attempt" TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "verification_attempts" INTEGER DEFAULT 0;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "daily_limit" INTEGER DEFAULT 500;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "monthly_limit" INTEGER DEFAULT 10000;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "current_daily_count" INTEGER DEFAULT 0;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "current_monthly_count" INTEGER DEFAULT 0;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "last_reset_daily" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "last_reset_monthly" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "from_name" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "reply_to" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "cc_copy" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "bcc_copy" VARCHAR(255);
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "use_company_templates" BOOLEAN DEFAULT true;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "signature" TEXT;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "suspended" BOOLEAN DEFAULT false;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "suspended_reason" TEXT;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "suspended_at" TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "last_error" TEXT;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "last_error_at" TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "error_count" INTEGER DEFAULT 0;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "updated_by" UUID;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "emails_sent_today" INTEGER DEFAULT 0;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "emails_sent_month" INTEGER DEFAULT 0;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "last_email_sent_at" TIMESTAMP;
ALTER TABLE "email_configurations" ADD COLUMN IF NOT EXISTS "last_reset_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "message_id" VARCHAR(500);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "in_reply_to" VARCHAR(500);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "references_header" TEXT;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "from_email" VARCHAR(255);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "from_name" VARCHAR(255);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "to_email" VARCHAR(255);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "to_name" VARCHAR(255);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "cc_emails" JSONB DEFAULT '[]';
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(1000);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "body_text" TEXT;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "body_html" TEXT;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "raw_headers" JSONB DEFAULT '{}';
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "linked_notification_id" UUID;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "linked_thread_id" UUID;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "linked_group_id" UUID;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "linked_company_id" INTEGER;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "linked_user_id" INTEGER;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "processing_status" VARCHAR(50) DEFAULT 'PENDING';
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "processing_error" TEXT;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "processed_at" TIMESTAMP;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "created_message_id" UUID;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "response_sent" BOOLEAN DEFAULT false;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "response_sent_at" TIMESTAMP;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "email_provider" VARCHAR(50);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "provider_event_id" VARCHAR(255);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "spam_score" NUMERIC(5,2);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "is_auto_reply" BOOLEAN DEFAULT false;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "detected_language" VARCHAR(10);
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_inbound_log" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "sender_type" VARCHAR(50);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "sender_id" VARCHAR(255);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "email_config_id" INTEGER;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "recipient_email" VARCHAR(255);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(255);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(50);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "recipient_id" VARCHAR(255);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "subject" TEXT;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "body_html" TEXT;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "body_text" TEXT;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "has_attachments" BOOLEAN DEFAULT false;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "attachments" JSONB;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "opened_at" TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "clicked_at" TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "bounced_at" TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "message_id" VARCHAR(255);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "tracking_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "error_code" VARCHAR(50);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "retry_count" INTEGER DEFAULT 0;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "max_retries" INTEGER DEFAULT 3;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "next_retry_at" TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "reply_to_address" VARCHAR(255);
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "expects_reply" BOOLEAN DEFAULT false;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "reply_received" BOOLEAN DEFAULT false;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "reply_received_at" TIMESTAMP;
ALTER TABLE "email_logs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "policy_key" VARCHAR(100);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "policy_name" VARCHAR(255);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "policy_description" TEXT;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "email_type" VARCHAR(50);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "email_address" VARCHAR(255);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "applies_to" VARCHAR(50);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "notification_category" VARCHAR(100);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(100);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "send_copy_to_aponnt" BOOLEAN DEFAULT false;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "copy_email" VARCHAR(255);
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 0;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_policies" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(255) DEFAULT 'system';
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "process_key" VARCHAR(100);
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "process_name" VARCHAR(255);
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "email_type" VARCHAR(50);
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "requires_email" BOOLEAN DEFAULT true;
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "email_process_mapping" ADD COLUMN IF NOT EXISTS "updated_by" UUID;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "template_key" VARCHAR(100);
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(255);
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(500);
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "body_html" TEXT;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "body_text" TEXT;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "available_variables" JSONB;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_templates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "outbound_message_id" VARCHAR(500);
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "notification_id" UUID;
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "thread_id" UUID;
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "group_id" UUID;
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "entity_id" VARCHAR(100);
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "recipient_email" VARCHAR(255);
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(255);
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(50);
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "email_thread_mapping" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "token_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "user_type" VARCHAR(50);
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "token" VARCHAR(255);
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "email_verification_tokens" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "employee_benefit_id" INTEGER;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_type" VARCHAR(50);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_brand" VARCHAR(100);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_model" VARCHAR(100);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_serial_number" VARCHAR(200);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_imei" VARCHAR(50);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_plate_number" VARCHAR(20);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_vin" VARCHAR(50);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_value" NUMERIC(15,2);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "depreciation_rate" NUMERIC(5,2);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "current_value" NUMERIC(15,2);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "asset_condition" VARCHAR(30) DEFAULT 'new';
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "assignment_date" DATE;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "expected_return_date" DATE;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "actual_return_date" DATE;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'assigned';
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "employee_responsible" BOOLEAN DEFAULT true;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "deposit_amount" NUMERIC(15,2);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "deposit_paid" BOOLEAN DEFAULT false;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "last_maintenance_date" DATE;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "next_maintenance_date" DATE;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "maintenance_notes" TEXT;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "insurance_policy_number" VARCHAR(100);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "insurance_company" VARCHAR(200);
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "insurance_expiration_date" DATE;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "assignment_notes" TEXT;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "return_notes" TEXT;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "employee_assigned_assets" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "employee_benefit_id" INTEGER;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "requirement_id" INTEGER;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "dms_document_id" INTEGER;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "document_file_path" VARCHAR(500);
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(100);
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "issuing_authority" VARCHAR(200);
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "verification_status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "verification_notes" TEXT;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "expiration_alert_sent" BOOLEAN DEFAULT false;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "expiration_alert_sent_at" TIMESTAMP;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "is_current" BOOLEAN DEFAULT true;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "employee_benefit_documents" ADD COLUMN IF NOT EXISTS "uploaded_by" UUID;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "company_benefit_policy_id" INTEGER;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "assigned_amount" NUMERIC(15,2);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "assigned_quantity" INTEGER;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "effective_from" DATE;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "effective_until" DATE;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'pending_approval';
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "status_reason" TEXT;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "status_changed_at" TIMESTAMP;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "status_changed_by" UUID;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "beneficiary_type" VARCHAR(30);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "beneficiary_name" VARCHAR(200);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "beneficiary_relationship" VARCHAR(50);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "beneficiary_document_id" VARCHAR(50);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "beneficiary_birth_date" DATE;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "beneficiary_metadata" JSONB DEFAULT '{}';
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "provider_name" VARCHAR(200);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "provider_tax_id" VARCHAR(50);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "provider_address" TEXT;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "provider_contact_info" JSONB DEFAULT '{}';
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "has_required_documents" BOOLEAN DEFAULT false;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "documents_last_verified_at" TIMESTAMP;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "documents_next_verification_date" DATE;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "renewal_status" VARCHAR(30);
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "renewal_requested_at" TIMESTAMP;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "renewal_approved_at" TIMESTAMP;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "employee_benefits" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "dependency_id" INTEGER;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "family_member_type" VARCHAR(20);
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "family_member_id" INTEGER;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "family_member_name" VARCHAR(150);
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "file_url" VARCHAR(500);
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(255);
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "file_size" INTEGER;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "file_mime_type" VARCHAR(100);
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'VALID';
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "days_until_expiration" INTEGER;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "replaced_by_id" INTEGER;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "is_current" BOOLEAN DEFAULT true;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "uploaded_by" UUID;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "reviewed_by" UUID;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "review_notes" TEXT;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "employee_dependency_documents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "userId" UUID;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "documentType" TEXT;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "documentNumber" VARCHAR(100);
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "issuingAuthority" VARCHAR(255);
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "issuingCountry" VARCHAR(100);
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "issueDate" TIMESTAMPTZ;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "expiryDate" TIMESTAMPTZ;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "documentData" JSON DEFAULT '{}';
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "frontPhotoPath" VARCHAR(500);
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "backPhotoPath" VARCHAR(500);
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "additionalFiles" JSON DEFAULT '[]';
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "status" TEXT DEFAULT 'valid';
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "alertDays" INTEGER DEFAULT 30;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "lastAlertSent" TIMESTAMPTZ;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "employee_documents" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "type" VARCHAR(20) DEFAULT 'SUGGESTION';
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "area" VARCHAR(50);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'MEDIUM';
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "visibility" VARCHAR(20) DEFAULT 'ADMIN_ONLY';
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "embedding" JSONB;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "topics" JSONB;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "sentiment_score" DOUBLE PRECISION;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "sentiment_label" VARCHAR(20);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "cluster_id" UUID;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "similarity_to_cluster" DOUBLE PRECISION;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "is_cluster_original" BOOLEAN DEFAULT false;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "upvotes" INTEGER DEFAULT 0;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "downvotes" INTEGER DEFAULT 0;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "comments_count" INTEGER DEFAULT 0;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "estimated_savings" NUMERIC(12,2);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "actual_savings" NUMERIC(12,2);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "implementation_notes" TEXT;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "implementation_complete_date" TIMESTAMP;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "safety_impact_notes" TEXT;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "total_points_awarded" INTEGER DEFAULT 0;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "badges_earned" TEXT[];
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "views" INTEGER DEFAULT 0;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "approved_date" TIMESTAMP;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "implementation_start_date" TIMESTAMP;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "actual_time_saved" NUMERIC(10,2);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "estimated_time_saved" NUMERIC(10,2);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "quality_improvement_pct" NUMERIC(5,2);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "impact_scope" VARCHAR(50);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "subcategory" VARCHAR(100);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "related_process_id" UUID;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "related_department_id" INTEGER;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "resolution" TEXT;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMP;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "resolved_by" UUID;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "auto_resolved" BOOLEAN DEFAULT false;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "similarity_sources" JSONB;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "is_highlighted" BOOLEAN DEFAULT false;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "highlighted_at" TIMESTAMP;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "highlighted_by" UUID;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "estimated_cost_saved" NUMERIC(10,2);
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "implementation_date" DATE;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "bookmarks_count" INTEGER DEFAULT 0;
ALTER TABLE "employee_experiences" ADD COLUMN IF NOT EXISTS "shares_count" INTEGER DEFAULT 0;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "userId" UUID;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,8);
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(11,8);
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "accuracy" DOUBLE PRECISION;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "altitude" DOUBLE PRECISION;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "heading" DOUBLE PRECISION;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "speed" DOUBLE PRECISION;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "isWorkingHours" BOOLEAN DEFAULT false;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "isOnBreak" BOOLEAN DEFAULT false;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "isInGeofence" BOOLEAN DEFAULT false;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "currentActivity" TEXT DEFAULT 'idle';
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "deviceId" VARCHAR(255);
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "appVersion" VARCHAR(255);
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "batteryLevel" INTEGER;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "connectionType" TEXT DEFAULT 'unknown';
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "address" VARCHAR(255);
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "nearbyLandmarks" JSON;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "weatherConditions" JSON;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "isPrivacyMode" BOOLEAN DEFAULT false;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "sharingLevel" TEXT DEFAULT 'full';
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "reportedAt" TIMESTAMPTZ;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "employee_locations" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "consent_type" VARCHAR(50) DEFAULT 'PPE_MONITORING';
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "consent_given" BOOLEAN DEFAULT false;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "consent_date" TIMESTAMPTZ;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "consent_expires" TIMESTAMPTZ;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "consent_document_version" VARCHAR(20);
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "consent_document_hash" VARCHAR(64);
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "revoked" BOOLEAN DEFAULT false;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "revoked_at" TIMESTAMPTZ;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "revocation_reason" TEXT;
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "employee_ppe_consents" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "brand" VARCHAR(100);
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "model" VARCHAR(100);
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "certifications" JSONB;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "default_lifespan_days" INTEGER;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "lifespan_unit" VARCHAR(20) DEFAULT 'days';
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "max_uses" INTEGER;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "available_sizes" JSONB;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(10,2);
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "min_stock_alert" INTEGER DEFAULT 5;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "usage_instructions" TEXT;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "maintenance_instructions" TEXT;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "storage_instructions" TEXT;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "disposal_instructions" TEXT;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "procedure_id" INTEGER;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "epp_catalog" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "name_es" VARCHAR(100);
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(100);
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "body_zone" VARCHAR(50);
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "iso_reference" VARCHAR(50);
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "epp_categories" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "epp_catalog_id" INTEGER;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "requirement_id" INTEGER;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "delivery_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "delivered_by" UUID;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "quantity_delivered" INTEGER DEFAULT 1;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "size_delivered" VARCHAR(20);
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "batch_number" VARCHAR(100);
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "manufacture_date" DATE;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "calculated_replacement_date" DATE;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'active';
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "employee_signature_date" TIMESTAMP;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "employee_signature_method" VARCHAR(30);
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "signature_document_url" TEXT;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "return_date" DATE;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "return_reason" VARCHAR(100);
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "return_notes" TEXT;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "replaced_by_delivery_id" INTEGER;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "notification_30_sent" BOOLEAN DEFAULT false;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "notification_15_sent" BOOLEAN DEFAULT false;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "notification_7_sent" BOOLEAN DEFAULT false;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "notification_expired_sent" BOOLEAN DEFAULT false;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "epp_deliveries" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "delivery_id" INTEGER;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "inspection_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "inspector_id" UUID;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "condition" VARCHAR(30);
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "is_compliant" BOOLEAN DEFAULT true;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "checklist_results" JSONB;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "action_required" VARCHAR(50);
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "action_notes" TEXT;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "action_deadline" DATE;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "action_completed" BOOLEAN DEFAULT false;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "photos" JSONB;
ALTER TABLE "epp_inspections" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "position_id" INTEGER;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "epp_catalog_id" INTEGER;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT true;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 1;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "quantity_required" INTEGER DEFAULT 1;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "custom_lifespan_days" INTEGER;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "conditions" TEXT;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "applicable_work_environments" JSONB;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "specific_procedure_id" INTEGER;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "epp_role_requirements" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_bookmarks" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "experience_bookmarks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "experience_bookmarks" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "experience_bookmarks" ADD COLUMN IF NOT EXISTS "experience_id" UUID;
ALTER TABLE "experience_bookmarks" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "experience_bookmarks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "auto_generated" BOOLEAN DEFAULT false;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "type" VARCHAR(20);
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "area" VARCHAR(50);
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "centroid_embedding" JSONB;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "member_count" INTEGER DEFAULT 0;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "avg_sentiment" DOUBLE PRECISION;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "total_upvotes" INTEGER DEFAULT 0;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "total_downvotes" INTEGER DEFAULT 0;
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "dominant_topics" JSONB DEFAULT '[]';
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "experience_clusters" ADD COLUMN IF NOT EXISTS "merged_into_cluster_id" UUID;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "experience_id" UUID;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "parent_comment_id" UUID;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "is_helpful" BOOLEAN DEFAULT false;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "helpful_count" INTEGER DEFAULT 0;
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "visibility" VARCHAR(20) DEFAULT 'PUBLIC';
ALTER TABLE "experience_comments" ADD COLUMN IF NOT EXISTS "upvotes" INTEGER DEFAULT 0;
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "experience_id" UUID;
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "recognition_type" VARCHAR(50);
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "points_awarded" INTEGER;
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "badge_name" VARCHAR(100);
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "awarded_by" UUID;
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "experience_recognitions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "keywords" TEXT[];
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "experience_count" INTEGER DEFAULT 0;
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "avg_sentiment" DOUBLE PRECISION;
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_topics" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "experience_votes" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "experience_votes" ADD COLUMN IF NOT EXISTS "experience_id" UUID;
ALTER TABLE "experience_votes" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "experience_votes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "experience_votes" ADD COLUMN IF NOT EXISTS "vote_type" VARCHAR(10);
ALTER TABLE "experience_votes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "type" VARCHAR(100);
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "days" INTEGER;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "day_type" VARCHAR(20) DEFAULT 'corrido';
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT true;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "requires_documentation" BOOLEAN DEFAULT false;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "max_per_year" INTEGER;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "advance_notice_days" INTEGER DEFAULT 0;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "legal_basis" TEXT;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "extraordinary_licenses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "face_encoding" TEXT;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "face_template" BYTEA;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(5,2) DEFAULT 0.0;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "capture_timestamp" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "device_info" JSONB;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "facial_biometric_data" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "account_id" INTEGER;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "fiscal_year" INTEGER;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "fiscal_period" INTEGER;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "opening_debit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "opening_credit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "period_debit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "period_credit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "closing_debit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "closing_credit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "opening_balance" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "period_movement" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "closing_balance" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "transaction_count" INTEGER DEFAULT 0;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "last_transaction_date" DATE;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_account_balances" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "operation_type" VARCHAR(50);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "operation_id" INTEGER;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "operation_table" VARCHAR(100);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "authorizer_id" UUID;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "authorization_role" VARCHAR(50);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "authorization_method" VARCHAR(30);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "authorization_device" VARCHAR(100);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "authorization_confidence" NUMERIC(5,2);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "authorization_result" VARCHAR(20);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "failure_reason" TEXT;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "location_data" JSONB;
ALTER TABLE "finance_authorization_logs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "account_code" VARCHAR(50);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "account_name" VARCHAR(200);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(200);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "bank_branch" VARCHAR(100);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "account_number" VARCHAR(50);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "account_type" VARCHAR(50);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(22);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "alias" VARCHAR(50);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "swift_code" VARCHAR(11);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "iban" VARCHAR(34);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "current_balance" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "available_balance" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "last_balance_date" DATE;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "overdraft_limit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "daily_transfer_limit" NUMERIC(15,2);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "ledger_account_id" INTEGER;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "bank_contact_name" VARCHAR(200);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "bank_contact_phone" VARCHAR(50);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "bank_contact_email" VARCHAR(200);
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "is_primary" BOOLEAN DEFAULT false;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "allows_payments" BOOLEAN DEFAULT true;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "allows_collections" BOOLEAN DEFAULT true;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "auto_reconcile" BOOLEAN DEFAULT false;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_bank_accounts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "bank_account_id" INTEGER;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "transaction_number" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "transaction_date" DATE;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "value_date" DATE;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "transaction_type" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(15,2);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "running_balance" NUMERIC(15,2);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "source_name" VARCHAR(200);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "counterpart_bank" VARCHAR(200);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "counterpart_account" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "counterpart_cbu" VARCHAR(22);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "source_document_type" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "source_document_id" INTEGER;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "source_document_number" VARCHAR(100);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "is_reconciled" BOOLEAN DEFAULT false;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "reconciled_at" TIMESTAMPTZ;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "reconciled_by" UUID;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "journal_entry_id" INTEGER;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "reference" VARCHAR(200);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "bank_reference" VARCHAR(100);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "check_number" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "check_date" DATE;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "imported_from" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "import_batch_id" VARCHAR(50);
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'confirmed';
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_bank_transactions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "budget_id" INTEGER;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "account_id" INTEGER;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "cost_center_id" INTEGER;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "fiscal_period" INTEGER;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "budget_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "committed_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "actual_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "available_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "variance_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "variance_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "execution_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'on_track';
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "last_updated" TIMESTAMPTZ;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_budget_execution" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "budget_id" INTEGER;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "investment_code" VARCHAR(50);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "investment_type" VARCHAR(50);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "disbursement_schedule" JSONB DEFAULT '{}';
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "expected_roi_percent" NUMERIC(5,2);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "payback_months" INTEGER;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "npv" NUMERIC(15,2);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "irr" NUMERIC(5,2);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "future_opex_impact" NUMERIC(15,2);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "future_savings" NUMERIC(15,2);
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "asset_account_id" INTEGER;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "expense_account_id" INTEGER;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "cost_center_id" INTEGER;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'proposed';
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "requires_board_approval" BOOLEAN DEFAULT false;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "actual_spent" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "variance_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "variance_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "completion_date" DATE;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "actual_completion_date" DATE;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_budget_investments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "budget_id" INTEGER;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "account_id" INTEGER;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "cost_center_id" INTEGER;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "line_type" VARCHAR(20);
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_01" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_02" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_03" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_04" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_05" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_06" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_07" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_08" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_09" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_10" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_11" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_12" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "period_13" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "annual_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "historical_amount" NUMERIC(15,2);
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "historical_source" VARCHAR(50);
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "inflation_adjustment" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "growth_adjustment" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "manual_adjustment" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "driver_type" VARCHAR(50);
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "driver_value" NUMERIC(15,4);
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "driver_unit_cost" NUMERIC(15,4);
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_budget_lines" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "budget_code" VARCHAR(50);
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "fiscal_year" INTEGER;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "budget_type" VARCHAR(50);
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "generation_method" VARCHAR(50);
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "base_year" INTEGER;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "base_budget_id" INTEGER;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "inflation_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "growth_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "total_revenue" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "total_expense" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "total_capex" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "net_result" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "allow_overspend" BOOLEAN DEFAULT false;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "overspend_tolerance_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "control_level" VARCHAR(20) DEFAULT 'warning';
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_budgets" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "cash_register_id" INTEGER;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "session_id" INTEGER;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "adjustment_number" VARCHAR(50);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "adjustment_date" TIMESTAMPTZ;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "adjustment_type" VARCHAR(30);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "adjustment_reason" VARCHAR(100);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(18,2);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "previous_balance" NUMERIC(18,2);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "new_balance" NUMERIC(18,2);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "supporting_document" VARCHAR(200);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "requested_by" UUID;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "requires_finance_approval" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "finance_approver_id" UUID;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "finance_approved_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "finance_approval_method" VARCHAR(20);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "finance_approval_notes" TEXT;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "rejected_by" UUID;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "journal_entry_id" INTEGER;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "finance_cash_adjustments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "cash_register_id" INTEGER;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "from_session_id" INTEGER;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "to_session_id" INTEGER;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "currency_id" INTEGER;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "currency_code" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "carryover_amount" NUMERIC(15,2);
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "exchange_rate" NUMERIC(15,6) DEFAULT 1;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "amount_in_base_currency" NUMERIC(15,2);
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "carryover_date" DATE;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "applied_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "closing_notes" TEXT;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "opening_notes" TEXT;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "applied_by" UUID;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_balance_carryover" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "session_id" INTEGER;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "cash_register_id" INTEGER;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "count_type" VARCHAR(20);
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "count_date" TIMESTAMPTZ;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "counted_by" UUID;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "supervised_by" UUID;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "cash_denominations" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "totals_by_method" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "checks_detail" JSONB DEFAULT '[]';
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "vouchers_detail" JSONB DEFAULT '[]';
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "total_declared" NUMERIC(15,2);
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "total_expected" NUMERIC(15,2);
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "difference" NUMERIC(15,2);
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "difference_percent" NUMERIC(5,2);
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "difference_justified" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "difference_reason" TEXT;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "difference_approved_by" UUID;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "finance_cash_counts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "forecast_date" DATE;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "forecast_type" VARCHAR(20);
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "scenario" VARCHAR(20) DEFAULT 'base';
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "opening_balance" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "inflows_receivables" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "inflows_sales" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "inflows_loans" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "inflows_other" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "total_inflows" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_payables" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_payroll" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_taxes" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_loans" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_capex" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_rent" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_utilities" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "outflows_other" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "total_outflows" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "net_flow" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "closing_balance" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "details" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "is_actual" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "confidence_level" NUMERIC(5,2);
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "generated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "generated_by" VARCHAR(50);
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_flow_forecast" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "source_module" VARCHAR(50);
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "default_register_id" INTEGER;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "auto_create_movement" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "requires_register_selection" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "document_type_mapping" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_integration_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "cash_register_id" INTEGER;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "assignment_type" VARCHAR(20);
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "can_open" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "can_close" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "can_transfer_out" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "can_transfer_in" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "can_void" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "can_view_other_sessions" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "max_void_amount" NUMERIC(15,2);
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "finance_cash_register_assignments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "cash_register_id" INTEGER;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "session_number" VARCHAR(50);
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "session_date" DATE;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "opened_by" UUID;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "closed_by" UUID;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "opened_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "opening_amounts" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "expected_amounts" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "declared_amounts" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "differences" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "total_difference" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "total_sales" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "total_collections" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "total_payments" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "total_transfers_in" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "total_transfers_out" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'open';
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "has_pending_transfers" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "pending_transfer_ids" TEXT[] DEFAULT ARRAY[];
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "approval_notes" TEXT;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "opening_notes" TEXT;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "closing_notes" TEXT;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_register_sessions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "register_type" VARCHAR(30);
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "parent_register_id" INTEGER;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "location" VARCHAR(200);
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "default_opening_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "max_cash_amount" NUMERIC(15,2);
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "requires_count_on_close" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "requires_supervisor_approval" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "auto_transfer_to_main" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "allowed_payment_methods" TEXT[] DEFAULT ARRAY[];
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "is_open" BOOLEAN DEFAULT false;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "current_session_id" INTEGER;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "cash_account_id" INTEGER;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "difference_account_id" INTEGER;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_registers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "transfer_number" VARCHAR(50);
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "transfer_date" TIMESTAMPTZ;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "source_register_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "source_session_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "destination_register_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "destination_session_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "payment_method_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(15,2);
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "transfer_details" JSONB DEFAULT '{}';
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "reason" VARCHAR(100);
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "initiated_by" UUID;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "initiated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "responded_by" UUID;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "responded_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "response_notes" TEXT;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "reversed_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "reversal_movement_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "blocks_source_close" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "blocks_destination_close" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "source_movement_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "destination_movement_id" INTEGER;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cash_transfers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "account_code" VARCHAR(20);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "account_number" INTEGER;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "level" INTEGER;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "is_header" BOOLEAN DEFAULT false;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(200);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "account_type" VARCHAR(20);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "account_nature" VARCHAR(10);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "bs_category" VARCHAR(50);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "is_category" VARCHAR(50);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "cf_category" VARCHAR(50);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "auto_post_source" VARCHAR(50);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "auto_post_type" VARCHAR(50);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "requires_cost_center" BOOLEAN DEFAULT false;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "requires_project" BOOLEAN DEFAULT false;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "requires_aux_detail" BOOLEAN DEFAULT false;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3);
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "is_foreign_currency" BOOLEAN DEFAULT false;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "is_budgetable" BOOLEAN DEFAULT true;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "budget_account_id" INTEGER;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "blocked_for_posting" BOOLEAN DEFAULT false;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "blocked_reason" TEXT;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_chart_of_accounts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "level" INTEGER;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "path" VARCHAR(200);
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "center_type" VARCHAR(50);
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "manager_id" UUID;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "has_budget" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "budget_control_type" VARCHAR(20) DEFAULT 'warning';
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "allows_posting" BOOLEAN DEFAULT true;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "payroll_entity_id" INTEGER;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_cost_centers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "code" VARCHAR(3);
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "symbol" VARCHAR(10);
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "decimal_places" INTEGER DEFAULT 2;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "exchange_rate" NUMERIC(15,6) DEFAULT 1;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "last_rate_update" TIMESTAMPTZ;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "rate_source" VARCHAR(50) DEFAULT 'manual';
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_currencies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "dimension_number" INTEGER;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_dimensions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "currency_id" INTEGER;
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "currency_code" VARCHAR(3);
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "buy_rate" NUMERIC(15,6);
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "sell_rate" NUMERIC(15,6);
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "mid_rate" NUMERIC(15,6);
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "effective_date" DATE;
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "effective_time" TIME DEFAULT '00:00:00';
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50) DEFAULT 'manual';
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "source_reference" VARCHAR(200);
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "finance_exchange_rates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "fiscal_year" INTEGER;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "period_number" INTEGER;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "period_name" VARCHAR(50);
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'open';
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "is_adjustment_period" BOOLEAN DEFAULT false;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "closed_by" UUID;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "reopened_at" TIMESTAMPTZ;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "reopened_by" UUID;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "reopen_reason" TEXT;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_fiscal_periods" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "year" INTEGER;
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "month" INTEGER;
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "monthly_rate" NUMERIC(8,4);
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "annual_rate" NUMERIC(8,4);
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "accumulated_rate" NUMERIC(8,4);
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50);
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "is_projected" BOOLEAN DEFAULT false;
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_inflation_rates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "entry_number" VARCHAR(50);
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "fiscal_year" INTEGER;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "fiscal_period" INTEGER;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "entry_date" DATE;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "posting_date" DATE;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "document_date" DATE;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "entry_type" VARCHAR(50);
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(50);
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "source_module" VARCHAR(50);
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "source_document_id" INTEGER;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "source_document_number" VARCHAR(100);
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "reference" VARCHAR(200);
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "exchange_rate" NUMERIC(15,6) DEFAULT 1;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "total_debit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "total_credit" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT false;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "is_reversal" BOOLEAN DEFAULT false;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "reversed_entry_id" INTEGER;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "reversal_date" DATE;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "is_closing_entry" BOOLEAN DEFAULT false;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "posted_at" TIMESTAMPTZ;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "posted_by" UUID;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_journal_entries" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "journal_entry_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "line_number" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "account_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "cost_center_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "project_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_1" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_2" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_3" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_4" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_5" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_6" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_7" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "dimension_8" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "aux_type" VARCHAR(50);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "aux_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "aux_name" VARCHAR(200);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "debit_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "credit_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "original_currency" VARCHAR(3);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "original_amount" NUMERIC(15,2);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "exchange_rate" NUMERIC(15,6);
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "budget_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "budget_line_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "is_reconciled" BOOLEAN DEFAULT false;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "reconciled_at" TIMESTAMPTZ;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "reconciliation_id" INTEGER;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_journal_entry_lines" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "method_type" VARCHAR(30);
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "settlement_type" VARCHAR(30) DEFAULT 'immediate';
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "settlement_days" INTEGER DEFAULT 0;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "settlement_account_id" INTEGER;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "commission_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "commission_fixed" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "tax_on_commission" NUMERIC(5,2) DEFAULT 21;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "requires_reference" BOOLEAN DEFAULT false;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "requires_bank" BOOLEAN DEFAULT false;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "requires_due_date" BOOLEAN DEFAULT false;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "external_processor" VARCHAR(50);
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "processor_config" JSONB DEFAULT '{}';
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "allows_change" BOOLEAN DEFAULT false;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "accepts_partial" BOOLEAN DEFAULT true;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_payment_methods" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "order_number" VARCHAR(50);
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "invoice_ids" JSONB DEFAULT '[]';
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50);
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(5) DEFAULT 'ARS';
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "retentions_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "retentions_detail" JSONB DEFAULT '[]';
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "net_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "fiscal_country_code" VARCHAR(3) DEFAULT 'AR';
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "authorized_by" INTEGER;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "authorized_at" TIMESTAMP;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "paid_at" TIMESTAMP;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "finance_payment_orders" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "fund_id" INTEGER;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "expense_number" VARCHAR(50);
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "expense_date" DATE;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(15,2);
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "has_receipt" BOOLEAN DEFAULT true;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "receipt_type" VARCHAR(30);
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "receipt_number" VARCHAR(100);
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "receipt_date" DATE;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "vendor_name" VARCHAR(200);
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "vendor_tax_id" VARCHAR(20);
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "replenishment_id" INTEGER;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "journal_entry_id" INTEGER;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_petty_cash_expenses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "custodian_id" UUID;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "fund_amount" NUMERIC(15,2);
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "current_balance" NUMERIC(15,2);
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "max_expense_amount" NUMERIC(15,2);
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "replenishment_threshold" NUMERIC(5,2) DEFAULT 20;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "allowed_expense_categories" JSONB DEFAULT '[]';
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "fund_account_id" INTEGER;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "expense_account_id" INTEGER;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "main_register_id" INTEGER;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "last_replenishment_date" DATE;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "last_replenishment_amount" NUMERIC(15,2);
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "finance_petty_cash_funds" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "finger_position" INTEGER;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "template_data" BYTEA;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "minutiae_data" JSONB;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(5,2) DEFAULT 0.0;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "capture_timestamp" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "device_info" JSONB;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "fingerprint_biometric_data" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "receipt_id" INTEGER;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "po_item_id" INTEGER;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "quantity_expected" NUMERIC(12,3);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "quantity_received" NUMERIC(12,3);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "quantity_accepted" NUMERIC(12,3);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "quantity_rejected" NUMERIC(12,3) DEFAULT 0;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "batch_number" VARCHAR(50);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "serial_numbers" JSONB DEFAULT '[]';
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "manufacturing_date" DATE;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "quality_status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "goods_receipt_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "receipt_number" VARCHAR(30);
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "purchase_order_id" INTEGER;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "receipt_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "receipt_time" TIME DEFAULT CURRENT_TIME;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "delivery_note_number" VARCHAR(50);
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "delivery_note_date" DATE;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "carrier_name" VARCHAR(100);
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "vehicle_plate" VARCHAR(20);
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "driver_name" VARCHAR(100);
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "quality_check_required" BOOLEAN DEFAULT false;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "quality_check_status" VARCHAR(20);
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "received_by" INTEGER;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "verified_by" INTEGER;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "issues_found" TEXT;
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "goods_receipts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "country" VARCHAR(100);
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "state_province" VARCHAR(100);
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "date" DATE;
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "is_national" BOOLEAN DEFAULT true;
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "is_provincial" BOOLEAN DEFAULT false;
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "year" INTEGER;
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "holidays" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "agreement_type" VARCHAR(30);
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "document_url" TEXT;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "signed_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_agreements" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "current_balance" NUMERIC(6,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "total_accrued" NUMERIC(8,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "total_used" NUMERIC(8,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "total_expired" NUMERIC(8,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "total_paid_out" NUMERIC(8,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "next_expiry_date" DATE;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "next_expiry_hours" NUMERIC(5,2);
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "last_transaction_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_balances" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "reason" VARCHAR(200);
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "allow_emergencies" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "hour_bank_blackout_dates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "period_label" VARCHAR(50);
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "budget_hours" NUMERIC(10,2) DEFAULT 150.00;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "allocated_hours" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "used_hours" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "available_hours" NUMERIC(10,2);
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "alert_level" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_budgets" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "redemption_request_id" UUID;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "hours_borrowed" NUMERIC(6,2);
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "interest_rate" NUMERIC(4,2) DEFAULT 0;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "interest_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "total_to_repay" NUMERIC(6,2);
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "hours_repaid" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "balance_remaining" NUMERIC(6,2);
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "borrowed_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "fully_repaid_at" TIMESTAMP;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_loans" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "aggregation_level" VARCHAR(20);
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "period_type" VARCHAR(20);
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "period_date" DATE;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "total_overtime_hours" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "overtime_to_bank_hours" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "overtime_to_pay_hours" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "overtime_pending_hours" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "bank_hours_used" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "bank_hours_expired" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "total_bank_balance" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "employee_count" INTEGER DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "avg_balance_per_employee" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "budget_hours" NUMERIC(10,2);
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "budget_used_pct" NUMERIC(5,2);
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "budget_status" VARCHAR(20);
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "employees_at_risk" INTEGER DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "avg_health_score" NUMERIC(5,2) DEFAULT 100;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "vicious_cycle_employees" INTEGER DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "estimated_liability" NUMERIC(14,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "overtime_cost_saved" NUMERIC(14,2) DEFAULT 0;
ALTER TABLE "hour_bank_metrics_aggregated" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "attendance_id" UUID;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "overtime_date" DATE;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "overtime_hours" NUMERIC(5,2);
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "overtime_type" VARCHAR(20);
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "if_paid_amount" NUMERIC(10,2);
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "if_banked_hours" NUMERIC(5,2);
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "conversion_rate" NUMERIC(4,2);
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "decision" VARCHAR(10);
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "decided_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "reminder_sent_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "transaction_id" UUID;
ALTER TABLE "hour_bank_pending_decisions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "request_id" UUID;
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "previous_status" VARCHAR(30);
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "new_status" VARCHAR(30);
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "changed_by" UUID;
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "changed_by_role" VARCHAR(50);
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "comments" TEXT;
ALTER TABLE "hour_bank_redemption_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "hours_requested" NUMERIC(6,2);
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "scheduled_start_time" TIME;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "scheduled_end_time" TIME;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "redemption_type" VARCHAR(20) DEFAULT 'early_departure';
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "balance_at_request" NUMERIC(8,2);
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'pending_supervisor';
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "supervisor_decision" VARCHAR(20);
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "supervisor_decision_at" TIMESTAMP;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "supervisor_comments" TEXT;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "hr_approver_id" UUID;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "hr_decision" VARCHAR(20);
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "hr_decision_at" TIMESTAMP;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "hr_comments" TEXT;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "executed_at" TIMESTAMP;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "actual_hours_used" NUMERIC(6,2);
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "execution_notes" TEXT;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "transaction_id" UUID;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "is_loan_request" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "loan_justification" TEXT;
ALTER TABLE "hour_bank_redemption_requests" ADD COLUMN IF NOT EXISTS "loan_total_debt" NUMERIC(6,2);
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "request_type" VARCHAR(30);
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "requested_date" DATE;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "hours_requested" NUMERIC(5,2);
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "start_time" TIME;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "end_time" TIME;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "supervisor_status" VARCHAR(20);
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "supervisor_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "supervisor_notes" TEXT;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "hr_id" UUID;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "hr_status" VARCHAR(20);
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "hr_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "hr_notes" TEXT;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "approved_hours" NUMERIC(5,2);
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "transaction_id" UUID;
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "analysis_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "total_overtime_hours" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "hours_to_bank" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "hours_to_pay" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "bank_ratio" NUMERIC(5,4);
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "hours_used" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "hours_expired" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "current_balance" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "usage_velocity" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "accumulation_velocity" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "burn_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "months_until_zero" NUMERIC(4,1);
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "return_generated_overtime" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "vicious_cycle_ratio" NUMERIC(5,4) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "vicious_cycle_risk" VARCHAR(20) DEFAULT 'low';
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "coverage_deficit_hours" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "projected_overtime_cost" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "health_score" INTEGER DEFAULT 100;
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "risk_factors" JSONB DEFAULT '[]';
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "recommendations" JSONB DEFAULT '[]';
ALTER TABLE "hour_bank_risk_analysis" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "request_id" UUID;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "hours_approved" NUMERIC(6,2);
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "expected_checkout_time" TIME;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "expected_checkin_time" TIME;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "shift_id" UUID;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "is_executed" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "executed_at" TIMESTAMP;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "actual_checkout_time" TIME;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "actual_checkin_time" TIME;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "compliance_status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "deviation_minutes" INTEGER DEFAULT 0;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_scheduled_redemptions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "template_code" VARCHAR(50);
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(200);
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "is_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "conversion_rate_normal" NUMERIC(4,2) DEFAULT 1.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "conversion_rate_weekend" NUMERIC(4,2) DEFAULT 1.50;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "conversion_rate_holiday" NUMERIC(4,2) DEFAULT 2.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "conversion_rate_night" NUMERIC(4,2) DEFAULT 1.20;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_accumulation_hours" NUMERIC(6,2) DEFAULT 120.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_monthly_accrual" NUMERIC(5,2) DEFAULT 30.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "min_balance_for_use" NUMERIC(4,2) DEFAULT 0.50;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "expiration_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "expiration_months" INTEGER DEFAULT 12;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "expiration_warning_days" INTEGER DEFAULT 30;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "expired_hours_action" VARCHAR(20) DEFAULT 'payout';
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "employee_choice_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "choice_timeout_hours" INTEGER DEFAULT 24;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "default_action" VARCHAR(10) DEFAULT 'bank';
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "choice_reminder_hours" INTEGER DEFAULT 8;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "min_usage_hours" NUMERIC(4,2) DEFAULT 0.50;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_usage_hours_per_day" NUMERIC(4,2) DEFAULT 8.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "allow_partial_day_usage" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "allow_full_day_usage" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "allow_early_departure" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "allow_late_arrival_compensation" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "requires_supervisor_approval" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "requires_hr_approval" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "usage_requires_approval" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "auto_approve_under_hours" NUMERIC(4,2) DEFAULT 2.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "advance_notice_days" INTEGER DEFAULT 2;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "notify_employee_on_accrual" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "notify_supervisor_on_accrual" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "notify_hr_on_accrual" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "notify_on_low_balance" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "low_balance_threshold" NUMERIC(4,2) DEFAULT 4.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "notify_on_high_balance" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "high_balance_threshold" NUMERIC(5,2) DEFAULT 80.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "blackout_dates_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_concurrent_users_percent" NUMERIC(4,2) DEFAULT 20.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "requires_written_agreement" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "union_agreement_required" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "legal_reference" VARCHAR(100);
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "is_current_version" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "parent_template_id" INTEGER;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "budget_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "budget_period_months" INTEGER DEFAULT 6;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "budget_total_hours" NUMERIC(8,2) DEFAULT 150.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "budget_alert_threshold_pct" NUMERIC(5,2) DEFAULT 80.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "budget_critical_threshold_pct" NUMERIC(5,2) DEFAULT 95.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_bank_salary_pct" NUMERIC(5,2) DEFAULT 15.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_monthly_return_hours" NUMERIC(5,2) DEFAULT 16.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "risk_return_overtime_ratio" NUMERIC(4,2) DEFAULT 0.50;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_hours_per_redemption" NUMERIC(4,1) DEFAULT 8.0;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "min_hours_per_redemption" NUMERIC(4,1) DEFAULT 1.0;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "allow_hour_loans" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_loan_hours" NUMERIC(6,2) DEFAULT 8.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "loan_interest_rate" NUMERIC(4,2) DEFAULT 0.00;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "loan_repayment_priority" VARCHAR(20) DEFAULT 'mandatory';
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "max_negative_balance" NUMERIC(8,2) DEFAULT '-16.00';
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "loan_warning_threshold" NUMERIC(6,2) DEFAULT '-8.00';
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "require_loan_justification" BOOLEAN DEFAULT true;
ALTER TABLE "hour_bank_templates" ADD COLUMN IF NOT EXISTS "loan_approval_level" VARCHAR(20) DEFAULT 'hr';
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "transaction_type" VARCHAR(20);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "hours_raw" NUMERIC(5,2);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "conversion_rate" NUMERIC(4,2) DEFAULT 1.00;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "hours_final" NUMERIC(5,2);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "balance_before" NUMERIC(6,2);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "balance_after" NUMERIC(6,2);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "source_attendance_id" UUID;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "source_request_id" UUID;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "expires_at" DATE;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "is_expired" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'completed';
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "overtime_destination" VARCHAR(20);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "attendance_id" INTEGER;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "return_impact_hours" NUMERIC(5,2);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "is_loan" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "loan_original_hours" NUMERIC(6,2);
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "loan_interest_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "loan_repaid" BOOLEAN DEFAULT false;
ALTER TABLE "hour_bank_transactions" ADD COLUMN IF NOT EXISTS "loan_repaid_at" TIMESTAMP;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "case_number" VARCHAR(50);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(50);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "source_id" UUID;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "medical_certificate_id" INTEGER;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "case_type" VARCHAR(50);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "case_subtype" VARCHAR(50);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "cie10_code" VARCHAR(10);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "cie10_description" TEXT;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "body_location" VARCHAR(100);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "days_off" INTEGER DEFAULT 0;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "indicated_violations" TEXT[];
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "violation_notes" TEXT;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "correlated_detections" TEXT[];
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "correlation_score" NUMERIC(5,2);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "correlation_details" JSONB;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "assigned_to" INTEGER;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMPTZ;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "investigation_status" VARCHAR(50) DEFAULT 'PENDING';
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "investigation_deadline" DATE;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "investigation_notes" TEXT;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "verdict" VARCHAR(50);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "verdict_notes" TEXT;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "verdict_by" INTEGER;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "verdict_at" TIMESTAMPTZ;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "confirmed_violations" TEXT[];
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "training_assigned" BOOLEAN DEFAULT false;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "training_ids" TEXT[];
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "sanction_created" BOOLEAN DEFAULT false;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "sanction_id" INTEGER;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "corrective_actions" JSONB;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "preventive_actions" JSONB;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "follow_up_required" BOOLEAN DEFAULT false;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "follow_up_date" DATE;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "follow_up_notes" TEXT;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "external_report_required" BOOLEAN DEFAULT false;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "external_report_sent" BOOLEAN DEFAULT false;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "external_report_date" DATE;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "external_report_number" VARCHAR(100);
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "hse_cases" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "primary_standard" VARCHAR(30) DEFAULT 'ISO45001';
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "secondary_standards" JSONB;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "alert_days_before" JSONB DEFAULT '[30, 15, 7, 1]';
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "notify_employee" BOOLEAN DEFAULT true;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "notify_supervisor" BOOLEAN DEFAULT true;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "notify_hse_manager" BOOLEAN DEFAULT true;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "notify_hr" BOOLEAN DEFAULT false;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "block_work_without_epp" BOOLEAN DEFAULT false;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "require_signature_on_delivery" BOOLEAN DEFAULT true;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "auto_schedule_inspections" BOOLEAN DEFAULT true;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "inspection_frequency_days" INTEGER DEFAULT 90;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "hse_manager_role_id" INTEGER;
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "hse_company_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "zone_config_id" UUID;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "detection_timestamp" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "camera_id" VARCHAR(100);
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "zone_name" VARCHAR(100);
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "detected_ppe" JSONB;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "missing_ppe" TEXT[];
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "confidence_scores" JSONB;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "confidence_avg" NUMERIC(5,2);
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "is_anonymous" BOOLEAN DEFAULT false;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "alert_mode" VARCHAR(20) DEFAULT 'INDIVIDUAL';
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "image_url" TEXT;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "image_blob_path" TEXT;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "image_retention_until" DATE;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "notification_id" UUID;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "training_assigned" BOOLEAN DEFAULT false;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "training_id" INTEGER;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "sanction_created" BOOLEAN DEFAULT false;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "sanction_id" INTEGER;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "hse_case_id" UUID;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'NEW';
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "reviewed_by" INTEGER;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMPTZ;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "review_notes" TEXT;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "azure_request_id" VARCHAR(100);
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "processing_time_ms" INTEGER;
ALTER TABLE "hse_ppe_detections" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "zone_name" VARCHAR(100);
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "stat_date" DATE;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "total_checks" INTEGER DEFAULT 0;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "compliant_count" INTEGER DEFAULT 0;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "violation_count" INTEGER DEFAULT 0;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "compliance_rate" NUMERIC(5,2);
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "violations_by_ppe" JSONB;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "violations_by_hour" JSONB;
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_ppe_stats" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "name_short" VARCHAR(50);
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "is_detectable_by_ai" BOOLEAN DEFAULT false;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "ai_model_tag" VARCHAR(100);
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "ai_confidence_threshold" NUMERIC(3,2) DEFAULT 0.70;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "is_medical_selectable" BOOLEAN DEFAULT true;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "related_cie10_codes" TEXT[];
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "body_locations" TEXT[];
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "default_training_template_id" INTEGER;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "training_is_mandatory" BOOLEAN DEFAULT true;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "default_sanction_type" VARCHAR(50);
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "reincidence_threshold" INTEGER DEFAULT 3;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "hse_violation_catalog" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "zone_code" VARCHAR(50);
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "zone_name" VARCHAR(200);
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "zone_description" TEXT;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "required_ppe_codes" TEXT[];
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "camera_config" JSONB;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "monitoring_schedule" JSONB;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "monitoring_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "alert_config" JSONB DEFAULT '{"period_days": 30, "confidence_min": 0.70, "threshold_warning": 1, "threshold_sanction": 5, "threshold_training": 3, "check_interval_seconds": 300}';
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "affected_position_ids" TEXT[];
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "hse_zone_configurations" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "invoice_id" BIGINT;
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "item_type" VARCHAR(50);
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "quantity" INTEGER DEFAULT 1;
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(12,2);
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(12,2);
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "invoice_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "invoice_number" VARCHAR(50);
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "billing_period_month" INTEGER;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "billing_period_year" INTEGER;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "tax_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(12,2);
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'USD';
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMPTZ;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "paid_at" TIMESTAMPTZ;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "invoice_pdf_path" VARCHAR(500);
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "invoice_pdf_uploaded_at" TIMESTAMPTZ;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "invoice_pdf_uploaded_by" UUID;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "sent_to_email" VARCHAR(255);
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "sent_by" UUID;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "email_subject" VARCHAR(500);
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "email_body" TEXT;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "send_attempts" INTEGER DEFAULT 0;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "last_send_error" TEXT;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "contract_id" UUID;
ALTER TABLE "invoices" ADD COLUMN IF NOT EXISTS "quote_id" INTEGER;
ALTER TABLE "job_application_notes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "job_application_notes" ADD COLUMN IF NOT EXISTS "application_id" INTEGER;
ALTER TABLE "job_application_notes" ADD COLUMN IF NOT EXISTS "note_type" VARCHAR(50) DEFAULT 'general';
ALTER TABLE "job_application_notes" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "job_application_notes" ADD COLUMN IF NOT EXISTS "is_private" BOOLEAN DEFAULT false;
ALTER TABLE "job_application_notes" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "job_application_notes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "job_posting_id" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_first_name" VARCHAR(100);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_last_name" VARCHAR(100);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_email" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_phone" VARCHAR(50);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_dni" VARCHAR(20);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_birth_date" DATE;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_gender" VARCHAR(20);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_nationality" VARCHAR(100);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_address" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_city" VARCHAR(100);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_province" VARCHAR(100);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "candidate_postal_code" VARCHAR(20);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "experience_years" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "current_position" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "current_company" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "education_level" VARCHAR(50);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "education_title" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "skills" JSONB DEFAULT '[]';
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "languages" JSONB DEFAULT '[]';
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "certifications" JSONB DEFAULT '[]';
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "cv_file_path" VARCHAR(500);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "cv_file_name" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "cv_uploaded_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "cover_letter" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "additional_documents" JSONB DEFAULT '[]';
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "salary_expectation" NUMERIC(12,2);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "availability" VARCHAR(50);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "preferred_schedule" VARCHAR(100);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "willing_to_relocate" BOOLEAN DEFAULT false;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'nuevo';
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "status_history" JSONB DEFAULT '[]';
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "reviewed_by" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "review_notes" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "review_score" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "interview_scheduled_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "interview_location" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "interview_type" VARCHAR(50);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "interview_notes" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "interview_score" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "interviewer_id" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "admin_approved_by" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "admin_approved_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "admin_approval_notes" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "medical_record_id" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "medical_exam_date" DATE;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "medical_result" VARCHAR(50);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "medical_observations" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "medical_restrictions" JSONB DEFAULT '[]';
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "medical_approved_by" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "medical_approved_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "hired_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "hired_by" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "employee_user_id" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "assigned_department_id" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "assigned_position" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "final_salary" NUMERIC(12,2);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "contract_type" VARCHAR(50);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "rejected_by" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "rejection_reason" VARCHAR(255);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "rejection_notes" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "rejection_stage" VARCHAR(50);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "notification_sent_to_medical" BOOLEAN DEFAULT false;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMPTZ;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "source" VARCHAR(100);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "referrer_employee_id" UUID;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "applied_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "job_applications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "requirements" TEXT;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "responsibilities" TEXT;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "department_name" VARCHAR(100);
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "location" VARCHAR(255);
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "job_type" VARCHAR(50) DEFAULT 'full-time';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "salary_min" NUMERIC(12,2);
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "salary_max" NUMERIC(12,2);
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "salary_currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "salary_period" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "benefits" JSONB DEFAULT '[]';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "is_public" BOOLEAN DEFAULT true;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "is_internal" BOOLEAN DEFAULT false;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "max_applications" INTEGER;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "auto_close_date" DATE;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "requires_cv" BOOLEAN DEFAULT true;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "requires_cover_letter" BOOLEAN DEFAULT false;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "tags" JSONB DEFAULT '[]';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "skills_required" JSONB DEFAULT '[]';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "hiring_manager_id" UUID;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "recruiter_id" UUID;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "views_count" INTEGER DEFAULT 0;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "applications_count" INTEGER DEFAULT 0;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "posted_at" TIMESTAMPTZ;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "search_scope" VARCHAR(20) DEFAULT 'external';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "internal_matching_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "internal_matching_criteria" JSONB DEFAULT '{"match_skills": true, "match_education": true, "min_match_score": 50, "match_experience": true, "match_certifications": true}';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "internal_candidates_notified" JSONB DEFAULT '[]';
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "internal_matching_executed_at" TIMESTAMP;
ALTER TABLE "job_postings" ADD COLUMN IF NOT EXISTS "internal_candidates_count" INTEGER DEFAULT 0;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(100);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "gps_lat" NUMERIC(10,8);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "gps_lng" NUMERIC(11,8);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "is_configured" BOOLEAN DEFAULT false;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "location" TEXT;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "authorized_departments" JSONB DEFAULT '[]';
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "has_external_reader" BOOLEAN DEFAULT false;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "reader_model" VARCHAR(100);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "reader_config" JSONB DEFAULT '{}';
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(50);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "port" INTEGER DEFAULT 9998;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "last_seen" TIMESTAMP;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "apk_version" VARCHAR(20);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "hardware_profile" VARCHAR(100);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "hardware_category" VARCHAR(50);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "detection_method_facial" VARCHAR(100);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "detection_method_fingerprint" VARCHAR(100);
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "performance_score" INTEGER DEFAULT 0;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "supports_walkthrough" BOOLEAN DEFAULT false;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "supports_liveness" BOOLEAN DEFAULT false;
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "biometric_modes" JSONB DEFAULT '[]';
ALTER TABLE "kiosks" ADD COLUMN IF NOT EXISTS "hardware_specs" JSONB DEFAULT '{}';
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "name" VARCHAR(300);
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "industry" VARCHAR(100);
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "union_name" VARCHAR(200);
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "labor_agreements_catalog" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "name" VARCHAR(300);
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "short_name" VARCHAR(100);
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "industry" VARCHAR(200);
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "legal_references" JSONB DEFAULT '[]';
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "effective_date" DATE;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "base_work_hours_weekly" NUMERIC(5,2) DEFAULT 48;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "base_work_hours_daily" NUMERIC(5,2) DEFAULT 8;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "overtime_threshold_daily" NUMERIC(5,2) DEFAULT 8;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "overtime_50_multiplier" NUMERIC(4,2) DEFAULT 1.50;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "overtime_100_multiplier" NUMERIC(4,2) DEFAULT 2.00;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "night_shift_multiplier" NUMERIC(4,2) DEFAULT 1.00;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "vacation_days_by_seniority" JSONB DEFAULT '[{"days": 14, "max_years": 5, "min_years": 0}, {"days": 21, "max_years": 10, "min_years": 5}, {"days": 28, "max_years": 20, "min_years": 10}, {"days": 35, "max_years": null, "min_years": 20}]';
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "receipt_legal_text" TEXT;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "receipt_footer_text" TEXT;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "labor_agreements_v2" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "request_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "scheduled_time" TIME;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "actual_arrival_time" TIME;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "minutes_late" INTEGER;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "shift_id" UUID;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "shift_name" VARCHAR(100);
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "requested_authorizer_id" UUID;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "actual_authorizer_id" UUID;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "authorizer_position" VARCHAR(200);
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "authorization_window_start" TIMESTAMP;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "authorization_window_end" TIMESTAMP;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "decision_timestamp" TIMESTAMP;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "decision_reason" TEXT;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMP;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "notification_channels" JSONB DEFAULT '[]';
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 0;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "escalated_at" TIMESTAMP;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "attendance_id" UUID;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "late_arrival_authorizations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "rule_name" VARCHAR(100);
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "rule_type" VARCHAR(20);
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "min_score" INTEGER;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "min_bant_total" INTEGER;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "min_bant_individual" INTEGER;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "required_activities" JSONB;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "min_engagement_days" INTEGER;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "must_have_decision_maker" BOOLEAN DEFAULT false;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "must_have_budget_date" BOOLEAN DEFAULT false;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "must_have_timeline" BOOLEAN DEFAULT false;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "auto_transition" BOOLEAN DEFAULT false;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "notification_required" BOOLEAN DEFAULT true;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 0;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "lead_qualification_rules" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "lead_scoring_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "lead_scoring_config" ADD COLUMN IF NOT EXISTS "activity_type" TEXT;
ALTER TABLE "lead_scoring_config" ADD COLUMN IF NOT EXISTS "score_value" INTEGER;
ALTER TABLE "lead_scoring_config" ADD COLUMN IF NOT EXISTS "description" VARCHAR(255);
ALTER TABLE "lead_scoring_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "lead_scoring_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "lead_scoring_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "test_count" INTEGER DEFAULT 0;
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "total_passed" INTEGER DEFAULT 0;
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "total_failed" INTEGER DEFAULT 0;
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "last_score" INTEGER DEFAULT 0;
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "patterns_json" JSONB DEFAULT '{}';
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "learning_patterns" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "case_id" INTEGER;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "analysis_type" VARCHAR(50);
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "prompt_used" TEXT;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "analysis_result" TEXT;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(3,2);
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "structured_data" JSONB;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "related_deadline_id" INTEGER;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "related_document_id" INTEGER;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "model_used" VARCHAR(50) DEFAULT 'llama3.1:8b';
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "tokens_used" INTEGER;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "processing_time_ms" INTEGER;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "is_reviewed" BOOLEAN DEFAULT false;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "reviewed_by" UUID;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "review_notes" TEXT;
ALTER TABLE "legal_ai_analysis" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "case_id" INTEGER;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "stage_id" INTEGER;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "timeline_event_id" INTEGER;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(50);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(500);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "file_path" VARCHAR(1000);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "file_size" INTEGER;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "document_date" DATE;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(100);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "title" VARCHAR(500);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "is_confidential" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "is_original" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "is_certified" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "from_employee_360" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "original_table" VARCHAR(100);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "original_id" INTEGER;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "uploaded_by" UUID;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "expects_response" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "response_type" VARCHAR(50);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "response_deadline" DATE;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "response_received" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "response_received_at" TIMESTAMP;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "response_document_id" INTEGER;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "is_locked" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "locked_at" TIMESTAMP;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "lock_reason" VARCHAR(255);
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "edit_window_hours" INTEGER DEFAULT 72;
ALTER TABLE "legal_case_documents" ADD COLUMN IF NOT EXISTS "can_edit_until" TIMESTAMP;
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "case_id" INTEGER;
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "party_type" VARCHAR(30);
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "role_description" VARCHAR(255);
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "is_internal" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_parties" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "case_id" INTEGER;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "stage" VARCHAR(30);
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "sub_status" VARCHAR(50);
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "start_date" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "end_date" TIMESTAMP;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "outcome" VARCHAR(50);
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "outcome_details" TEXT;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "recorded_by" UUID;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "sequence_order" INTEGER;
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_stages" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "case_id" INTEGER;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "stage_id" INTEGER;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "title" VARCHAR(500);
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "event_date" TIMESTAMP;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "importance" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "is_public" BOOLEAN DEFAULT true;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "is_milestone" BOOLEAN DEFAULT false;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "document_id" INTEGER;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "related_event_id" INTEGER;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_case_timeline_events" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "case_number" VARCHAR(50);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "external_case_number" VARCHAR(100);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "case_type" VARCHAR(50);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(255);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "employee_position" VARCHAR(255);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "employee_department" VARCHAR(255);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "employee_hire_date" DATE;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "employee_termination_date" DATE;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "title" VARCHAR(500);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "claimed_amount" NUMERIC(15,2);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "plaintiff_lawyer" VARCHAR(255);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "plaintiff_lawyer_contact" TEXT;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "defendant_lawyer" VARCHAR(255);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "defendant_lawyer_id" UUID;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "jurisdiction" VARCHAR(100);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "jurisdiction_code" VARCHAR(10);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "judge_name" VARCHAR(255);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "current_stage" VARCHAR(30) DEFAULT 'prejudicial';
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "current_sub_status" VARCHAR(50);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "resolution_type" VARCHAR(30);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "resolution_amount" NUMERIC(15,2);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "resolution_date" DATE;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "resolution_summary" TEXT;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "incident_date" DATE;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "notification_date" DATE;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "filing_date" DATE;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "risk_assessment" VARCHAR(20);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "estimated_exposure" NUMERIC(15,2);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "is_confidential" BOOLEAN DEFAULT false;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "requires_reserve" BOOLEAN DEFAULT false;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "reserve_amount" NUMERIC(15,2);
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "employee_360_snapshot" JSONB;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "assigned_to" UUID;
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_cases" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMP;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "id" VARCHAR(50);
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "legal_basis" TEXT;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "legal_requirements" TEXT;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "requires_response" BOOLEAN DEFAULT false;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "response_days" INTEGER DEFAULT 5;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "requires_witness" BOOLEAN DEFAULT false;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "requires_signature" BOOLEAN DEFAULT true;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "requires_notification_receipt" BOOLEAN DEFAULT true;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "template_content" TEXT;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "creates_antecedent" BOOLEAN DEFAULT true;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "max_before_escalation" INTEGER;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "escalation_type_id" VARCHAR(50);
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "legal_communication_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "id" VARCHAR(100);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "type_id" VARCHAR(50);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "reference_number" VARCHAR(100);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(500);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "facts_description" TEXT;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "legal_articles" TEXT;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'draft';
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "sent_date" TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "delivery_date" TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "response_deadline" DATE;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "response_date" TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "closed_date" TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "employee_response" TEXT;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "employee_accepted" BOOLEAN;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "witness_1_name" VARCHAR(255);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "witness_1_id" VARCHAR(50);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "witness_1_signature" BOOLEAN DEFAULT false;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "witness_2_name" VARCHAR(255);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "witness_2_id" VARCHAR(50);
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "witness_2_signature" BOOLEAN DEFAULT false;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "pdf_path" TEXT;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "signed_pdf_path" TEXT;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "is_locked" BOOLEAN DEFAULT false;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "locked_at" TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "edit_count" INTEGER DEFAULT 0;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "last_edited_by" UUID;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "last_edited_at" TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "is_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "deleted_by" UUID;
ALTER TABLE "legal_communications" ADD COLUMN IF NOT EXISTS "deletion_reason" TEXT;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "case_id" INTEGER;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "stage_id" INTEGER;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "deadline_type" VARCHAR(50);
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "title" VARCHAR(500);
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "due_date" TIMESTAMP;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "reminder_date" TIMESTAMP;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "alert_days_before" INTEGER DEFAULT 3;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "completed_by" UUID;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "assigned_to" UUID;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "notify_users" TEXT[];
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "notification_group_id" VARCHAR(100);
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "notifications_sent" JSONB DEFAULT '[]';
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "is_recurring" BOOLEAN DEFAULT false;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "recurrence_pattern" VARCHAR(50);
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "recurrence_end_date" DATE;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_deadlines" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "document_id" INTEGER;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "case_id" INTEGER;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "alert_type" VARCHAR(50);
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20) DEFAULT 'warning';
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "is_resolved" BOOLEAN DEFAULT false;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMP;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "resolved_by" UUID;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "legal_document_alerts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "record_id" INTEGER;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "record_table" VARCHAR(50);
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "record_type" VARCHAR(50);
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "requested_by" UUID;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "request_reason" TEXT;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(20);
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "proposed_changes" JSONB;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorized_by" UUID;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorized_at" TIMESTAMP;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorization_response" TEXT;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "current_step" INTEGER DEFAULT 1;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "escalated_at" TIMESTAMP;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "escalation_reason" VARCHAR(255);
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorization_window_start" TIMESTAMP;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorization_window_end" TIMESTAMP;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "window_used" BOOLEAN DEFAULT false;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "window_used_at" TIMESTAMP;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "window_action_performed" VARCHAR(50);
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "notification_group_id" VARCHAR(100);
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "jurisdiction_code" VARCHAR(10);
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "audit_trail" JSONB DEFAULT '[]';
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "legal_edit_authorizations" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "business_type" VARCHAR(30) DEFAULT 'DISTRIBUTOR';
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "features" JSONB DEFAULT '{"own_fleet": false, "pod_capture": true, "tms_enabled": true, "wms_enabled": true, "lot_tracking": true, "wave_picking": true, "zone_picking": false, "batch_picking": true, "cross_docking": false, "multi_carrier": true, "cycle_counting": true, "expiry_tracking": true, "multi_warehouse": true, "serial_tracking": false, "returns_management": true}';
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "numbering" JSONB DEFAULT '{"wave_prefix": "WV", "route_prefix": "RT", "receipt_prefix": "RC", "shipment_prefix": "SH", "pick_list_prefix": "PL", "pack_order_prefix": "PK"}';
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "default_weight_uom" VARCHAR(10) DEFAULT 'kg';
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "default_volume_uom" VARCHAR(10) DEFAULT 'm3';
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "default_length_uom" VARCHAR(10) DEFAULT 'cm';
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_business_profiles" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "rule_code" VARCHAR(50);
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "rule_name" VARCHAR(100);
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "rule_type" VARCHAR(30);
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "conditions" JSONB;
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "actions" JSONB;
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 100;
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_business_rules" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "type" VARCHAR(30) DEFAULT 'EXTERNAL';
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(100);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "email" VARCHAR(100);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "website" VARCHAR(200);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(30);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "legal_name" VARCHAR(200);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "services" JSONB DEFAULT '["STANDARD"]';
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "coverage_zones" JSONB;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "has_flat_rate" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "flat_rate" NUMERIC(12,2);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "has_weight_rate" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "weight_rate_per_kg" NUMERIC(10,4);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "has_volume_rate" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "volume_rate_per_m3" NUMERIC(10,4);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "min_charge" NUMERIC(12,2);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "fuel_surcharge_pct" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "api_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "api_url" VARCHAR(500);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "api_key_encrypted" TEXT;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "tracking_url_template" VARCHAR(500);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "avg_delivery_days" NUMERIC(4,1);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "on_time_pct" NUMERIC(5,2);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "damage_rate_pct" NUMERIC(5,2);
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_carriers" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "zone_id" INTEGER;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "custom_delivery_days" JSONB;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "custom_time_from" TIME;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "custom_time_to" TIME;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "priority_level" INTEGER DEFAULT 5;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "custom_delivery_cost" NUMERIC(12,2);
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "custom_free_threshold" NUMERIC(12,2);
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_customer_zone_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "zone_type" VARCHAR(30) DEFAULT 'GEOGRAPHIC';
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "country" VARCHAR(50) DEFAULT 'Argentina';
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "localities" JSONB;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "postal_codes" JSONB;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "polygon_geojson" JSONB;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "delivery_days" JSONB DEFAULT '{"fri": true, "mon": true, "sat": false, "sun": false, "thu": true, "tue": true, "wed": true}';
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "delivery_time_from" TIME DEFAULT '08:00:00';
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "delivery_time_to" TIME DEFAULT '18:00:00';
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "frequency" VARCHAR(20) DEFAULT 'DAILY';
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "frequency_days" JSONB;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "default_carrier_id" INTEGER;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "carrier_service_type" VARCHAR(50);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "delivery_cost" NUMERIC(12,2);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "free_shipping_threshold" NUMERIC(12,2);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "express_surcharge" NUMERIC(12,2);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "lead_time_hours" INTEGER DEFAULT 24;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "cutoff_time" TIME DEFAULT '14:00:00';
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "min_order_value" NUMERIC(12,2);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "max_weight_kg" NUMERIC(10,2);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "max_volume_m3" NUMERIC(10,4);
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 10;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_delivery_zones" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "license_number" VARCHAR(50);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "license_type" VARCHAR(20);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "license_expiry" DATE;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(20);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "email" VARCHAR(100);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "emergency_contact_name" VARCHAR(100);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "emergency_contact_phone" VARCHAR(50);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "default_vehicle_id" INTEGER;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "default_zone_ids" JSONB;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'AVAILABLE';
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "total_deliveries" INTEGER DEFAULT 0;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "successful_deliveries" INTEGER DEFAULT 0;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "avg_rating" NUMERIC(3,2);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "app_registered" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "app_device_id" VARCHAR(100);
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "last_app_activity" TIMESTAMP;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "is_available" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "current_vehicle_id" INTEGER;
ALTER TABLE "logistics_drivers" ADD COLUMN IF NOT EXISTS "carrier_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "movement_type" VARCHAR(30);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "source_number" VARCHAR(50);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "uom_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "uom_code" VARCHAR(20);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(50);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "from_location_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "from_location_code" VARCHAR(50);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "to_location_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "to_location_code" VARCHAR(50);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "container_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "container_code" VARCHAR(50);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "lpn" VARCHAR(50);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "total_cost" NUMERIC(15,4);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "planned_at" TIMESTAMP;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "executed_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "executed_by" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "executed_by_name" VARCHAR(100);
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'COMPLETED';
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "task_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "wave_id" INTEGER;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_inventory_movements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(30);
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "affects_inventory" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "allows_negative" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "requires_lot" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "requires_serial" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "requires_expiry" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "is_pickable" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "is_puttable" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "zone_sequence" INTEGER DEFAULT 0;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_location_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "location_type_id" INTEGER;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "zone_code" VARCHAR(20);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "aisle" VARCHAR(10);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "rack" VARCHAR(10);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "level" VARCHAR(10);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "position" VARCHAR(10);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "width_cm" NUMERIC(8,2);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(8,2);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "depth_cm" NUMERIC(8,2);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "max_weight_kg" NUMERIC(10,2);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "max_volume_m3" NUMERIC(10,4);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "temperature_controlled" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "min_temperature" NUMERIC(5,2);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "max_temperature" NUMERIC(5,2);
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "humidity_controlled" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "hazmat_allowed" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "heavy_items" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "velocity_class" VARCHAR(1) DEFAULT 'C';
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "pick_frequency" INTEGER DEFAULT 0;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "golden_zone" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "current_sku_count" INTEGER DEFAULT 0;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "current_qty" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "last_movement_at" TIMESTAMP;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "last_count_at" TIMESTAMP;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_locations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "pack_number" VARCHAR(30);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "pick_list_id" INTEGER;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "source_number" VARCHAR(50);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "customer_name" VARCHAR(200);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "ship_to_address" TEXT;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "packing_station" VARCHAR(30);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "assigned_to" INTEGER;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "assigned_to_name" VARCHAR(100);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "packed_items" INTEGER DEFAULT 0;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "total_packages" INTEGER DEFAULT 0;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "total_weight_kg" NUMERIC(10,3);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "total_volume_m3" NUMERIC(10,4);
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMP;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "logistics_pack_orders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "package_id" INTEGER;
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "uom_id" INTEGER;
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "uom_code" VARCHAR(20);
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(50);
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "pick_list_line_id" INTEGER;
ALTER TABLE "logistics_package_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "length_cm" NUMERIC(8,2);
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "width_cm" NUMERIC(8,2);
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(8,2);
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "max_weight_kg" NUMERIC(10,2);
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "tare_weight_kg" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "is_pallet" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "is_box" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "is_envelope" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_package_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "pack_order_id" INTEGER;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "package_number" VARCHAR(30);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "tracking_number" VARCHAR(100);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "lpn" VARCHAR(50);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "package_type_id" INTEGER;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "package_type_code" VARCHAR(30);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "length_cm" NUMERIC(8,2);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "width_cm" NUMERIC(8,2);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(8,2);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "weight_kg" NUMERIC(10,3);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "dimensional_weight_kg" NUMERIC(10,3);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'OPEN';
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "carrier_id" INTEGER;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "carrier_code" VARCHAR(30);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "service_type" VARCHAR(50);
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "label_printed" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "label_printed_at" TIMESTAMP;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMP;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "closed_by" INTEGER;
ALTER TABLE "logistics_packages" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "pick_list_id" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "line_number" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "qty_requested" NUMERIC(15,4);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "qty_picked" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "qty_short" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "uom_id" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "uom_code" VARCHAR(20);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "suggested_location_id" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "suggested_location_code" VARCHAR(50);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "actual_location_id" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "actual_location_code" VARCHAR(50);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(50);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "source_lpn" VARCHAR(50);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "target_lpn" VARCHAR(50);
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "picked_at" TIMESTAMP;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "picked_by" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "pick_sequence" INTEGER;
ALTER TABLE "logistics_pick_list_lines" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "wave_id" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "pick_list_number" VARCHAR(30);
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "pick_type" VARCHAR(20) DEFAULT 'ORDER';
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "source_number" VARCHAR(50);
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "customer_name" VARCHAR(200);
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 5;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "assigned_to" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "assigned_to_name" VARCHAR(100);
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "total_lines" INTEGER DEFAULT 0;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "picked_lines" INTEGER DEFAULT 0;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "total_qty" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "picked_qty" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMP;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "staging_location_id" INTEGER;
ALTER TABLE "logistics_pick_lists" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "default_location_id" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "storage_type" VARCHAR(30) DEFAULT 'AMBIENT';
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "min_temperature" NUMERIC(5,2);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "max_temperature" NUMERIC(5,2);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "requires_lot" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "requires_serial" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "requires_expiry" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "shelf_life_days" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "expiry_alert_days" INTEGER DEFAULT 30;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "storage_uom_id" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "picking_uom_id" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "units_per_pallet" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "units_per_layer" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "layers_per_pallet" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "unit_length_cm" NUMERIC(8,2);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "unit_width_cm" NUMERIC(8,2);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "unit_height_cm" NUMERIC(8,2);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "unit_weight_kg" NUMERIC(10,4);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "unit_volume_m3" NUMERIC(10,6);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "velocity_class" VARCHAR(1) DEFAULT 'C';
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "pick_frequency" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "preferred_zone" VARCHAR(30);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "stackable" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "max_stack_height" INTEGER;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "fragile" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "hazmat" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "hazmat_class" VARCHAR(20);
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "min_pick_qty" NUMERIC(15,4) DEFAULT 1;
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_product_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "lot_id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(50);
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "reserved_quantity" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "uom_id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "uom_code" VARCHAR(20);
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "lpn" VARCHAR(50);
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "pallet_id" INTEGER;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "incoming_date" DATE;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "last_movement_at" TIMESTAMP;
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_quants" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "route_id" INTEGER;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "sequence" INTEGER;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "stop_type" VARCHAR(20);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "customer_name" VARCHAR(200);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "postal_code" VARCHAR(20);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,8);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(11,8);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(100);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(50);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "delivery_instructions" TEXT;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "source_number" VARCHAR(50);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "package_ids" JSONB;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "package_count" INTEGER DEFAULT 0;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "total_weight_kg" NUMERIC(10,2);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "collect_payment" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "payment_amount" NUMERIC(15,2);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "payment_collected" NUMERIC(15,2);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(30);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "time_window_from" TIME;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "time_window_to" TIME;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "eta" TIMESTAMP;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "estimated_duration_minutes" INTEGER DEFAULT 15;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "arrived_at" TIMESTAMP;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "signature_captured" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "signature_data" TEXT;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "photo_urls" JSONB;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(100);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "recipient_dni" VARCHAR(20);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "delivery_result" VARCHAR(30);
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "failure_reason" TEXT;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "items_returned" JSONB;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_route_stops" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "route_number" VARCHAR(30);
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "route_date" DATE;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "route_type" VARCHAR(20) DEFAULT 'DELIVERY';
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "vehicle_id" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "driver_id" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "carrier_id" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "zone_ids" JSONB;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'DRAFT';
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "planned_stops" INTEGER DEFAULT 0;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "planned_packages" INTEGER DEFAULT 0;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "planned_weight_kg" NUMERIC(10,2);
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "planned_distance_km" NUMERIC(10,2);
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "planned_duration_minutes" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "actual_stops" INTEGER DEFAULT 0;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "completed_stops" INTEGER DEFAULT 0;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "failed_stops" INTEGER DEFAULT 0;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "actual_packages" INTEGER DEFAULT 0;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "actual_distance_km" NUMERIC(10,2);
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "planned_departure" TIMESTAMP;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "planned_return" TIMESTAMP;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "actual_departure" TIMESTAMP;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "actual_return" TIMESTAMP;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "loading_started_at" TIMESTAMP;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "loading_completed_at" TIMESTAMP;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "loaded_by" INTEGER;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "optimization_mode" VARCHAR(20) DEFAULT 'DISTANCE';
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "sequence_locked" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_routes" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "shipment_id" INTEGER;
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "status_description" VARCHAR(200);
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "location" VARCHAR(200);
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,8);
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(11,8);
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "source" VARCHAR(20) DEFAULT 'SYSTEM';
ALTER TABLE "logistics_shipment_tracking" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "shipment_number" VARCHAR(30);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "source_number" VARCHAR(50);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "customer_name" VARCHAR(200);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_to_address" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_to_city" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_to_province" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_to_country" VARCHAR(50);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_to_postal_code" VARCHAR(20);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_to_lat" NUMERIC(10,8);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_to_lng" NUMERIC(11,8);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(50);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "contact_email" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "carrier_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "carrier_code" VARCHAR(30);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "carrier_service" VARCHAR(50);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "tracking_number" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "route_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "route_stop_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "package_count" INTEGER DEFAULT 0;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "total_weight_kg" NUMERIC(10,3);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "total_volume_m3" NUMERIC(10,4);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "declared_value" NUMERIC(15,2);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "insurance_required" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "shipping_cost" NUMERIC(12,2);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "insurance_cost" NUMERIC(12,2);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "ship_date" DATE;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "promised_date" DATE;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivered_date" DATE;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "pod_captured" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "pod_signature" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "pod_photo_urls" JSONB;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "pod_recipient_name" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "pod_timestamp" TIMESTAMP;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "has_incident" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "incident_type" VARCHAR(30);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "incident_description" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "vehicle_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "driver_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_zone_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "pack_order_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "source_document_type" VARCHAR(30);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "source_document_id" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_address" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_city" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_state" VARCHAR(100);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_postal_code" VARCHAR(20);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_country" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_contact_name" VARCHAR(200);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_contact_phone" VARCHAR(50);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_instructions" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_priority" VARCHAR(20) DEFAULT 'NORMAL';
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "estimated_delivery_date" DATE;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "actual_delivery_date" TIMESTAMP;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "time_window_from" TIME;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "time_window_to" TIME;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "service_type" VARCHAR(20) DEFAULT 'STANDARD';
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "requires_signature" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "requires_photo" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "insurance_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "signature_data" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_photo_urls" JSONB;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(200);
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "delivery_attempts" INTEGER DEFAULT 0;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "last_attempt_date" TIMESTAMP;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "next_attempt_date" TIMESTAMP;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "cancellation_reason" TEXT;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "cancelled_at" TIMESTAMP;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "cancelled_by" INTEGER;
ALTER TABLE "logistics_shipments" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "plate_number" VARCHAR(20);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "type" VARCHAR(30);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "brand" VARCHAR(50);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "model" VARCHAR(50);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "year" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "color" VARCHAR(30);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "max_weight_kg" NUMERIC(10,2);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "max_volume_m3" NUMERIC(10,4);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "max_pallets" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "max_packages" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "refrigerated" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "min_temperature" NUMERIC(5,2);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "max_temperature" NUMERIC(5,2);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "hazmat_certified" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "gps_device_id" VARCHAR(100);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "last_known_lat" NUMERIC(10,8);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "last_known_lng" NUMERIC(11,8);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "last_gps_update" TIMESTAMP;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "insurance_expiry" DATE;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "vtv_expiry" DATE;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'AVAILABLE';
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "current_driver_id" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "current_route_id" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "total_km" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "avg_fuel_consumption" NUMERIC(6,2);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "carrier_id" INTEGER;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "is_available" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "vehicle_type" VARCHAR(30) DEFAULT 'VAN';
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "vin" VARCHAR(50);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "max_weight" NUMERIC(10,2);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "max_volume" NUMERIC(10,2);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "fuel_type" VARCHAR(20) DEFAULT 'DIESEL';
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "gps_device_id_old" VARCHAR(50);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "insurance_number" VARCHAR(50);
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "logistics_vehicles" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "inbound_steps" INTEGER DEFAULT 1;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "require_po_match" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "auto_putaway" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "require_inbound_qc" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "allow_over_receiving" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "over_receiving_tolerance" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "putaway_method" VARCHAR(30) DEFAULT 'DIRECTED';
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "use_abc_slotting" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "reserve_pick_locations" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "auto_replenish_pick" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "picking_method" VARCHAR(30) DEFAULT 'WAVE';
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "wave_release_mode" VARCHAR(20) DEFAULT 'MANUAL';
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "default_wave_size" INTEGER DEFAULT 50;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "allow_partial_pick" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "backorder_handling" VARCHAR(20) DEFAULT 'CREATE';
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "pick_confirmation" VARCHAR(20) DEFAULT 'SCAN';
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "packing_required" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "auto_cartonization" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "print_packing_slip" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "weight_verification" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "shipping_steps" INTEGER DEFAULT 1;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "require_carrier_assignment" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "auto_route_assignment" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "staging_required" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "loading_verification" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "cross_dock_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "cross_dock_max_hours" INTEGER DEFAULT 24;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "cycle_count_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "cycle_count_frequency" VARCHAR(20) DEFAULT 'WEEKLY';
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "negative_inventory_allowed" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "lot_tracking_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "serial_tracking_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "expiry_tracking_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "low_stock_alert" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "expiry_alert_days" INTEGER DEFAULT 30;
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_warehouse_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "type" VARCHAR(30) DEFAULT 'PROPIO';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "country" VARCHAR(50) DEFAULT 'Argentina';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "postal_code" VARCHAR(20);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,8);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(11,8);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(50) DEFAULT 'America/Argentina/Buenos_Aires';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "operation_mode" VARCHAR(30) DEFAULT 'STANDARD';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "picking_strategy" VARCHAR(30) DEFAULT 'FIFO';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "putaway_strategy" VARCHAR(30) DEFAULT 'DIRECTED';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "total_area_m2" NUMERIC(12,2);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "storage_area_m2" NUMERIC(12,2);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "max_pallets" INTEGER;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "max_sku" INTEGER;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "working_days" JSONB DEFAULT '{"fri": true, "mon": true, "sat": false, "sun": false, "thu": true, "tue": true, "wed": true}';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "shift_start" TIME DEFAULT '08:00:00';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "shift_end" TIME DEFAULT '18:00:00';
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "wcs_integration" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "mhe_integration" BOOLEAN DEFAULT false;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "manager_id" INTEGER;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "manager_name" VARCHAR(100);
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_warehouses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "wave_number" VARCHAR(30);
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "wave_type" VARCHAR(20) DEFAULT 'STANDARD';
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "grouping_criteria" JSONB;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'DRAFT';
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "total_orders" INTEGER DEFAULT 0;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "total_lines" INTEGER DEFAULT 0;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "total_units" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "total_picks" INTEGER DEFAULT 0;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "picks_completed" INTEGER DEFAULT 0;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "picks_pending" INTEGER DEFAULT 0;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "pick_percentage" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "planned_start" TIMESTAMP;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "planned_end" TIMESTAMP;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "actual_start" TIMESTAMP;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "actual_end" TIMESTAMP;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "assigned_to" INTEGER;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "assigned_to_name" VARCHAR(100);
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "released_at" TIMESTAMP;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "released_by" INTEGER;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "logistics_waves" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "flyer_sent_at" TIMESTAMP;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "page_visited_at" TIMESTAMPTZ;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "page_visit_count" INTEGER;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "demo_accessed_at" TIMESTAMPTZ;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "survey_sent_at" TIMESTAMPTZ;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "survey_completed_at" TIMESTAMPTZ;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "rating_overall" INTEGER;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "rating_interest" INTEGER;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "contact_preference" VARCHAR(50);
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "funnel_stage" TEXT;
ALTER TABLE "marketing_lead_analytics" ADD COLUMN IF NOT EXISTS "total_events" BIGINT;
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "lead_id" UUID;
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "comm_type" VARCHAR(30);
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(255);
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "flyer_type" VARCHAR(50);
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'sent';
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "sent_by_staff_id" UUID;
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "sent_by_staff_name" VARCHAR(255);
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMP DEFAULT now();
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMP;
ALTER TABLE "marketing_lead_communications" ADD COLUMN IF NOT EXISTS "opened_at" TIMESTAMP;
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "lead_id" UUID;
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "event_data" JSONB;
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "marketing_lead_events" ADD COLUMN IF NOT EXISTS "referrer" TEXT;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "lead_id" UUID;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "survey_token" UUID DEFAULT gen_random_uuid();
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "rating_overall" INTEGER;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "rating_design" INTEGER;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "rating_clarity" INTEGER;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "rating_interest" INTEGER;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "contact_preference" VARCHAR(50);
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "feedback_text" TEXT;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "marketing_lead_surveys" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "language" VARCHAR(10) DEFAULT 'es';
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "industry" VARCHAR(100);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "whatsapp" VARCHAR(50);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50) DEFAULT 'manual';
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "created_by_staff_id" UUID;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "created_by_staff_name" VARCHAR(255);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'new';
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "flyer_sent_at" TIMESTAMP;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "flyer_sent_via" VARCHAR(20);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "flyer_opened_at" TIMESTAMP;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "last_contact_at" TIMESTAMP;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "next_followup_at" TIMESTAMP;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "tracking_token" UUID DEFAULT gen_random_uuid();
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "page_visited_at" TIMESTAMPTZ;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "page_visit_count" INTEGER DEFAULT 0;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "demo_accessed_at" TIMESTAMPTZ;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "survey_sent_at" TIMESTAMPTZ;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "survey_completed_at" TIMESTAMPTZ;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "assigned_seller_id" UUID;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "follow_up_date" DATE;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "follow_up_notes" TEXT;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "campaign_source" VARCHAR(100);
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "converted_to_quote_id" INTEGER;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "converted_at" TIMESTAMP;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "interaction_count" INTEGER DEFAULT 0;
ALTER TABLE "marketing_leads" ADD COLUMN IF NOT EXISTS "last_interaction_at" TIMESTAMP;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "total_leads" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "new_leads" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "contacted" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "interested" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "converted" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "flyers_sent" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "sent_by_email" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "sent_by_whatsapp" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "leads_last_7_days" BIGINT;
ALTER TABLE "marketing_stats" ADD COLUMN IF NOT EXISTS "leads_last_30_days" BIGINT;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "subtypes" JSONB;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "requires_hse_review" BOOLEAN DEFAULT false;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "requires_cie10" BOOLEAN DEFAULT true;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "requires_body_location" BOOLEAN DEFAULT false;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "requires_violation_check" BOOLEAN DEFAULT false;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "legal_framework" TEXT;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "medical_absence_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "certificate_number" VARCHAR(100);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "issue_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "requested_days" INTEGER;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "diagnosis_code" VARCHAR(50);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "diagnosis" VARCHAR(500);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "symptoms" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "has_visited_doctor" BOOLEAN DEFAULT true;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medical_center" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "attending_physician" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medical_prescription" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "questionnaire" JSONB;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "auditor_id" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "auditor_response" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "final_diagnosis" VARCHAR(500);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "diagnosis_category" VARCHAR(100);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "doctor_observations" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medical_recommendations" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "follow_up_required" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "follow_up_date" DATE;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "treating_physician" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "treating_physician_license" VARCHAR(100);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medical_institution" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "notify_art" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "art_notified" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "art_notification_date" TIMESTAMPTZ;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "approved_days" INTEGER;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "needs_audit" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "is_justified" BOOLEAN DEFAULT true;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "audit_date" TIMESTAMPTZ;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "last_modified_by" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "userId" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "certificateNumber" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "issueDate" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "startDate" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "endDate" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "requestedDays" INTEGER;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "diagnosisCode" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "hasVisitedDoctor" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medicalCenter" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "attendingPhysician" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medicalPrescription" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "auditorId" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "auditorResponse" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "finalDiagnosis" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "diagnosisCategory" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "doctorObservations" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medicalRecommendations" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "followUpRequired" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "followUpDate" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "treatingPhysician" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "treatingPhysicianLicense" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "medicalInstitution" VARCHAR(255);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "notifyART" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "artNotified" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "artNotificationDate" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "approvedDays" INTEGER;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "needsAudit" BOOLEAN DEFAULT true;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "isJustified" BOOLEAN;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "auditDate" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "createdBy" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "lastModifiedBy" UUID;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMP;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "absence_type" VARCHAR(50);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "absence_subtype" VARCHAR(50);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "cie10_code" VARCHAR(10);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "body_location" VARCHAR(100);
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "possible_safety_violations" TEXT[];
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "safety_violation_notes" TEXT;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "requires_hse_review" BOOLEAN DEFAULT false;
ALTER TABLE "medical_certificates" ADD COLUMN IF NOT EXISTS "hse_case_id" UUID;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "absence_case_id" UUID;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "sender_type" VARCHAR(20);
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "sender_id" UUID;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "receiver_type" VARCHAR(20);
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "receiver_id" UUID;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "message_type" VARCHAR(50);
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(255);
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN DEFAULT false;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMP;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "requires_response" BOOLEAN DEFAULT false;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "response_deadline" TIMESTAMP;
ALTER TABLE "medical_communications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "code" VARCHAR(255);
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "category" VARCHAR(255);
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "subcategory" VARCHAR(255);
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "typicalDaysOff" INTEGER;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "minDaysOff" INTEGER;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "maxDaysOff" INTEGER;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "requiresAudit" BOOLEAN DEFAULT true;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "requiresCertificate" BOOLEAN DEFAULT true;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "isWorkRelated" BOOLEAN DEFAULT false;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "createdBy" UUID;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "lastModifiedBy" UUID;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "medical_diagnoses" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "record_id" INTEGER;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "record_type" VARCHAR(50);
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "requested_by" UUID;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "request_reason" TEXT;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(20);
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "proposed_changes" JSONB;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorized_by" UUID;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorized_at" TIMESTAMPTZ;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorization_response" TEXT;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "current_step" INTEGER DEFAULT 1;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "escalated_at" TIMESTAMPTZ;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "escalation_reason" VARCHAR(255);
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorization_window_start" TIMESTAMPTZ;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "authorization_window_end" TIMESTAMPTZ;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "window_used" BOOLEAN DEFAULT false;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "window_used_at" TIMESTAMPTZ;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "window_action_performed" VARCHAR(50);
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "notification_group_id" VARCHAR(100);
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "audit_trail" JSONB DEFAULT '[]';
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_edit_authorizations" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMPTZ;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(100);
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "template_code" VARCHAR(20);
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "exam_type" VARCHAR(50);
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "required_studies" JSONB DEFAULT '[]';
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "required_documents" JSONB DEFAULT '[]';
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "validity_days" INTEGER DEFAULT 365;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "reminder_days_before" INTEGER DEFAULT 30;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_exam_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "leave_type" VARCHAR(50) DEFAULT 'sick';
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "diagnosis" TEXT;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "doctor_name" VARCHAR(200);
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "medical_institution" VARCHAR(200);
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "certificate_number" VARCHAR(100);
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "has_certificate" BOOLEAN DEFAULT false;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "certificate_url" TEXT;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "medical_leaves" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "record_id" INTEGER;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "record_type" VARCHAR(50);
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(30);
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "action_by" UUID;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "action_by_name" VARCHAR(255);
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "action_by_role" VARCHAR(50);
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "action_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "old_values" JSONB;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "new_values" JSONB;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "session_id" VARCHAR(100);
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "authorization_id" INTEGER;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "medical_record_audit_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "record_type" VARCHAR(50);
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "exam_date" DATE;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "result" VARCHAR(50);
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "result_details" TEXT;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "observations" TEXT;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "restrictions" JSONB DEFAULT '[]';
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "completed_studies" JSONB DEFAULT '[]';
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "submitted_documents" JSONB DEFAULT '[]';
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "digital_signature" VARCHAR(64);
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "signature_timestamp" TIMESTAMPTZ;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "signature_data" JSONB;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "signed_by" UUID;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "editable_until" TIMESTAMPTZ;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "is_locked" BOOLEAN DEFAULT false;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "locked_at" TIMESTAMPTZ;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "locked_by" UUID;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "locked_reason" VARCHAR(255) DEFAULT 'Ventana de edicion expirada';
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "edit_count" INTEGER DEFAULT 0;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "last_edited_by" UUID;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "last_edited_at" TIMESTAMPTZ;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "is_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMPTZ;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "deleted_by" UUID;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "deletion_reason" TEXT;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "deletion_authorized_by" UUID;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "deletion_authorization_id" INTEGER;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "medical_records" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "license_number" VARCHAR(50);
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "specialty" VARCHAR(100);
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "sub_specialty" VARCHAR(100);
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "password_hash" TEXT;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "can_access_web" BOOLEAN DEFAULT true;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "can_access_app" BOOLEAN DEFAULT true;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "notification_preferences" JSONB DEFAULT '{"sms": false, "push": true, "email": true}';
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "medical_staff" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "type" TEXT DEFAULT 'notification';
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "priority" TEXT DEFAULT 'normal';
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "isRead" BOOLEAN DEFAULT false;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "readAt" TIMESTAMPTZ;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "requiresBiometricConfirmation" BOOLEAN DEFAULT false;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "biometricConfirmedAt" TIMESTAMPTZ;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "expiresAt" TIMESTAMPTZ;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "attachments" JSON DEFAULT '[]';
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "metadata" JSON DEFAULT '{}';
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "recipientId" UUID;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "senderId" UUID;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "relatedEntity" VARCHAR(255);
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "relatedEntityId" UUID;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "messages" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "migration_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "migration_log" ADD COLUMN IF NOT EXISTS "migration_name" VARCHAR(200);
ALTER TABLE "migration_log" ADD COLUMN IF NOT EXISTS "executed_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "migration_log" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "id" VARCHAR(100);
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(50);
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "action_name" VARCHAR(50);
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "display_name" VARCHAR(100);
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "module_actions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(200);
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "available_actions" TEXT[] DEFAULT ARRAY['read';
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "available_scopes" TEXT[] DEFAULT ARRAY['all';
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "required_dependencies" TEXT[] DEFAULT '{}';
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "help_title" VARCHAR(200);
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "help_description" TEXT;
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "help_getting_started" TEXT;
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "help_common_tasks" JSONB DEFAULT '[]';
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "prerequisite_data" JSONB DEFAULT '{}';
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "is_premium" BOOLEAN DEFAULT false;
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "module_definitions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "quote_id" INTEGER;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(200);
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "module_price" NUMERIC(10,2);
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "start_date" TIMESTAMP;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "end_date" TIMESTAMP;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "days_duration" INTEGER DEFAULT 30;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "converted_at" TIMESTAMP;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "cancelled_at" TIMESTAMP;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "first_billing_month" DATE;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "proportional_days" INTEGER;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "total_days_month" INTEGER;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "proportional_percentage" NUMERIC(5,2);
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "proportional_amount" NUMERIC(10,2);
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "full_month_amount" NUMERIC(10,2);
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "decision_date" TIMESTAMPTZ;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "decision" VARCHAR(20);
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "decision_notes" TEXT;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "reminder_sent_7days" BOOLEAN DEFAULT false;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "reminder_sent_3days" BOOLEAN DEFAULT false;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "reminder_sent_1day" BOOLEAN DEFAULT false;
ALTER TABLE "module_trials" ADD COLUMN IF NOT EXISTS "final_reminder_sent" BOOLEAN DEFAULT false;
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "clientCode" VARCHAR(100);
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "emergencyContact" VARCHAR(255);
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "preferredChannel" TEXT DEFAULT 'email';
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "priority" TEXT DEFAULT 'secondary';
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "schedule" TEXT;
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "notificationSettings" JSON DEFAULT '{"enableEmergency":true,"enableRoutine":true,"responseTimeout":24,"escalationEnabled":true}';
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "website" VARCHAR(255);
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "multiple_art_configurations" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "notification_id" BIGINT;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "thread_id" UUID;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "action_by" UUID;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "action_by_name" VARCHAR(255);
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "action_by_role" VARCHAR(50);
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "action_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "previous_status" VARCHAR(50);
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "new_status" VARCHAR(50);
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "notification_actions_log" ADD COLUMN IF NOT EXISTS "device_type" VARCHAR(50);
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "question_pattern" TEXT;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "question_keywords" TEXT[];
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "answer_content" TEXT;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "answer_summary" VARCHAR(500);
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "learned_from_thread_id" UUID;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "learned_from_notification_id" UUID;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "answered_by_user_id" UUID;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "answered_by_role" VARCHAR(50);
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "times_suggested" INTEGER DEFAULT 0;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "times_accepted" INTEGER DEFAULT 0;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "times_rejected" INTEGER DEFAULT 0;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(5,4) DEFAULT 0.5;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_ai_learning" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "trigger_message_id" UUID;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "group_id" UUID;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "recipient_id" VARCHAR(100);
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "suggestion_type" VARCHAR(50);
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "suggested_response" TEXT;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "confidence" NUMERIC(5,4);
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(50);
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "source_thread_id" UUID;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "explanation" TEXT;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "user_response" TEXT;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "feedback_rating" INTEGER;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "feedback_comment" TEXT;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "auto_applied" BOOLEAN DEFAULT false;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "applied_at" TIMESTAMP;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "applied_message_id" UUID;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "notification_ai_suggestions" ADD COLUMN IF NOT EXISTS "responded_at" TIMESTAMP;
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "group_id" UUID;
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "message_id" UUID;
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "actor_type" VARCHAR(20);
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "actor_id" VARCHAR(100);
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "notification_audit_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "notification_message_id" UUID;
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "context_type" VARCHAR(50);
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "context_data" JSONB;
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "display_as" VARCHAR(20);
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "display_message" TEXT;
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "notification_context_data" ADD COLUMN IF NOT EXISTS "calculated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_escalations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_escalations" ADD COLUMN IF NOT EXISTS "message_id" UUID;
ALTER TABLE "notification_escalations" ADD COLUMN IF NOT EXISTS "original_deadline" TIMESTAMP;
ALTER TABLE "notification_escalations" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 1;
ALTER TABLE "notification_escalations" ADD COLUMN IF NOT EXISTS "escalated_to" VARCHAR(100);
ALTER TABLE "notification_escalations" ADD COLUMN IF NOT EXISTS "escalated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_escalations" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "pattern_name" VARCHAR(200);
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "pattern_description" TEXT;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "regex_pattern" TEXT;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "keyword_patterns" TEXT[];
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "semantic_pattern" TEXT;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "standard_response" TEXT;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "response_variables" JSONB DEFAULT '{}';
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "auto_respond" BOOLEAN DEFAULT false;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "require_confirmation" BOOLEAN DEFAULT true;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "notify_original_recipient" BOOLEAN DEFAULT true;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "times_matched" INTEGER DEFAULT 0;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "last_matched_at" TIMESTAMP;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_faq_patterns" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "request_type_code" VARCHAR(50);
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "flow_name" VARCHAR(100);
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "flow_steps" JSONB;
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "optional_modules" JSONB;
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "notification_flow_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "group_type" VARCHAR(50);
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "initiator_type" VARCHAR(20);
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "initiator_id" VARCHAR(100);
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(255);
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'open';
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(10) DEFAULT 'normal';
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMP;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "closed_by" VARCHAR(100);
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "requires_sla" BOOLEAN DEFAULT true;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "default_sla_hours" INTEGER DEFAULT 24;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "auto_escalate" BOOLEAN DEFAULT true;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "escalation_chain" JSONB DEFAULT '["supervisor", "rrhh", "gerencia"]';
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "total_escalations" INTEGER DEFAULT 0;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "last_activity_at" TIMESTAMP;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "ai_last_analyzed_at" TIMESTAMP;
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "ai_resolution_status" VARCHAR(50) DEFAULT 'unknown';
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "ai_detected_topic" VARCHAR(100);
ALTER TABLE "notification_groups" ADD COLUMN IF NOT EXISTS "ai_summary" TEXT;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "from_number" VARCHAR(50);
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "to_number" VARCHAR(50);
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "message_body" TEXT;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "media_urls" JSONB DEFAULT '[]';
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "original_notification_id" INTEGER;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "conversation_thread_id" VARCHAR(100);
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "provider_message_id" VARCHAR(100);
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "provider_metadata" JSONB;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "is_processed" BOOLEAN DEFAULT false;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "processed_at" TIMESTAMP;
ALTER TABLE "notification_incoming_messages" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "subcategory" VARCHAR(100);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "department" VARCHAR(100);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "question_pattern" TEXT;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "question_keywords" TEXT[];
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "answer_content" TEXT;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "answer_summary" VARCHAR(500);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "answer_metadata" JSONB DEFAULT '{}';
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "source_message_id" UUID;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "source_group_id" UUID;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "learned_from_employee_id" VARCHAR(100);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "answered_by_employee_id" VARCHAR(100);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "answered_by_role" VARCHAR(50);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "is_temporal" BOOLEAN DEFAULT false;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "times_suggested" INTEGER DEFAULT 0;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "times_accepted" INTEGER DEFAULT 0;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "times_rejected" INTEGER DEFAULT 0;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(5,4) DEFAULT 0.5;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "verified_by" VARCHAR(100);
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_learned_responses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "workflow_id" INTEGER;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "process_key" VARCHAR(100);
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(20);
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "recipient_id" UUID;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "recipient_email" VARCHAR(255);
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "recipient_phone" VARCHAR(20);
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMP;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMP;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "response_at" TIMESTAMP;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "response" TEXT;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "response_metadata" JSONB;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "provider" VARCHAR(50);
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "provider_message_id" VARCHAR(255);
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "notification_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "group_id" UUID;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sequence_number" INTEGER;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sender_type" VARCHAR(20);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sender_id" VARCHAR(100);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sender_name" VARCHAR(255);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(20);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "recipient_id" VARCHAR(100);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(255);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "message_type" VARCHAR(30);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(255);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "content_encrypted" TEXT;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "deadline_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "requires_response" BOOLEAN DEFAULT false;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "responded_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "message_hash" VARCHAR(64);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "hash_algorithm" VARCHAR(20) DEFAULT 'SHA-256';
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "channels" JSONB DEFAULT '["web"]';
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "channel_status" JSONB;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "attachments" JSONB;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "is_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sla_response_hours" INTEGER DEFAULT 24;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sla_breach" BOOLEAN DEFAULT false;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sla_breach_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sender_notified_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "sender_notified_response" BOOLEAN DEFAULT false;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "recipient_notified_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "escalation_status" VARCHAR(20) DEFAULT 'none';
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 0;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "escalated_to_id" VARCHAR(100);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "escalated_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "impact_on_evaluation" BOOLEAN DEFAULT false;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "evaluation_score_impact" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "discharge_reason" TEXT;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "discharge_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "discharge_accepted" BOOLEAN;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "ai_analyzed" BOOLEAN DEFAULT false;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "ai_analyzed_at" TIMESTAMP;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "ai_suggested_response_id" INTEGER;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "ai_auto_generated" BOOLEAN DEFAULT false;
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "ai_confidence" NUMERIC(5,4);
ALTER TABLE "notification_messages" ADD COLUMN IF NOT EXISTS "ai_source_type" VARCHAR(50);
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(30);
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN DEFAULT false;
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "is_decisor" BOOLEAN DEFAULT false;
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "is_informative" BOOLEAN DEFAULT false;
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "can_forward" BOOLEAN DEFAULT false;
ALTER TABLE "notification_participant_types" ADD COLUMN IF NOT EXISTS "creates_deadline" BOOLEAN DEFAULT true;
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "id" VARCHAR(255);
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "company_id" VARCHAR(50);
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "notification_id" VARCHAR(255);
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "channel" TEXT;
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "status" TEXT DEFAULT 'pending';
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "attempts" INTEGER DEFAULT 0;
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "max_attempts" INTEGER DEFAULT 3;
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "scheduled_at" TIMESTAMPTZ;
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "processed_at" TIMESTAMPTZ;
ALTER TABLE "notification_queue" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(50);
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "sla_hours" INTEGER DEFAULT 24;
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "warning_hours" INTEGER DEFAULT 4;
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "escalation_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "escalation_chain" JSONB DEFAULT '["supervisor", "rrhh"]';
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "evaluation_impact" NUMERIC(5,2) DEFAULT '-2.00';
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_sla_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "message_id" UUID;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(100);
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "sla_type" VARCHAR(50);
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "expected_response_at" TIMESTAMP;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "actual_response_at" TIMESTAMP;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "sla_met" BOOLEAN;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "breach_minutes" INTEGER;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "escalation_triggered" BOOLEAN DEFAULT false;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 0;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "evaluation_impact" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "discharge_filed" BOOLEAN DEFAULT false;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "discharge_reason" TEXT;
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "discharge_verdict" VARCHAR(20);
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_sla_records" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "workflow_key" VARCHAR(100);
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "title_template" TEXT;
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "message_template" TEXT;
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "channels" JSONB DEFAULT '["email", "inbox"]';
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "available_variables" JSONB DEFAULT '[]';
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(255);
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "notification_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "group_id" UUID;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "thread_summary" TEXT;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "detected_intent" VARCHAR(100);
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "detected_topic" VARCHAR(100);
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "detected_urgency" VARCHAR(20);
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "detected_sentiment" VARCHAR(20);
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "is_resolved" BOOLEAN DEFAULT false;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "resolution_message_id" UUID;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "resolution_summary" TEXT;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "has_anomalies" BOOLEAN DEFAULT false;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "anomalies" JSONB DEFAULT '[]';
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "pending_suggestions" JSONB DEFAULT '[]';
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "last_analyzed_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "last_message_analyzed_id" UUID;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "analysis_version" INTEGER DEFAULT 1;
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_thread_analysis" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(255);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "thread_type" VARCHAR(50);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "initiator_type" VARCHAR(50);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "initiator_id" VARCHAR(100);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "initiator_name" VARCHAR(255);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "participants" JSONB DEFAULT '[]';
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'open';
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "message_count" INTEGER DEFAULT 0;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "unread_count" INTEGER DEFAULT 0;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "current_workflow_step" INTEGER DEFAULT 0;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "workflow_id" INTEGER;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "sla_deadline" TIMESTAMP;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "sla_breached" BOOLEAN DEFAULT false;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "ai_summary" TEXT;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "ai_topic" VARCHAR(100);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "ai_resolution_status" VARCHAR(50);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "last_message_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMP;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "closed_by" UUID;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "commercial_flow" VARCHAR(50);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "notification_threads" ADD COLUMN IF NOT EXISTS "external_email" VARCHAR(255);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "process_key" VARCHAR(100);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "process_name" VARCHAR(255);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "scope" VARCHAR(20) DEFAULT 'aponnt';
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "workflow_steps" JSONB DEFAULT '{"steps": []}';
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "channels" JSONB DEFAULT '["email"]';
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "primary_channel" VARCHAR(20) DEFAULT 'email';
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "requires_response" BOOLEAN DEFAULT false;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "response_type" VARCHAR(20);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "response_options" JSONB;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "response_timeout_hours" INTEGER DEFAULT 48;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "auto_action_on_timeout" VARCHAR(50);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "sla_delivery_minutes" INTEGER;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "sla_response_hours" INTEGER;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "email_template_key" VARCHAR(100);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "whatsapp_template_key" VARCHAR(100);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "sms_template_key" VARCHAR(100);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "push_template_key" VARCHAR(100);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(20);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "recipient_rules" JSONB;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "email_config_source" VARCHAR(20) DEFAULT 'process_mapping';
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "email_type" VARCHAR(50);
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "notification_workflows" ADD COLUMN IF NOT EXISTS "updated_by" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "uuid" UUID DEFAULT gen_random_uuid();
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50) DEFAULT 'info';
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(100);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "recipient_user_id" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "recipient_role" VARCHAR(50);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "recipient_department_id" INTEGER;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "recipient_shift_id" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "recipient_custom_list" JSONB DEFAULT '[]';
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "is_broadcast" BOOLEAN DEFAULT false;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "short_message" VARCHAR(140);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "email_body" TEXT;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "related_entity_type" VARCHAR(50);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "related_entity_id" BIGINT;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "related_user_id" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "related_department_id" INTEGER;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "related_kiosk_id" INTEGER;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "related_attendance_id" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN DEFAULT false;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "read_by" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN DEFAULT false;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "action_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(50);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "action_deadline" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "action_taken_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "action_taken_by" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "action_response" TEXT;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "action_options" JSONB DEFAULT '[]';
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 0;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "escalated_from_notification_id" BIGINT;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "escalated_to_notification_id" BIGINT;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "escalation_reason" VARCHAR(255);
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "sent_via_app" BOOLEAN DEFAULT true;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "sent_via_email" BOOLEAN DEFAULT false;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "sent_via_whatsapp" BOOLEAN DEFAULT false;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "sent_via_sms" BOOLEAN DEFAULT false;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "email_sent_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "whatsapp_sent_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "sms_sent_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "reminder_sent" BOOLEAN DEFAULT false;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "reminder_sent_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "reminder_count" INTEGER DEFAULT 0;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "notifications" ADD COLUMN IF NOT EXISTS "deleted_by" UUID;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "id" VARCHAR(255);
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "company_id" VARCHAR(50);
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "notification_code" VARCHAR(200);
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "from_module" TEXT;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "from_user_id" VARCHAR(255);
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "to_user_id" VARCHAR(255);
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "to_role" TEXT;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "notification_type" TEXT;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "status" TEXT DEFAULT 'pending';
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "priority" TEXT DEFAULT 'medium';
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "channels" JSON;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "delivery_attempts" INTEGER DEFAULT 0;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "metadata" JSON;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "requires_response" BOOLEAN DEFAULT false;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "response_data" JSON;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "response_at" TIMESTAMPTZ;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMPTZ;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMPTZ;
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "notifications_enterprise" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "alert_days_schedule" TEXT[] DEFAULT '{30,15,7,1}';
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "alerts_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "default_recipients" TEXT[];
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "notify_employee" BOOLEAN DEFAULT true;
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "notify_supervisor" BOOLEAN DEFAULT true;
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "notify_hr" BOOLEAN DEFAULT true;
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "hr_email" VARCHAR(200);
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "send_time" TIME DEFAULT '09:00:00';
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(50) DEFAULT 'America/Buenos_Aires';
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "last_updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_certification_alert_config" ADD COLUMN IF NOT EXISTS "last_updated_by" VARCHAR(100);
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "certification_id" INTEGER;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(50);
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "alert_type" VARCHAR(50);
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "days_until_expiration" INTEGER;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "sent_to" VARCHAR(500);
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "sent_via" VARCHAR(50) DEFAULT 'email';
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'sent';
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "subject" TEXT;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "message_body" TEXT;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "send_response" JSONB;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "oh_certification_alerts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(100);
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "name_i18n" JSONB DEFAULT '{}';
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "description_i18n" JSONB DEFAULT '{}';
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "default_alert_days" INTEGER DEFAULT 30;
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "requires_renewal" BOOLEAN DEFAULT true;
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "standard_validity_months" INTEGER DEFAULT 12;
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_certification_types" ADD COLUMN IF NOT EXISTS "last_updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "claim_id" INTEGER;
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(100);
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(500);
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "file_path" VARCHAR(1000);
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "file_size" INTEGER;
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "file_type" VARCHAR(100);
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "uploaded_by" VARCHAR(200);
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "upload_date" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "is_required" BOOLEAN DEFAULT false;
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "verified_by" VARCHAR(200);
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "verified_date" TIMESTAMPTZ;
ALTER TABLE "oh_claim_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "claim_id" INTEGER;
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "previous_status" VARCHAR(50);
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "new_status" VARCHAR(50);
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "changed_by" VARCHAR(200);
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "change_reason" TEXT;
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "oh_claim_status_history" ADD COLUMN IF NOT EXISTS "changed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "region" VARCHAR(10);
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(50);
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "name_i18n" JSONB;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "description_i18n" JSONB;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "severity_level" VARCHAR(20);
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "requires_medical_report" BOOLEAN DEFAULT true;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "requires_witness_statement" BOOLEAN DEFAULT false;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "requires_employer_report" BOOLEAN DEFAULT true;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "typical_recovery_days" INTEGER;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "legal_deadline_days" INTEGER;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_claim_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(50);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(200);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "employee_email" VARCHAR(200);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "department" VARCHAR(100);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "certification_type_id" INTEGER;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "certification_number" VARCHAR(200);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "alert_days_before" INTEGER DEFAULT 30;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "last_alert_sent_at" TIMESTAMPTZ;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "alert_count" INTEGER DEFAULT 0;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'active';
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "issuing_authority" VARCHAR(200);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "issuing_country" VARCHAR(10);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "document_path" TEXT;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "document_filename" VARCHAR(500);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "document_size" BIGINT;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(100);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "renewed_by_certification_id" INTEGER;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "is_renewal_of_certification_id" INTEGER;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "last_updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "last_updated_by" VARCHAR(100);
ALTER TABLE "oh_employee_certifications" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMPTZ;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_first_name" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_last_name" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_email" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_phone" VARCHAR(50);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_id_number" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_date_of_birth" DATE;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_gender" VARCHAR(20);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "position_title" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "department" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "position_level" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "job_category" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "expected_start_date" DATE;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "screening_type_id" INTEGER;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "screening_type_code" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "scheduled_date" TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "completed_date" TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(2);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "location_address" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "location_city" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "location_state" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "location_postal_code" VARCHAR(20);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "provider_name" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "provider_license_number" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "physician_name" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "physician_license_number" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "overall_result" VARCHAR(50);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "result_summary" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "result_details" JSONB;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "has_restrictions" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "restrictions_description" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "requires_accommodations" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "accommodations_description" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "accommodation_cost_estimate" NUMERIC(10,2);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "requires_follow_up" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "follow_up_date" DATE;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "follow_up_reason" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "follow_up_completed" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "has_documents" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "documents_count" INTEGER DEFAULT 0;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "screening_cost_usd" NUMERIC(10,2);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "paid_by" VARCHAR(50) DEFAULT 'company';
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "payment_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'scheduled';
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "workflow_stage" VARCHAR(100);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "reviewed_by" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "review_notes" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "approved_for_hiring" BOOLEAN;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "approval_date" TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "approved_by" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_notified" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "candidate_notified_at" TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "hr_notified" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "hr_notified_at" TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "consent_signed" BOOLEAN DEFAULT false;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "consent_signed_at" TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "consent_document_url" TEXT;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "hipaa_compliant" BOOLEAN DEFAULT true;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "gdpr_compliant" BOOLEAN DEFAULT true;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "lgpd_compliant" BOOLEAN DEFAULT true;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(255);
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_pre_employment_screenings" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(2);
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "required_screening_types" TEXT[] DEFAULT ARRAY[];
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "default_validity_days" INTEGER DEFAULT 365;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "require_renewal" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "renewal_reminder_days" INTEGER DEFAULT 30;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "requires_hr_approval" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "requires_medical_approval" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "requires_manager_approval" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "auto_approve_pass_results" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "company_pays" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "max_reimbursement_usd" NUMERIC(10,2);
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "preferred_providers" TEXT[];
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "blacklisted_providers" TEXT[];
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "notify_candidate_on_schedule" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "notify_candidate_on_results" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "notify_hr_on_results" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "notification_template_id" INTEGER;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "require_consent_form" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "consent_template_url" TEXT;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "data_retention_days" INTEGER DEFAULT 2555;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "config_data" JSONB DEFAULT '{}';
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(255);
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(255);
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "screening_id" UUID;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(100);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "document_name" VARCHAR(255);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(255);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "file_path" TEXT;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "file_size_bytes" BIGINT;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "document_date" DATE;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "issued_by" VARCHAR(255);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "language" VARCHAR(10);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "is_confidential" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "requires_physician_review" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "viewed_by" TEXT[];
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "view_count" INTEGER DEFAULT 0;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "verified_by" VARCHAR(255);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'active';
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "uploaded_by" VARCHAR(255);
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "uploaded_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_documents" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "screening_id" UUID;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "test_category" VARCHAR(100);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "test_name" VARCHAR(255);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "test_code" VARCHAR(100);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "result_value" VARCHAR(500);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "result_unit" VARCHAR(50);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "result_status" VARCHAR(50);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "reference_range" VARCHAR(255);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "interpretation" TEXT;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "is_within_normal" BOOLEAN;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "requires_attention" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "clinical_significance" VARCHAR(100);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "result_data" JSONB;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "tested_at" TIMESTAMP;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "reported_at" TIMESTAMP;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "reviewed_by" VARCHAR(255);
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_results" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(100);
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "name_i18n" JSONB DEFAULT '{}';
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "description_i18n" JSONB DEFAULT '{}';
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "country_codes" TEXT[] DEFAULT ARRAY['*';
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "region" VARCHAR(50);
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "required_for_roles" TEXT[];
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "requires_physician" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "requires_lab" BOOLEAN DEFAULT false;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "validity_days" INTEGER;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "renewal_reminder_days" INTEGER DEFAULT 30;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "result_types" JSONB DEFAULT '["pass", "fail", "conditional"]';
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "pass_criteria" JSONB;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "estimated_cost_usd" NUMERIC(10,2);
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "estimated_duration_minutes" INTEGER;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(255);
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(255);
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "oh_screening_types" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(50);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "claim_number" VARCHAR(100);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "incident_date" DATE;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "incident_time" TIME;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "incident_location" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "department" VARCHAR(100);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "supervisor_name" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "claim_type_id" INTEGER;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(10);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "injury_description" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "body_part_affected" VARCHAR(100);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "injury_cause" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "witnesses" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'reported';
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "medical_treatment_required" BOOLEAN DEFAULT false;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "medical_facility_name" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "treating_physician" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "first_aid_provided" BOOLEAN DEFAULT false;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "first_aid_description" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "hospitalization_required" BOOLEAN DEFAULT false;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "work_days_lost" INTEGER DEFAULT 0;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "estimated_return_date" DATE;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "actual_return_date" DATE;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "art_company_name" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "art_policy_number" VARCHAR(100);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "art_claim_number" VARCHAR(100);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "art_case_manager" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "art_case_manager_phone" VARCHAR(50);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "art_case_manager_email" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "osha_recordable" BOOLEAN DEFAULT false;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "osha_classification" VARCHAR(50);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "reported_to_authority" BOOLEAN DEFAULT false;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "authority_reference_number" VARCHAR(100);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "reported_to_authority_date" DATE;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "estimated_cost_medical" NUMERIC(10,2);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "estimated_cost_compensation" NUMERIC(10,2);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "actual_cost_medical" NUMERIC(10,2);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "actual_cost_compensation" NUMERIC(10,2);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "preventive_measures_taken" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "similar_incidents_count" INTEGER DEFAULT 0;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "case_notes" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "resolution_notes" TEXT;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "closed_date" DATE;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "closed_by" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "documents_count" INTEGER DEFAULT 0;
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "reported_by" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "reported_date" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "last_updated_by" VARCHAR(200);
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "oh_workers_compensation_claims" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMPTZ;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "position_code" VARCHAR(30);
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "position_name" VARCHAR(100);
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "parent_position_id" INTEGER;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "level_order" INTEGER DEFAULT 1;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "salary_category_id" INTEGER;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "payslip_template_id" INTEGER;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "payroll_template_id" INTEGER;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "work_environment" VARCHAR(50) DEFAULT 'oficina';
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "physical_demand_level" INTEGER DEFAULT 1;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "work_category" VARCHAR(50) DEFAULT 'administrativo';
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "cognitive_demand_level" INTEGER DEFAULT 3;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "risk_exposure_level" INTEGER DEFAULT 1;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "international_code_ciuo" VARCHAR(10);
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "international_code_srt" VARCHAR(20);
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "applies_accident_risk" BOOLEAN DEFAULT true;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "applies_fatigue_index" BOOLEAN DEFAULT true;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "custom_risk_weights" JSONB;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "custom_thresholds" JSONB;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "hierarchy_level" INTEGER DEFAULT 99;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "branch_code" VARCHAR(50);
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "branch_order" INTEGER DEFAULT 0;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "full_path" TEXT;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "is_escalation_point" BOOLEAN DEFAULT false;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "can_approve_permissions" BOOLEAN DEFAULT false;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "max_approval_days" INTEGER DEFAULT 0;
ALTER TABLE "organizational_positions" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7) DEFAULT '#3B82F6';
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "partner_id" UUID;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "year" INTEGER;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "month" INTEGER;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "total_cases" INTEGER DEFAULT 0;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "total_billable" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "total_commission" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "total_net" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "pending_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "invoiced_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "paid_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'open';
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "settled_at" TIMESTAMPTZ;
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "partner_commission_summaries" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "partner_id" UUID;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "partner_commission_id" UUID;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(50);
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "reference_id" UUID;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "billable_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "commission_percentage" NUMERIC(5,2);
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "commission_amount" NUMERIC(12,2);
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "net_amount" NUMERIC(12,2);
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "transaction_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "invoiced_at" TIMESTAMPTZ;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "paid_at" TIMESTAMPTZ;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "invoice_number" VARCHAR(50);
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "payment_reference" VARCHAR(100);
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(30);
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "partner_commission_transactions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "partner_id" UUID;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "commission_type" VARCHAR(30) DEFAULT 'percentage';
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "percentage" NUMERIC(5,2) DEFAULT 15.00;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "fixed_amount" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "tiered_config" JSONB;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "effective_from" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "effective_until" DATE;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "partner_commissions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "partner_category" VARCHAR(50);
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "coordinator_user_id" UUID;
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "coordinator_name" VARCHAR(255);
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "coordinator_email" VARCHAR(255);
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "coordinator_phone" VARCHAR(50);
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "can_assign_substitutes" BOOLEAN DEFAULT true;
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "notification_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "partner_coordinators" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "role_name" VARCHAR(100);
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "requires_license" BOOLEAN DEFAULT false;
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "requires_insurance" BOOLEAN DEFAULT false;
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "partner_roles" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "original_partner_id" INTEGER;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "substitute_partner_id" INTEGER;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "partner_category" VARCHAR(50);
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "reason" VARCHAR(500);
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "authorized_by_user_id" UUID;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "authorized_by_coordinator_id" INTEGER;
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'active';
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "partner_substitutions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(20);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(20);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "partner_role_id" UUID;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "approval_status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "username" VARCHAR(50);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "password" VARCHAR(255);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "first_login" BOOLEAN DEFAULT true;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "last_login_at" TIMESTAMP;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "password_changed_at" TIMESTAMP;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "face_image_url" VARCHAR(500);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "face_descriptor" TEXT;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "face_registered_at" TIMESTAMP;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "fingerprint_data" TEXT;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "biometric_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "denial_reason" TEXT;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "approval_notes" TEXT;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "email_verified" BOOLEAN DEFAULT false;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "email_verified_at" TIMESTAMP;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "pending_consents" TEXT[] DEFAULT '{}';
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "verification_pending" BOOLEAN DEFAULT true;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "account_status" TEXT DEFAULT 'pending_verification';
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "specialty" VARCHAR(100);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "license_number" VARCHAR(50);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "is_medical_staff" BOOLEAN DEFAULT false;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "password_hash" VARCHAR(255);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "mobile" VARCHAR(20);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "profile_photo_url" TEXT;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "bio" TEXT;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "languages" JSONB;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "professional_licenses" JSONB;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "education" JSONB;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "certifications" JSONB;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "experience_years" INTEGER;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "specialties" JSONB;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "contract_type" VARCHAR(50) DEFAULT 'per_service';
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "commission_calculation" VARCHAR(50) DEFAULT 'per_module_user';
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "commission_percentage" NUMERIC(5,2);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "fixed_monthly_rate" NUMERIC(10,2);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "fixed_per_employee_rate" NUMERIC(10,2);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "country" VARCHAR(100);
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "service_area" JSONB;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "rating" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "total_reviews" INTEGER DEFAULT 0;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "total_services" INTEGER DEFAULT 0;
ALTER TABLE "partners" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "kiosk_id" INTEGER;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "password_valid" BOOLEAN;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "facial_similarity" NUMERIC(12,2);
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "security_photo" BYTEA;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "success" BOOLEAN;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "requires_hr_review" BOOLEAN DEFAULT false;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP DEFAULT now();
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(255);
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(50);
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "password_auth_attempts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payment_order_credit_notes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payment_order_credit_notes" ADD COLUMN IF NOT EXISTS "payment_order_id" INTEGER;
ALTER TABLE "payment_order_credit_notes" ADD COLUMN IF NOT EXISTS "credit_note_id" INTEGER;
ALTER TABLE "payment_order_credit_notes" ADD COLUMN IF NOT EXISTS "amount_applied" NUMERIC(15,2);
ALTER TABLE "payment_order_credit_notes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "payment_order_id" INTEGER;
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "amount_to_pay" NUMERIC(15,2);
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "retentions" JSONB DEFAULT '[]';
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "total_retentions" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "net_amount" NUMERIC(15,2);
ALTER TABLE "payment_order_invoices" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "payment_order_number" VARCHAR(30);
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "total_invoices" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "total_credit_notes" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "total_retentions" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "net_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(30);
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "bank_account_id" INTEGER;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "reference_number" VARCHAR(50);
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "approved_by" INTEGER;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "paid_by" INTEGER;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "paid_at" TIMESTAMPTZ;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "cancellation_reason" TEXT;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "payment_orders" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "invoice_id" BIGINT;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(12,2);
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'USD';
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50);
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "payment_reference" VARCHAR(255);
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "receipt_file_path" TEXT;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "receipt_file_name" VARCHAR(255);
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "registered_by" UUID;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "registered_at" TIMESTAMPTZ;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "commissions_generated" BOOLEAN DEFAULT false;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "commissions_generated_at" TIMESTAMPTZ;
ALTER TABLE "payments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "classification_code" VARCHAR(30);
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "classification_name" VARCHAR(100);
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "descriptions" JSONB DEFAULT '{}';
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "sign" INTEGER;
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "affects_employee_net" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "affects_employer_cost" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "calculation_order" INTEGER DEFAULT 0;
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_classifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "concept_type_id" INTEGER;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "employee_rate" NUMERIC(8,4) DEFAULT 0;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "employer_rate" NUMERIC(8,4) DEFAULT 0;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "rate_ceiling" NUMERIC(15,2);
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "rate_floor" NUMERIC(15,2);
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "calculation_base" VARCHAR(30) DEFAULT 'GROSS';
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "effective_from" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "effective_to" DATE;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "legal_reference" TEXT;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "legal_url" VARCHAR(500);
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "help_text" TEXT;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_concept_type_rates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(30);
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "type_name" VARCHAR(100);
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "affects_gross" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "affects_net" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_taxable" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_deduction" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_employer_cost" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "classification_id" INTEGER;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_remunerative" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_pre_tax" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_social_security_base" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_proportional_to_time" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "is_one_time" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "default_employee_rate" NUMERIC(8,4) DEFAULT 0;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "default_employer_rate" NUMERIC(8,4) DEFAULT 0;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "rate_ceiling" NUMERIC(15,2);
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "calculation_base_type" VARCHAR(30) DEFAULT 'GROSS';
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "help_tooltip" VARCHAR(200);
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "help_detailed" TEXT;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "legal_reference" TEXT;
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "examples_by_country" JSONB DEFAULT '{}';
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "icon_name" VARCHAR(50);
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7);
ALTER TABLE "payroll_concept_types" ADD COLUMN IF NOT EXISTS "names_by_locale" JSONB DEFAULT '{}';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "country_name" VARCHAR(100);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "currency_code" VARCHAR(3);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "currency_symbol" VARCHAR(10) DEFAULT '$';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "decimal_places" INTEGER DEFAULT 2;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "thousand_separator" VARCHAR(1) DEFAULT '.';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "decimal_separator" VARCHAR(1) DEFAULT ',';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "labor_law_name" VARCHAR(200);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "labor_law_reference" VARCHAR(500);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "collective_agreement_name" VARCHAR(100) DEFAULT 'Convenio Colectivo de Trabajo';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "default_pay_frequency" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "fiscal_year_start_month" INTEGER DEFAULT 1;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "aguinaldo_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "aguinaldo_frequency" VARCHAR(20) DEFAULT 'biannual';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "vacation_calculation_method" VARCHAR(50) DEFAULT 'calendar_days';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "tax_id_name" VARCHAR(50) DEFAULT 'CUIL';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "tax_id_format" VARCHAR(100);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_law_name" VARCHAR(100);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_law_full_name" VARCHAR(255);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_law_url" VARCHAR(500);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_authority_name" VARCHAR(255);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_authority_url" VARCHAR(500);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_authority_email" VARCHAR(255);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "requires_explicit_consent" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "biometric_data_retention_days" INTEGER DEFAULT 90;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "emotional_data_retention_days" INTEGER DEFAULT 30;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "audit_log_retention_years" INTEGER DEFAULT 5;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "allows_automated_decisions" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "requires_dpo" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "min_age_consent" INTEGER DEFAULT 18;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "allows_employer_monitoring" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "requires_works_council_approval" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "data_subject_rights" JSONB DEFAULT '[]';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "legal_bases_allowed" JSONB DEFAULT '[]';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_intro_text" TEXT;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_biometric_text" TEXT;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_emotional_text" TEXT;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_rights_text" TEXT;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_revocation_text" TEXT;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_footer_text" TEXT;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "breach_notification_hours" INTEGER DEFAULT 72;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_expiry_warning_days" INTEGER DEFAULT 30;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "requires_dpia_biometric" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "dpia_template_url" VARCHAR(500);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "max_penalty_description" VARCHAR(500);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "penalty_currency" VARCHAR(10);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "max_penalty_amount" NUMERIC(15,2);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "penalty_percentage_revenue" NUMERIC(5,2);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_config_version" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_config_updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "is_gdpr_equivalent" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "gdpr_adequacy_decision" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_renewal_months" INTEGER DEFAULT 24;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_law_reference" VARCHAR(255);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "privacy_law_version" VARCHAR(50);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "data_protection_authority" VARCHAR(150);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "dpa_contact_url" VARCHAR(255);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "consent_data_sharing_text" TEXT;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "rights_exercise_url" VARCHAR(255);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "rights_response_days" INTEGER DEFAULT 30;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "attendance_data_retention_years" INTEGER DEFAULT 5;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "requires_dpia" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "allows_biometric_for_attendance" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "allows_emotional_analysis" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "penalty_calculation_method" VARCHAR(100);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "allows_international_transfer" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "transfer_mechanisms" JSONB DEFAULT '[]';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "adequate_countries" JSONB DEFAULT '[]';
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "breach_notification_authority" VARCHAR(150);
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "last_privacy_review" TIMESTAMP;
ALTER TABLE "payroll_countries" ADD COLUMN IF NOT EXISTS "next_privacy_review" TIMESTAMP;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "entity_code" VARCHAR(30);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "entity_name" VARCHAR(200);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(30);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "legal_name" VARCHAR(200);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "email" VARCHAR(100);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "website" VARCHAR(200);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "bank_account_number" VARCHAR(50);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "bank_account_type" VARCHAR(30);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "bank_cbu" VARCHAR(30);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "bank_alias" VARCHAR(100);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "presentation_format" VARCHAR(50);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "presentation_frequency" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "presentation_deadline_day" INTEGER;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "settings" JSONB DEFAULT '{}';
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "is_government" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "entity_short_name" VARCHAR(50);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "requires_employee_affiliation" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "affiliation_id_name" VARCHAR(50);
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "calculation_notes" TEXT;
ALTER TABLE "payroll_entities" ADD COLUMN IF NOT EXISTS "legal_reference" TEXT;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(50);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(200);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "category_name_short" VARCHAR(50);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "flow_direction" VARCHAR(30) DEFAULT 'deduction';
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "icon_name" VARCHAR(50);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "consolidation_group" VARCHAR(50);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "requires_tax_id" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "requires_bank_info" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "default_presentation_format" VARCHAR(50);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "presentation_entity_name" VARCHAR(200);
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_entity_categories" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "detail_id" INTEGER;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "settlement_id" INTEGER;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "run_detail_id" INTEGER;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(200);
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "employee_tax_id" VARCHAR(30);
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "employee_code" VARCHAR(50);
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "base_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "employee_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "employer_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "concepts_breakdown" JSONB DEFAULT '[]';
ALTER TABLE "payroll_entity_settlement_details" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "settlement_id" INTEGER;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "period_year" INTEGER;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "period_month" INTEGER;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "run_id" INTEGER;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "settlement_code" VARCHAR(50);
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "total_employees" INTEGER DEFAULT 0;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "total_employer_contribution" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "total_employee_contribution" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "grand_total" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "generated_at" TIMESTAMP;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "submitted_at" TIMESTAMP;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "paid_at" TIMESTAMP;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "generated_by" UUID;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "reviewed_by" UUID;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "payment_reference" VARCHAR(100);
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(30);
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "payment_receipt_url" VARCHAR(500);
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "presentation_file_url" VARCHAR(500);
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "presentation_format" VARCHAR(50);
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "presentation_response" JSONB;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_entity_settlements" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "block_type" VARCHAR(50);
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "block_name" VARCHAR(100);
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "configurable_fields" JSONB DEFAULT '[]';
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "html_template" TEXT;
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "suggested_order" INTEGER DEFAULT 50;
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "required_for_countries" JSONB DEFAULT '[]';
ALTER TABLE "payroll_payslip_block_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "template_code" VARCHAR(30);
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(100);
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "layout_config" JSONB DEFAULT '{"style": {"margins": {"top": 20, "left": 15, "right": 15, "bottom": 20}, "font_size": 10, "paper_size": "A4", "font_family": "Arial", "orientation": "portrait", "primary_color": "#1a1a2e", "secondary_color": "#4a5568"}, "blocks": []}';
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "required_fields" JSONB DEFAULT '[]';
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "legal_disclaimers" JSONB DEFAULT '[]';
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "logo_url" VARCHAR(500);
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "signature_config" JSONB DEFAULT '{"employee_signature": true, "employer_signature": true, "digital_signature_enabled": false}';
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_payslip_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "run_detail_id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "template_concept_id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "concept_type_id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "concept_code" VARCHAR(50);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "concept_name" VARCHAR(200);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(10,4);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "rate" NUMERIC(15,4);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(15,2);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "calculation_detail" TEXT;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "is_override" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "entity_code" VARCHAR(30);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "entity_name" VARCHAR(200);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "concept_detail_id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "detail_id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "concept_id" INTEGER;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "concept_type" VARCHAR(30);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "calculation_type" VARCHAR(20);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "base_amount" NUMERIC(15,2);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "calculated_amount" NUMERIC(15,2);
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "is_remunerative" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "is_taxable" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "is_bonus" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "show_in_payslip" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "calculation_details" JSONB DEFAULT '{}';
ALTER TABLE "payroll_run_concept_details" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "run_id" INTEGER;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "assignment_id" INTEGER;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "worked_days" NUMERIC(5,2);
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "worked_hours" NUMERIC(7,2);
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "overtime_50_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "overtime_100_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "night_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "absent_days" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "gross_earnings" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "non_remunerative" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "total_deductions" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "net_salary" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "employer_contributions" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "earnings_detail" JSONB DEFAULT '[]';
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "deductions_detail" JSONB DEFAULT '[]';
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "employer_detail" JSONB DEFAULT '[]';
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'calculated';
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "receipt_number" VARCHAR(50);
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "receipt_generated_at" TIMESTAMP;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "receipt_url" TEXT;
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "employee_snapshot" JSONB DEFAULT '{}';
ALTER TABLE "payroll_run_details" ADD COLUMN IF NOT EXISTS "payslip_template_snapshot" JSONB DEFAULT '{}';
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "run_code" VARCHAR(50);
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "run_name" VARCHAR(200);
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "period_year" INTEGER;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "period_month" INTEGER;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "period_half" INTEGER;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "period_week" INTEGER;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "total_employees" INTEGER DEFAULT 0;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "total_gross" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "total_deductions" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "total_net" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "total_employer_cost" NUMERIC(18,2) DEFAULT 0;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "paid_at" TIMESTAMP;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_runs" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "concept_type_id" INTEGER;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "concept_code" VARCHAR(50);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "concept_name" VARCHAR(200);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "short_name" VARCHAR(50);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "calculation_type" VARCHAR(30) DEFAULT 'fixed';
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "default_value" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "percentage_base" VARCHAR(100);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "formula" TEXT;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "min_value" NUMERIC(15,4);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "max_value" NUMERIC(15,4);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "cap_value" NUMERIC(15,4);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "applies_to_hourly" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "applies_to_monthly" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "is_visible_receipt" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "is_editable_per_user" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "employee_contribution_rate" NUMERIC(6,4);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "employer_contribution_rate" NUMERIC(6,4);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "legal_reference" TEXT;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "entity_account_code" VARCHAR(50);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "entity_label" VARCHAR(100);
ALTER TABLE "payroll_template_concepts" ADD COLUMN IF NOT EXISTS "receipt_note" TEXT;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "labor_agreement_id" INTEGER;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "template_code" VARCHAR(50);
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(200);
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "pay_frequency" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "calculation_basis" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "work_hours_per_day" NUMERIC(5,2) DEFAULT 8;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "work_days_per_week" NUMERIC(3,1) DEFAULT 5;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "work_hours_per_month" NUMERIC(6,2) DEFAULT 200;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "overtime_50_after_hours" NUMERIC(5,2) DEFAULT 8;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "overtime_100_after_hours" NUMERIC(5,2) DEFAULT 12;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "night_shift_start" TIME DEFAULT '21:00:00';
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "night_shift_end" TIME DEFAULT '06:00:00';
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "round_to_cents" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "round_method" VARCHAR(20) DEFAULT 'nearest';
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "receipt_header" TEXT;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "receipt_legal_text" TEXT;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "receipt_footer" TEXT;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "is_current_version" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "parent_template_id" INTEGER;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "payroll_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "type" TEXT;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "startDate" TIMESTAMPTZ;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "endDate" TIMESTAMPTZ;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "hours" NUMERIC(4,2);
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "status" TEXT DEFAULT 'pending';
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "approvedBy" UUID;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "approvedAt" TIMESTAMPTZ;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "rejectionReason" TEXT;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "documents" JSON DEFAULT '[]';
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "isEmergency" BOOLEAN DEFAULT false;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "notificationSent" BOOLEAN DEFAULT false;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "UserId" UUID;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "permissions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "proactive_executions" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "proactive_executions" ADD COLUMN IF NOT EXISTS "rule_id" INTEGER;
ALTER TABLE "proactive_executions" ADD COLUMN IF NOT EXISTS "execution_time" TIMESTAMP DEFAULT now();
ALTER TABLE "proactive_executions" ADD COLUMN IF NOT EXISTS "matched_count" INTEGER DEFAULT 0;
ALTER TABLE "proactive_executions" ADD COLUMN IF NOT EXISTS "actions_taken" INTEGER DEFAULT 0;
ALTER TABLE "proactive_executions" ADD COLUMN IF NOT EXISTS "execution_details" JSONB;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "rule_name" VARCHAR(100);
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "rule_type" VARCHAR(50);
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "trigger_condition" TEXT;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "trigger_threshold" JSONB;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "auto_action" VARCHAR(50);
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "notification_recipients" JSONB;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "notification_template_id" INTEGER;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "check_frequency" VARCHAR(20) DEFAULT 'daily';
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "last_checked" TIMESTAMP;
ALTER TABLE "proactive_rules" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "procedure_id" UUID;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "procedure_version_id" UUID;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(50);
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(255);
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "notification_id" UUID;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMP;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMP;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "acknowledgement_ip" VARCHAR(45);
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "acknowledgement_method" VARCHAR(20);
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "reminder_count" INTEGER DEFAULT 0;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "last_reminder_at" TIMESTAMP;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedure_acknowledgements" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "procedure_id" UUID;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "procedure_version_id" UUID;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(255);
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "file_type" VARCHAR(50);
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "file_size" INTEGER;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "file_path" TEXT;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "is_main_document" BOOLEAN DEFAULT false;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "uploaded_by" UUID;
ALTER TABLE "procedure_attachments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "procedure_id" UUID;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "procedure_version_id" UUID;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "comment_type" VARCHAR(20) DEFAULT 'comment';
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "is_resolved" BOOLEAN DEFAULT false;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "resolved_by" UUID;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMP;
ALTER TABLE "procedure_comments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "procedure_id" UUID;
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "locked_by" UUID;
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "locked_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "unlocked_at" TIMESTAMP;
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "unlock_reason" VARCHAR(50);
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "procedure_draft_locks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedure_roles" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "procedure_roles" ADD COLUMN IF NOT EXISTS "procedure_id" UUID;
ALTER TABLE "procedure_roles" ADD COLUMN IF NOT EXISTS "organizational_position_id" INTEGER;
ALTER TABLE "procedure_roles" ADD COLUMN IF NOT EXISTS "role_name" VARCHAR(100);
ALTER TABLE "procedure_roles" ADD COLUMN IF NOT EXISTS "scope_type" VARCHAR(20) DEFAULT 'must_read';
ALTER TABLE "procedure_roles" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "procedure_id" UUID;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "version_number" INTEGER;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "version_label" VARCHAR(20);
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "objective" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "scope" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "definitions" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "responsibilities" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "procedure_content" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "references" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "annexes" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "changes_summary" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "change_reason" TEXT;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "published_by" UUID;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "published_at" TIMESTAMP;
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'current';
ALTER TABLE "procedure_versions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "type" VARCHAR(20) DEFAULT 'instructivo';
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "current_version" INTEGER DEFAULT 1;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "version_label" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "objective" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "scope" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "definitions" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "responsibilities" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "procedure_content" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "references" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "annexes" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "sector_id" INTEGER;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "effective_date" DATE;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "review_date" DATE;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "obsolete_date" DATE;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "reviewed_by" UUID;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "published_by" UUID;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "published_at" TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "is_critical" BOOLEAN DEFAULT false;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "requires_training" BOOLEAN DEFAULT false;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "training_module_id" UUID;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "owners" JSONB DEFAULT '[]';
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "scope_type" TEXT DEFAULT 'company';
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "scope_entities" JSONB DEFAULT '[]';
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "draft_locked_by" UUID;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "draft_locked_at" TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "draft_expires_at" TIMESTAMP;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "parent_id" UUID;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "hierarchy_level" INTEGER DEFAULT 4;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "hierarchy_path" TEXT;
ALTER TABLE "procedures" ADD COLUMN IF NOT EXISTS "inherit_scope" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "config_name" VARCHAR(100);
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "account_code" VARCHAR(20);
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "account_name" VARCHAR(200);
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "account_type" VARCHAR(50);
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "purchase_type" VARCHAR(50);
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3) DEFAULT 'AR';
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_accounting_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "purchase_type" VARCHAR(50);
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "expense_account_id" INTEGER;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "asset_account_id" INTEGER;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "liability_account_id" INTEGER;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "tax_account_id" INTEGER;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "capitalize_threshold" NUMERIC(15,2) DEFAULT 50000;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_accounting_configs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(50);
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "min_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "approval_level" INTEGER DEFAULT 1;
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "can_approve_roles" JSONB DEFAULT '[]';
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "can_approve_users" JSONB DEFAULT '[]';
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "requires_justification" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "requires_budget_check" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_approval_configs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "level" INTEGER DEFAULT 1;
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_categories" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "order_id" INTEGER;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "invoice_number" VARCHAR(50);
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "invoice_type" VARCHAR(10);
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "invoice_date" DATE;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "other_taxes" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(5) DEFAULT 'ARS';
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "cae" VARCHAR(20);
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "cae_expiry" DATE;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "matching_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "procurement_invoices" ADD COLUMN IF NOT EXISTS "payment_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "item_code" VARCHAR(100);
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "item_type" VARCHAR(50) DEFAULT 'product';
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(50);
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "reference_price" NUMERIC(15,2);
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "min_price" NUMERIC(15,2);
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "max_price" NUMERIC(15,2);
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "supplier_history" JSONB DEFAULT '[]';
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "order_id" INTEGER;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "requisition_item_id" INTEGER;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "item_id" INTEGER;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "item_code" VARCHAR(100);
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,3);
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,2);
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "qty_received" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "qty_accepted" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "qty_rejected" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "procurement_order_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "order_number" VARCHAR(50);
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "order_type" VARCHAR(30) DEFAULT 'standard';
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(5) DEFAULT 'ARS';
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "requested_by" INTEGER;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "approved_by" INTEGER;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "expected_delivery" DATE;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "requisition_id" INTEGER;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "modified_after_approval" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "reauthorization_required" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "modification_reason" TEXT;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "pending_delivery_qty" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "procurement_orders" ADD COLUMN IF NOT EXISTS "delivered_qty" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "payment_number" VARCHAR(50);
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "invoice_ids" JSONB DEFAULT '[]';
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2);
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50);
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "bank_reference" VARCHAR(100);
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "executed_by" UUID;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "executed_at" TIMESTAMP;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "journal_entry_id" INTEGER;
ALTER TABLE "procurement_payments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "order_id" INTEGER;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "item_id" INTEGER;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "purchase_date" DATE;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,3);
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,2);
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2);
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "delivery_days" INTEGER;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(3,2);
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "on_time" BOOLEAN;
ALTER TABLE "procurement_purchase_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "receipt_id" INTEGER;
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "order_item_id" INTEGER;
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "qty_received" NUMERIC(15,3);
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "qty_accepted" NUMERIC(15,3);
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "qty_rejected" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(100);
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "procurement_receipt_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "receipt_number" VARCHAR(50);
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "order_id" INTEGER;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "receipt_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "received_by" UUID;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "delivery_note_number" VARCHAR(100);
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "carrier_name" VARCHAR(200);
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "quality_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "quality_notes" TEXT;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "quality_checked_by" UUID;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "quality_checked_at" TIMESTAMP;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "general_observations" TEXT;
ALTER TABLE "procurement_receipts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "requisition_id" INTEGER;
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "item_id" INTEGER;
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "item_code" VARCHAR(100);
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,3);
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(50);
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "estimated_unit_price" NUMERIC(15,2);
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "estimated_total" NUMERIC(15,2);
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "specifications" TEXT;
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "preferred_supplier_id" INTEGER;
ALTER TABLE "procurement_requisition_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "requisition_number" VARCHAR(50);
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "requester_id" UUID;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "cost_center_id" INTEGER;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'draft';
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "required_date" DATE;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "justification" TEXT;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "estimated_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "current_approval_step" INTEGER DEFAULT 0;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "max_approval_steps" INTEGER DEFAULT 1;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "modified_after_approval" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "reauthorization_required" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "audit_trail" JSONB DEFAULT '[]';
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "requester_name" VARCHAR(200);
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "requester_email" VARCHAR(255);
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "requester_department_id" INTEGER;
ALTER TABLE "procurement_requisitions" ADD COLUMN IF NOT EXISTS "converted_to_order_id" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "rfq_id" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "requisition_item_id" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "line_number" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "item_id" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "item_code" VARCHAR(100);
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "item_description" VARCHAR(500);
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "specifications" TEXT;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(50);
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "reference_price" NUMERIC(15,2);
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "best_quote_price" NUMERIC(15,4);
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "best_quote_supplier_id" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "awarded_supplier_id" INTEGER;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "awarded_price" NUMERIC(15,4);
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "procurement_rfq_items" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "rfq_id" INTEGER;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "quote_date" DATE;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "quoted_total" NUMERIC(15,2);
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "lead_time_days" INTEGER;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "validity_days" INTEGER;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "terms" TEXT;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(5,2);
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "delivery_score" NUMERIC(5,2);
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "price_score" NUMERIC(5,2);
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "total_score" NUMERIC(5,2);
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "price_ranking" INTEGER;
ALTER TABLE "procurement_rfq_quotes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "rfq_id" INTEGER;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "invited_at" TIMESTAMPTZ;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "notification_id" BIGINT;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "viewed_at" TIMESTAMPTZ;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "responded_at" TIMESTAMPTZ;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "decline_reason" TEXT;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "quote_total" NUMERIC(15,2);
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "quote_currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "quote_valid_until" DATE;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "quote_observations" TEXT;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "quote_delivery_days" INTEGER;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "quote_payment_terms" TEXT;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "auto_score" NUMERIC(5,2);
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "is_awarded" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "awarded_items" JSONB DEFAULT '[]';
ALTER TABLE "procurement_rfq_suppliers" ADD COLUMN IF NOT EXISTS "awarded_total" NUMERIC(15,2);
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "rfq_number" VARCHAR(50);
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "requisition_id" INTEGER;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'draft';
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "allow_partial_quotes" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "payment_terms" TEXT;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "delivery_terms" TEXT;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "awarded_at" TIMESTAMP;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "awarded_by" UUID;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "award_reason" TEXT;
ALTER TABLE "procurement_rfqs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "approver_user_id" UUID;
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "budget_limit" NUMERIC(15,2);
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_sectors" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "item_id" INTEGER;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "supplier_item_code" VARCHAR(100);
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "supplier_item_name" VARCHAR(255);
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "last_price" NUMERIC(15,2);
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "last_purchase_date" DATE;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "total_qty_purchased" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "total_amount_purchased" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "avg_delivery_days" INTEGER;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "quality_rating" NUMERIC(3,2);
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "price_history" JSONB DEFAULT '[]';
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "is_preferred" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_supplier_item_mappings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "supplier_code" VARCHAR(50);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "legal_name" VARCHAR(255);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "trade_name" VARCHAR(255);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(50);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(200);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "contact_email" VARCHAR(255);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(50);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "country" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "supplier_type" VARCHAR(50) DEFAULT 'both';
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "onboarding_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "overall_score" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "quality_score" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "delivery_score" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "price_score" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "service_score" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "total_orders" INTEGER DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "on_time_delivery_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "rejection_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "documents" JSONB DEFAULT '[]';
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "bank_accounts" JSONB DEFAULT '[]';
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "default_payment_days" INTEGER DEFAULT 30;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "portal_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "audit_trail" JSONB DEFAULT '[]';
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "procurement_suppliers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "purchase_order_id" INTEGER;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(255);
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "file_path" TEXT;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "file_size" BIGINT;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "attachment_type" VARCHAR(20) DEFAULT 'purchase_order_copy';
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "binding_level" VARCHAR(20) DEFAULT 'orientative';
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "legal_notice" TEXT;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "is_required" BOOLEAN DEFAULT false;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "downloaded_by_supplier" BOOLEAN DEFAULT false;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "downloaded_at" TIMESTAMPTZ;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "dms_document_id" INTEGER;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "uploaded_by" INTEGER;
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "uploaded_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "purchase_order_attachments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "purchase_order_id" INTEGER;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "quotation_item_id" INTEGER;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "item_number" INTEGER;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "quantity_ordered" NUMERIC(12,3);
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "quantity_received" NUMERIC(12,3) DEFAULT 0;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "quantity_pending" NUMERIC(12,3) DEFAULT 0;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "discount_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "tax_rate" NUMERIC(5,2) DEFAULT 21;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "expected_delivery_date" DATE;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "item_type" VARCHAR(20) DEFAULT 'product';
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "accounting_category" VARCHAR(50);
ALTER TABLE "purchase_order_items" ADD COLUMN IF NOT EXISTS "accounting_account_id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "po_number" VARCHAR(30);
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "quotation_id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "requisition_id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "order_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "expected_delivery_date" DATE;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "delivery_address" TEXT;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "discount_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "shipping_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "payment_terms" VARCHAR(200);
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "delivery_terms" VARCHAR(200);
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "approved_by" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMPTZ;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "sent_method" VARCHAR(20);
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "confirmed_by_supplier" BOOLEAN DEFAULT false;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "confirmed_at" TIMESTAMPTZ;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "received_complete" BOOLEAN DEFAULT false;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMPTZ;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "invoiced" BOOLEAN DEFAULT false;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "payment_blocked" BOOLEAN DEFAULT false;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "payment_block_reason" TEXT;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "cancellation_reason" TEXT;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "purchase_orders" ADD COLUMN IF NOT EXISTS "order_type" VARCHAR(20) DEFAULT 'product';
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "requisition_id" INTEGER;
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(12,3);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "estimated_unit_price" NUMERIC(15,4);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "estimated_total" NUMERIC(15,2);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "preferred_supplier_id" INTEGER;
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "specifications" TEXT;
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "current_stock" NUMERIC(12,3);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(12,3);
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "purchase_requisition_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "requisition_number" VARCHAR(30);
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "needed_date" DATE;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "estimated_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "requested_by" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMPTZ;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "approved_by" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "rejected_by" INTEGER;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMPTZ;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "purchase_requisitions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "quote_number" VARCHAR(50);
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "seller_id" UUID;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "lead_id" UUID;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "modules_data" JSONB DEFAULT '[]';
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "trial_modules" JSONB;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "has_trial" BOOLEAN DEFAULT false;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "trial_start_date" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "trial_end_date" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "trial_bonification_percentage" NUMERIC(5,2) DEFAULT 100.00;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "previous_quote_id" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "replaces_quote_id" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "replaced_by_quote_id" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "is_upgrade" BOOLEAN DEFAULT false;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "is_downgrade" BOOLEAN DEFAULT false;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "is_modification" BOOLEAN DEFAULT false;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "added_modules" JSONB;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "removed_modules" JSONB;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "sent_date" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "accepted_date" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "rejected_date" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "expiration_date" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "valid_until" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "client_notes" TEXT;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "terms_and_conditions" TEXT;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "pdf_file_path" VARCHAR(500);
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "status_history" JSONB DEFAULT '[]';
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "contract_status" VARCHAR(20) DEFAULT 'none';
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "contract_sent_at" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "contract_signed_at" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "contract_signer_name" VARCHAR(255);
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "contract_signer_dni" VARCHAR(20);
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "contract_signature_ip" VARCHAR(45);
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "contract_acceptance_data" JSONB;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "sales_lead_id" UUID;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "origin_detail" JSONB;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "seller_assigned_at" TIMESTAMP;
ALTER TABLE "quotes" ADD COLUMN IF NOT EXISTS "origin_type" VARCHAR(30) DEFAULT 'manual';
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "attendance_id" INTEGER;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "detection_timestamp" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "shift_start_time" TIME;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "shift_end_time" TIME;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "break_periods" JSONB;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "presence_detected" BOOLEAN;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "detection_method" VARCHAR(50) DEFAULT 'azure_face_api';
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "azure_face_id" VARCHAR(100);
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "azure_confidence_score" NUMERIC(5,4);
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "azure_response_time_ms" INTEGER;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "azure_api_version" VARCHAR(20);
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "capture_type" VARCHAR(50) DEFAULT 'random';
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "is_during_break_period" BOOLEAN DEFAULT false;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "image_hash" VARCHAR(64);
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "image_stored" BOOLEAN DEFAULT false;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "image_storage_path" VARCHAR(500);
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "image_retention_until" TIMESTAMP;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "image_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "image_deleted_at" TIMESTAMP;
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,8);
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(11,8);
ALTER TABLE "remote_presence_detections" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "attendance_id" INTEGER;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "absence_start_timestamp" TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "absence_end_timestamp" TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "absence_duration_minutes" INTEGER;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "first_failed_detection_id" INTEGER;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "last_failed_detection_id" INTEGER;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "total_failed_attempts" INTEGER DEFAULT 1;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'open';
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "justified_by" UUID;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "justification_reason" TEXT;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "justification_date" TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "supervisor_notified" BOOLEAN DEFAULT false;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "supervisor_notified_at" TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "hr_notified" BOOLEAN DEFAULT false;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "hr_notified_at" TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "action_taken" VARCHAR(50);
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "action_taken_by" UUID;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "action_taken_at" TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "action_notes" TEXT;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "remote_presence_violations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "receipt_id" INTEGER;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "claim_item_id" INTEGER;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "quantity_expected" NUMERIC(12,3);
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "quantity_received" NUMERIC(12,3);
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "batch_number" VARCHAR(50);
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "quality_status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "replacement_receipt_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "receipt_number" VARCHAR(30);
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "claim_id" INTEGER;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "receipt_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "delivery_note_number" VARCHAR(50);
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "received_by" INTEGER;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "verified_by" INTEGER;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "replacement_receipts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "report_id" INTEGER;
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "access_type" VARCHAR(30);
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "accessed_at" TIMESTAMP DEFAULT now();
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "accessed_by" VARCHAR(100);
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "success" BOOLEAN DEFAULT true;
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "report_access_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "rfq_number" VARCHAR(30);
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "requisition_id" INTEGER;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "rfq_type" VARCHAR(20) DEFAULT 'standard';
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "quotation_deadline" TIMESTAMPTZ;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "delivery_deadline" DATE;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "delivery_address" TEXT;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "payment_terms_required" VARCHAR(100);
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "warranty_required" VARCHAR(100);
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "evaluation_criteria" JSONB DEFAULT '{"price": 60, "quality": 20, "delivery": 20}';
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "allow_partial_quotation" BOOLEAN DEFAULT true;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "allow_alternatives" BOOLEAN DEFAULT false;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "requires_samples" BOOLEAN DEFAULT false;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "min_suppliers_required" INTEGER DEFAULT 1;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "published_at" TIMESTAMPTZ;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "published_by" INTEGER;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "awarded_at" TIMESTAMPTZ;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "awarded_by" INTEGER;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "cancellation_reason" TEXT;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "request_for_quotations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(30);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "display_name_es" VARCHAR(255);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "display_name_en" VARCHAR(255);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "display_name_pt" VARCHAR(255);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "legal_term" VARCHAR(100);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "approval_chain" JSONB;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "form_fields" JSONB;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "validation_rules" JSONB;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "email_subject_template" VARCHAR(255);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "email_body_template" TEXT;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "requires_attachments" BOOLEAN DEFAULT false;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "allowed_file_types" VARCHAR(255);
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50) DEFAULT 'üìã';
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7) DEFAULT '#007bff';
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "active" BOOLEAN DEFAULT true;
ALTER TABLE "request_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "basket_min_support" NUMERIC(6,4) DEFAULT 0.01;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "basket_min_confidence" NUMERIC(6,4) DEFAULT 0.3;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "basket_max_items" INTEGER DEFAULT 5;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "forecast_default_algorithm" VARCHAR(30) DEFAULT 'simple_exponential';
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "forecast_horizon_days" INTEGER DEFAULT 7;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "forecast_confidence_level" NUMERIC(5,4) DEFAULT 0.95;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "rfm_recency_days" INTEGER DEFAULT 365;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "rfm_custom_thresholds" JSONB DEFAULT '{}';
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "abc_a_threshold" NUMERIC(5,4) DEFAULT 0.80;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "abc_b_threshold" NUMERIC(5,4) DEFAULT 0.95;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "xyz_x_threshold" NUMERIC(6,4) DEFAULT 0.20;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "xyz_y_threshold" NUMERIC(6,4) DEFAULT 0.50;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "reorder_auto_suggest" BOOLEAN DEFAULT true;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "reorder_lead_time_buffer" INTEGER DEFAULT 2;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "sync_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "sync_frequency_hours" INTEGER DEFAULT 24;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "last_sync" TIMESTAMPTZ;
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "settings" JSONB DEFAULT '{}';
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_analytics_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "antecedent_items" JSONB;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "consequent_items" JSONB;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "antecedent_products" TEXT[];
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "consequent_products" TEXT[];
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "support" NUMERIC(8,6);
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "confidence" NUMERIC(8,6);
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "lift" NUMERIC(10,4);
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "leverage" NUMERIC(10,6);
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "conviction" NUMERIC(10,4);
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "transaction_count" INTEGER;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "algorithm" VARCHAR(30) DEFAULT 'fp_growth';
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "calculation_date" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "valid_to" DATE;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "retail_association_rules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "request_id" INTEGER;
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "quantity_requested" NUMERIC(12,3);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "quantity_approved" NUMERIC(12,3);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "estimated_unit_cost" NUMERIC(15,4);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "current_stock" NUMERIC(12,3);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "min_stock" NUMERIC(12,3);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(12,3);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "avg_daily_sales" NUMERIC(12,4);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "days_of_supply" NUMERIC(10,2);
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "preferred_supplier_id" INTEGER;
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "retail_branch_request_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "request_number" VARCHAR(30);
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "request_type" VARCHAR(20) DEFAULT 'regular';
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "request_date" DATE;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "needed_date" DATE;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "estimated_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "submitted_at" TIMESTAMPTZ;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "submitted_by" INTEGER;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "approved_by" INTEGER;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMPTZ;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "consolidated_order_id" INTEGER;
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_branch_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "consolidated_order_id" INTEGER;
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(12,3);
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "distribution_plan" JSONB DEFAULT '{}';
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "source_request_items" JSONB DEFAULT '[]';
ALTER TABLE "retail_consolidated_order_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "cedi_location_id" INTEGER;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "consolidation_number" VARCHAR(30);
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "supplier_name" VARCHAR(200);
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "consolidation_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "total_locations" INTEGER DEFAULT 0;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "purchase_order_id" INTEGER;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_consolidated_orders" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "rfm_recency_days" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "rfm_frequency" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "rfm_monetary" NUMERIC(15,2);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "rfm_r_score" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "rfm_f_score" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "rfm_m_score" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "rfm_segment" VARCHAR(30);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "clv_predicted" NUMERIC(15,2);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "clv_confidence" NUMERIC(5,4);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "first_purchase_date" DATE;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "last_purchase_date" DATE;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "total_orders" INTEGER DEFAULT 0;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "total_spent" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "avg_order_value" NUMERIC(15,2);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "avg_days_between_orders" NUMERIC(10,2);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "preferred_payment_method" VARCHAR(30);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "preferred_day_of_week" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "preferred_hour" INTEGER;
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "top_categories" JSONB DEFAULT '[]';
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "top_products" JSONB DEFAULT '[]';
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "churn_probability" NUMERIC(5,4);
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "last_calculated" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_customer_metrics" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "segment_code" VARCHAR(30);
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "segment_name" VARCHAR(100);
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "segment_type" VARCHAR(20) DEFAULT 'rfm';
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "definition_rules" JSONB;
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "characteristics" TEXT[];
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "recommended_actions" TEXT[];
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "color_code" VARCHAR(10);
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "priority_order" INTEGER;
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_customer_segments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "forecast_date" DATE;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "forecast_horizon_days" INTEGER DEFAULT 7;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "predicted_quantity" NUMERIC(12,3);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "predicted_revenue" NUMERIC(15,2);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "confidence_lower" NUMERIC(12,3);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "confidence_upper" NUMERIC(12,3);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "confidence_level" NUMERIC(5,4) DEFAULT 0.95;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "algorithm" VARCHAR(50);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "algorithm_params" JSONB DEFAULT '{}';
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "model_accuracy" NUMERIC(8,6);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "mae" NUMERIC(12,4);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "rmse" NUMERIC(12,4);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "mape" NUMERIC(8,4);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "seasonality_applied" BOOLEAN DEFAULT false;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "seasonality_factor" NUMERIC(6,4);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "trend_component" NUMERIC(12,4);
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "factors_considered" JSONB DEFAULT '{}';
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "calculation_date" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "retail_demand_forecasts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "distribution_order_id" INTEGER;
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "quantity_planned" NUMERIC(12,3);
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "quantity_shipped" NUMERIC(12,3);
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "quantity_received" NUMERIC(12,3);
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "batch_number" VARCHAR(50);
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "retail_distribution_order_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "consolidated_order_id" INTEGER;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "from_location_id" INTEGER;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "to_location_id" INTEGER;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "distribution_number" VARCHAR(30);
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "distribution_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "scheduled_delivery_date" DATE;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(15,3) DEFAULT 0;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "total_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "shipped_at" TIMESTAMPTZ;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMPTZ;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "received_by" VARCHAR(100);
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_distribution_orders" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(30);
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "type_name" VARCHAR(100);
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "can_be_cedi" BOOLEAN DEFAULT false;
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "can_request_products" BOOLEAN DEFAULT true;
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "can_receive_distributions" BOOLEAN DEFAULT true;
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "retail_location_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "location_code" VARCHAR(30);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "location_name" VARCHAR(200);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "location_type_id" INTEGER;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "parent_location_id" INTEGER;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "assigned_cedi_id" INTEGER;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "primary_warehouse_id" INTEGER;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "country" VARCHAR(50);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,7);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(10,7);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(100);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(30);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "contact_email" VARCHAR(100);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "procurement_mode" VARCHAR(20) DEFAULT 'centralized';
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "min_order_amount" NUMERIC(15,2);
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "delivery_schedule" JSONB DEFAULT '{}';
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "auto_request_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "auto_request_threshold_days" INTEGER DEFAULT 5;
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_locations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "location_code" VARCHAR(30);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "location_name" VARCHAR(200);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "location_type" VARCHAR(30);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "current_stock" NUMERIC(12,2);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(12,3);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(12,3);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(12,3);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "avg_daily_sales" NUMERIC(12,4);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "days_of_supply" NUMERIC(12,2);
ALTER TABLE "retail_network_stock" ADD COLUMN IF NOT EXISTS "stock_status" TEXT;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "supplier_name" VARCHAR(200);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "current_stock" NUMERIC(12,3);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(12,3);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(12,3);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(12,3);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "suggested_quantity" NUMERIC(12,3);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "min_order_quantity" NUMERIC(12,3);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "order_multiple" NUMERIC(12,3);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "estimated_unit_cost" NUMERIC(15,4);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "estimated_total" NUMERIC(15,2);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "days_of_supply" NUMERIC(10,2);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "avg_daily_sales" NUMERIC(12,4);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "lead_time_days" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "expected_stockout_date" DATE;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "urgency_level" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "algorithm_used" VARCHAR(50);
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "algorithm_info" JSONB DEFAULT '{}';
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "reviewed_by" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMPTZ;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "order_created" BOOLEAN DEFAULT false;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "order_id" INTEGER;
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_reorder_suggestions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "pattern_type" VARCHAR(30);
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "pattern_period" VARCHAR(20);
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "pattern_data" JSONB;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "strength" NUMERIC(6,4);
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "peak_periods" JSONB;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "low_periods" JSONB;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "calculation_date" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "data_start_date" DATE;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "data_end_date" DATE;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "retail_seasonality_patterns" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "stockout_start" TIMESTAMPTZ;
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "stockout_end" TIMESTAMPTZ;
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "duration_hours" NUMERIC(10,2);
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "estimated_lost_sales" NUMERIC(15,2);
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "estimated_lost_units" NUMERIC(12,3);
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "detection_method" VARCHAR(30);
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "root_cause" VARCHAR(50);
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "retail_stockout_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "transaction_id" BIGINT;
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(12,3);
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "discount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "retail_transaction_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "transaction_date" DATE;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "transaction_time" TIME;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(20) DEFAULT 'siac';
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "source_id" VARCHAR(50);
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "pos_id" VARCHAR(20);
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "customer_type" VARCHAR(20);
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "discount_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "tax_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(30);
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "day_of_week" INTEGER;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "hour_of_day" INTEGER;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "is_weekend" BOOLEAN DEFAULT false;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "is_holiday" BOOLEAN DEFAULT false;
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "retail_transactions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "rfq_id" BIGINT;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(255);
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "file_path" TEXT;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "file_size" BIGINT;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "dms_document_id" INTEGER;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "uploaded_by" INTEGER;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "uploaded_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "attachment_type" VARCHAR(20) DEFAULT 'informative';
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "is_response_to_requirement" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_attachments" ADD COLUMN IF NOT EXISTS "company_attachment_id" BIGINT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "rfq_id" BIGINT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(255);
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "file_path" TEXT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "file_size" BIGINT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "attachment_type" VARCHAR(20) DEFAULT 'informative';
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "binding_level" VARCHAR(20) DEFAULT 'orientative';
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "legal_notice" TEXT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "contract_clause" TEXT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "deviation_allowed" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "deviation_tolerance" VARCHAR(100);
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "non_compliance_action" VARCHAR(20) DEFAULT 'payment_rejection';
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "non_compliance_notice" TEXT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "is_required" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "downloaded_by_supplier" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "downloaded_at" TIMESTAMPTZ;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "supplier_acknowledged" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMPTZ;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "dms_document_id" INTEGER;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "uploaded_by" INTEGER;
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "uploaded_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_company_attachments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "rfq_id" INTEGER;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "invitation_sent_at" TIMESTAMPTZ;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "invitation_method" VARCHAR(20) DEFAULT 'email';
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "email_sent_to" VARCHAR(255);
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "viewed_at" TIMESTAMPTZ;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "responded" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "response_date" TIMESTAMPTZ;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "declined" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "decline_reason" TEXT;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "quotation_id" INTEGER;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "reminder_sent_at" TIMESTAMPTZ;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "reminder_count" INTEGER DEFAULT 0;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "rfq_invitations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "rfq_id" INTEGER;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "requisition_item_id" INTEGER;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "item_number" INTEGER;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "specifications" TEXT;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(12,3);
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "target_price" NUMERIC(15,4);
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "show_target_price" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "allow_alternatives" BOOLEAN DEFAULT false;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "required" BOOLEAN DEFAULT true;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "item_type" VARCHAR(20) DEFAULT 'product';
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "accounting_category" VARCHAR(50);
ALTER TABLE "rfq_items" ADD COLUMN IF NOT EXISTS "accounting_account_id" INTEGER;
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "benchmark_code" VARCHAR(50);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "benchmark_name" VARCHAR(200);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "ciuo_code" VARCHAR(10);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "work_category" VARCHAR(50);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "industry_code" VARCHAR(20);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3) DEFAULT 'ARG';
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "source" VARCHAR(100);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "source_year" INTEGER;
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "source_url" TEXT;
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "fatigue_p25" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "fatigue_p50" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "fatigue_p75" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "fatigue_p90" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "accident_p25" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "accident_p50" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "accident_p75" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "accident_p90" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "legal_claim_p25" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "legal_claim_p50" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "legal_claim_p75" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "legal_claim_p90" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "turnover_p25" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "turnover_p50" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "turnover_p75" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "turnover_p90" NUMERIC(5,2);
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "recommended_weights" JSONB DEFAULT '{"legal": 0.20, "fatigue": 0.25, "accident": 0.25, "turnover": 0.15, "performance": 0.15}';
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "risk_benchmarks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "role_key" VARCHAR(50);
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "role_name" VARCHAR(100);
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50) DEFAULT 'internal';
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "module_permissions" JSONB DEFAULT '{}';
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "special_permissions" JSONB DEFAULT '{}';
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "is_system_role" BOOLEAN DEFAULT false;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "is_default_for_new_users" BOOLEAN DEFAULT false;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 0;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "color" VARCHAR(20) DEFAULT '#6c757d';
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50) DEFAULT 'fa-user';
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "inherits_from" INTEGER;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "max_users_per_company" INTEGER;
ALTER TABLE "role_definitions" ADD COLUMN IF NOT EXISTS "requires_position_category" TEXT[];
ALTER TABLE "role_template_permissions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "role_template_permissions" ADD COLUMN IF NOT EXISTS "role_template_id" VARCHAR(50);
ALTER TABLE "role_template_permissions" ADD COLUMN IF NOT EXISTS "action_id" VARCHAR(100);
ALTER TABLE "role_template_permissions" ADD COLUMN IF NOT EXISTS "has_access" BOOLEAN DEFAULT false;
ALTER TABLE "role_template_permissions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "role_template_permissions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "labor_agreement_id" INTEGER;
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(20);
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(200);
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "base_salary_reference" NUMERIC(12,2);
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "effective_date" DATE;
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "salary_categories" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "labor_agreement_id" INTEGER;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(50);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(200);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "base_salary_min" NUMERIC(15,2);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "base_salary_max" NUMERIC(15,2);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "hourly_rate_min" NUMERIC(10,4);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "hourly_rate_max" NUMERIC(10,4);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "recommended_base_salary" NUMERIC(15,2);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "recommended_hourly_rate" NUMERIC(10,4);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "seniority_level" INTEGER DEFAULT 1;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "effective_from" DATE;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "effective_to" DATE;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "agreement_id" INTEGER;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "base_salary" NUMERIC(15,2);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "hourly_rate" NUMERIC(10,2);
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "level" INTEGER DEFAULT 1;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "requires_degree" BOOLEAN DEFAULT false;
ALTER TABLE "salary_categories_v2" ADD COLUMN IF NOT EXISTS "min_experience_years" INTEGER DEFAULT 0;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "lead_id" UUID;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "activity_type" TEXT;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "activity_description" VARCHAR(500);
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "score_change" INTEGER;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "score_before" INTEGER;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "score_after" INTEGER;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "related_email_id" VARCHAR(255);
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "related_meeting_id" UUID;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "related_url" VARCHAR(500);
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_lead_activities" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_industry" TEXT DEFAULT 'otro';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_size" VARCHAR(50);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_employee_count" INTEGER;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_country" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_province" VARCHAR(100);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_city" VARCHAR(100);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_website" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "company_linkedin" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_email" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(50);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_whatsapp" VARCHAR(50);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_job_title" VARCHAR(150);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_department" VARCHAR(100);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_is_decision_maker" BOOLEAN DEFAULT false;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contact_linkedin" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "additional_contacts" JSONB DEFAULT '[]';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "lead_source" TEXT DEFAULT 'other';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "lead_source_detail" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "utm_source" VARCHAR(100);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "utm_medium" VARCHAR(100);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "utm_campaign" VARCHAR(100);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "referrer_url" VARCHAR(500);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "landing_page" VARCHAR(500);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "assigned_vendor_id" UUID;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "previous_vendor_id" UUID;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "lifecycle_stage" TEXT DEFAULT 'lead';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "lifecycle_changed_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "lifecycle_history" JSONB DEFAULT '[]';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "temperature" TEXT DEFAULT 'cold';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "temperature_changed_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "total_score" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "bant_budget" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "bant_authority" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "bant_need" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "bant_timeline" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "bant_notes" JSONB DEFAULT '{}';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "bant_last_updated" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "behavioral_score" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "emails_sent" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "emails_opened" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "emails_clicked" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "website_visits" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "last_website_visit" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "meetings_scheduled" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "meetings_attended" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "meetings_no_show" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "interested_modules" JSONB DEFAULT '[]';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "primary_interest" VARCHAR(100);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "expected_decision_date" DATE;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "budget_available_date" DATE;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "contract_end_current_vendor" DATE;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "current_vendor" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "competitors_evaluating" JSONB DEFAULT '[]';
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "is_disqualified" BOOLEAN DEFAULT false;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "disqualification_reason" TEXT;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "disqualification_notes" TEXT;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "disqualified_at" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "disqualified_by" UUID;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "can_reactivate" BOOLEAN DEFAULT true;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "reactivate_after" DATE;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "converted_to_opportunity_at" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "opportunity_id" UUID;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "converted_to_customer_at" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "customer_company_id" INTEGER;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "first_activity_at" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "last_activity_at" TIMESTAMPTZ;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "days_since_last_activity" INTEGER DEFAULT 0;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "next_action" VARCHAR(255);
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "next_action_date" DATE;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "sales_leads" ADD COLUMN IF NOT EXISTS "converted_company_id" INTEGER;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "meeting_id" UUID;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "whatsapp" VARCHAR(50);
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "job_title" VARCHAR(150);
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "department" VARCHAR(100);
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "is_decision_maker" BOOLEAN DEFAULT false;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "preferred_focus" TEXT DEFAULT 'mixed';
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "wants_reminder" BOOLEAN DEFAULT true;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "survey_token" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "survey_sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "survey_opened_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "survey_completed_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "personal_pitch_data" JSONB;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "satisfaction_sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "satisfaction_completed_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "satisfaction_rating" INTEGER;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "satisfaction_feedback" TEXT;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "vendor_rating" INTEGER;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "has_questions" BOOLEAN DEFAULT false;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "needs_followup" BOOLEAN DEFAULT false;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "followup_notes" TEXT;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_meeting_attendees" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "meeting_id" UUID;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "attendee_id" UUID;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "comm_type" VARCHAR(50);
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(500);
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "body" TEXT;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "template_used" VARCHAR(100);
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "opened_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "clicked_at" TIMESTAMPTZ;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "bounced" BOOLEAN DEFAULT false;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "bounce_reason" VARCHAR(255);
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "external_id" VARCHAR(255);
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "sales_meeting_communications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "meeting_id" UUID;
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "attendee_id" UUID;
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(255);
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "interest_level" TEXT DEFAULT 'none';
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "priority_order" INTEGER;
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "include_in_pitch" BOOLEAN DEFAULT true;
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "pitch_depth" VARCHAR(20) DEFAULT 'standard';
ALTER TABLE "sales_meeting_module_interests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_company_name" VARCHAR(255);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_company_type" TEXT DEFAULT 'otro';
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_country" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_province" VARCHAR(100);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_city" VARCHAR(100);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_employee_count" INTEGER;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_phone" VARCHAR(50);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_email" VARCHAR(255);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_website" VARCHAR(255);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "prospect_notes" TEXT;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_date" DATE;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_time" TIME;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_timezone" VARCHAR(50) DEFAULT 'America/Argentina/Buenos_Aires';
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_duration_minutes" INTEGER DEFAULT 60;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_location" VARCHAR(255);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_platform" VARCHAR(100);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_link" VARCHAR(500);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "assigned_vendor_id" UUID;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "created_by_id" UUID;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "status" TEXT DEFAULT 'draft';
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "send_reminder_24h" BOOLEAN DEFAULT true;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "reminder_sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "survey_token" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "survey_sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "survey_deadline" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "pitch_generated_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "pitch_data" JSONB;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "vendor_pitch_data" JSONB;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_started_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_ended_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "welcome_message_sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "feedback_submitted_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "feedback_data" JSONB;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "follow_up_required" BOOLEAN DEFAULT false;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "follow_up_type" VARCHAR(50);
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "quote_requested" BOOLEAN DEFAULT false;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "quote_modules" JSONB;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "satisfaction_sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "satisfaction_data" JSONB;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "resulting_company_id" INTEGER;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "resulting_budget_id" INTEGER;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "cancellation_reason" TEXT;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "cancelled_by" UUID;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "cancelled_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "deleted_by" UUID;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "pitch_approved_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "pitch_approved_by" UUID;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "pitch_rejected_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "pitch_rejected_feedback" TEXT;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "pitch_sent_at" TIMESTAMPTZ;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "rescheduled_at" TIMESTAMP;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "rescheduled_by" TEXT;
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "meeting_type" VARCHAR(20) DEFAULT 'virtual';
ALTER TABLE "sales_meetings" ADD COLUMN IF NOT EXISTS "demo_sent_at" TIMESTAMP;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "short_description" VARCHAR(100);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "sales_pitch" TEXT;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "key_benefits" JSONB;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "color" VARCHAR(20);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "screenshot_url" VARCHAR(500);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "demo_video_url" VARCHAR(500);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "target_audience" JSONB;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "industry_relevance" JSONB;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "company_size_min" INTEGER;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "company_size_max" INTEGER;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "base_price" NUMERIC(10,2);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "price_per_user" NUMERIC(10,2);
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "is_addon" BOOLEAN DEFAULT false;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "requires_modules" JSONB;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 100;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_module_descriptions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "template_key" VARCHAR(100);
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(255);
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "template_type" VARCHAR(50);
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "html_template" TEXT;
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "css_styles" TEXT;
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "target_focus" TEXT;
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sales_pitch_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "sanction_id" INTEGER;
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "actor_id" UUID;
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "actor_name" VARCHAR(255);
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "actor_role" VARCHAR(50);
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "previous_status" VARCHAR(50);
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "new_status" VARCHAR(50);
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "sanction_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50) DEFAULT 'other';
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "default_severity" VARCHAR(50) DEFAULT 'warning';
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "default_points_deducted" INTEGER DEFAULT 0;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "requires_legal_review" BOOLEAN DEFAULT true;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "suspension_days_default" INTEGER DEFAULT 0;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN DEFAULT false;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "sanction_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(50);
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(255);
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "employee_department" VARCHAR(255);
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "sanction_type" VARCHAR(100);
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(50) DEFAULT 'low';
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "sanction_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'active';
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "points_deducted" INTEGER DEFAULT 0;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "is_automatic" BOOLEAN DEFAULT false;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "related_attendance_id" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "related_incident_id" INTEGER;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "approval_date" TIMESTAMPTZ;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "appeal_notes" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "appeal_date" TIMESTAMPTZ;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "appeal_resolved_by" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "appeal_resolution" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "documents" JSONB DEFAULT '[]';
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "workflow_status" VARCHAR(50) DEFAULT 'draft';
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "sanction_type_id" INTEGER;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "requester_id" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "requester_role" VARCHAR(50);
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "original_description" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "lawyer_id" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "lawyer_review_date" TIMESTAMP;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "lawyer_notes" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "lawyer_modified_description" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "hr_confirmation_id" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "hr_confirmation_date" TIMESTAMP;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "hr_notes" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "delivery_method" VARCHAR(50) DEFAULT 'system';
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "suspension_start_date" DATE;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "suspension_days" INTEGER DEFAULT 0;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "suspension_end_date" DATE;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "rejected_by" UUID;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMP;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "appeal_status" VARCHAR(50);
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "appeal_resolved_at" TIMESTAMP;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "appeal_resolution_notes" TEXT;
ALTER TABLE "sanctions" ADD COLUMN IF NOT EXISTS "workflow_metadata" JSONB DEFAULT '{}';
ALTER TABLE "schema_migrations" ADD COLUMN IF NOT EXISTS "version" VARCHAR(255);
ALTER TABLE "schema_migrations" ADD COLUMN IF NOT EXISTS "name" VARCHAR(500);
ALTER TABLE "schema_migrations" ADD COLUMN IF NOT EXISTS "executed_at" TIMESTAMP DEFAULT now();
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "snapshot_date" DATE;
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "scoring_total" NUMERIC(5,2);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "scoring_punctuality" NUMERIC(5,2);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "scoring_absence" NUMERIC(5,2);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "scoring_late_arrival" NUMERIC(5,2);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "scoring_early_departure" NUMERIC(5,2);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "change_from_previous" NUMERIC(6,2);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "change_reason" VARCHAR(255);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "trend" VARCHAR(20);
ALTER TABLE "scoring_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "gps_lat" NUMERIC(10,8);
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "gps_lng" NUMERIC(11,8);
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "coverage_radius" INTEGER DEFAULT 50;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "max_employees" INTEGER;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "sectors" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "name" VARCHAR(255);
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "startTime" TIME;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "endTime" TIME;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "toleranceMinutes" INTEGER DEFAULT 10;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "days" JSON;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "toleranceMinutesEntry" INTEGER DEFAULT 10;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "toleranceMinutesExit" INTEGER DEFAULT 15;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "shiftType" TEXT DEFAULT 'standard';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "breakStartTime" TIME;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "breakEndTime" TIME;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "rotationPattern" VARCHAR(255);
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "cycleStartDate" DATE;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "workDays" INTEGER;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "restDays" INTEGER;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "flashStartDate" DATE;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "flashEndDate" DATE;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "flashPriority" TEXT DEFAULT 'normal';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "allowOverride" BOOLEAN DEFAULT false;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "permanentPriority" TEXT DEFAULT 'normal';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "hourlyRates" JSON DEFAULT '{"normal":1,"overtime":1.5,"weekend":1.5,"holiday":2}';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7) DEFAULT '#007bff';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "toleranceConfig" JSONB DEFAULT '{"exit": {"after": 30, "before": 0}, "entry": {"after": 10, "before": 15}}';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "global_cycle_start_date" DATE;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "phases" JSONB DEFAULT '[]';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "branch_id" UUID;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "respect_national_holidays" BOOLEAN DEFAULT false;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "respect_provincial_holidays" BOOLEAN DEFAULT false;
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "custom_non_working_days" JSONB DEFAULT '[]';
ALTER TABLE "shifts" ADD COLUMN IF NOT EXISTS "work_modality" VARCHAR(20) DEFAULT 'presencial';
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "tipo_documento" VARCHAR(30);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "documento_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "documento_numero" VARCHAR(30);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "documento_fecha" DATE;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "documento_monto" NUMERIC(15,2);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "cliente_nombre" VARCHAR(200);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "fecha_anulacion" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "motivo_anulacion" TEXT;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "tipo_anulacion" VARCHAR(30) DEFAULT 'TOTAL';
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "monto_anulado" NUMERIC(15,2);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "usuario_solicitante_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "usuario_solicitante_nombre" VARCHAR(200);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "usuario_autorizante_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "usuario_autorizante_nombre" VARCHAR(200);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "requirio_autorizacion" BOOLEAN DEFAULT false;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "autorizado" BOOLEAN DEFAULT true;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "fecha_autorizacion" TIMESTAMP;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "documento_reverso_tipo" VARCHAR(30);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "documento_reverso_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "documento_reverso_numero" VARCHAR(30);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "afecto_caja" BOOLEAN DEFAULT false;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "movimiento_caja_original_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "movimiento_caja_reverso_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "monto_caja_reversado" NUMERIC(15,2);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "afecto_cuenta_corriente" BOOLEAN DEFAULT false;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "movimiento_cta_cte_original_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "movimiento_cta_cte_reverso_id" INTEGER;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "saldo_cliente_anterior" NUMERIC(15,2);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "saldo_cliente_posterior" NUMERIC(15,2);
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "cheques_afectados" JSONB;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "cantidad_cheques_devueltos" INTEGER DEFAULT 0;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "monto_cheques_devueltos" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "facturas_afectadas" JSONB;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'COMPLETADA';
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "error_mensaje" TEXT;
ALTER TABLE "siac_anulaciones_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "sesion_caja_id" INTEGER;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_20000" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_10000" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_5000" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_2000" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_1000" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_500" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_200" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_100" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_50" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_20" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "billetes_10" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "monedas_total" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "total_efectivo_ars" NUMERIC(15,2);
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "dolares_100" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "dolares_50" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "dolares_20" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "dolares_10" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "dolares_5" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "dolares_1" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "dolares_otros" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "total_efectivo_usd" NUMERIC(15,2);
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "cantidad_cheques" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "total_cheques" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "detalle_cheques" JSONB;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "cantidad_vouchers_debito" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "total_vouchers_debito" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "cantidad_vouchers_credito" INTEGER DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "total_vouchers_credito" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "total_arqueo" NUMERIC(15,2);
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "usuario_arqueo_id" INTEGER;
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "fecha_arqueo" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_caja_arqueo" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "sesion_caja_id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "fecha" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "tipo" VARCHAR(20);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "categoria" VARCHAR(50);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "medio_pago" VARCHAR(30);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "monto" NUMERIC(15,2);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "moneda" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "cotizacion" NUMERIC(15,4) DEFAULT 1;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "monto_moneda_local" NUMERIC(15,2);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "proveedor_id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "recibo_id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "cheque_id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "cheque_numero" VARCHAR(20);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "cheque_banco" VARCHAR(100);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "cheque_fecha" DATE;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "tarjeta_tipo" VARCHAR(20);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "tarjeta_ultimos_digitos" VARCHAR(4);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "tarjeta_cuotas" INTEGER DEFAULT 1;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "tarjeta_autorizacion" VARCHAR(20);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "tarjeta_lote" VARCHAR(20);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "transferencia_referencia" VARCHAR(50);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "transferencia_banco" VARCHAR(100);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "transferencia_cbu_origen" VARCHAR(25);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "descripcion" TEXT;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "comprobante_externo" VARCHAR(50);
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "anulado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "anulado_por" INTEGER;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "anulado_at" TIMESTAMP;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "motivo_anulacion" TEXT;
ALTER TABLE "siac_caja_movimientos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "punto_venta_id" INTEGER;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "codigo_caja" VARCHAR(10);
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "nombre_caja" VARCHAR(100);
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "descripcion" TEXT;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "tipo_caja" VARCHAR(20) DEFAULT 'GENERAL';
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "permite_efectivo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "permite_tarjetas" BOOLEAN DEFAULT true;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "permite_cheques" BOOLEAN DEFAULT false;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "permite_transferencias" BOOLEAN DEFAULT false;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "permite_cuenta_corriente" BOOLEAN DEFAULT false;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "limite_efectivo" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "limite_descuento_porcentaje" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "requiere_autorizacion_descuento" BOOLEAN DEFAULT false;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "requiere_supervisor_anulacion" BOOLEAN DEFAULT true;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "predeterminada" BOOLEAN DEFAULT false;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "siac_cajas" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "recibo_medio_pago_id" INTEGER;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "cliente_origen_id" INTEGER;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "numero" VARCHAR(20);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "banco" VARCHAR(100);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "sucursal" VARCHAR(50);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "plaza" VARCHAR(100);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "cuit_emisor" VARCHAR(15);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "titular" VARCHAR(100);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "fecha_emision" DATE;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "fecha_cobro" DATE;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "a_la_orden" VARCHAR(100);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "cruzado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "monto" NUMERIC(15,2);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'EN_CARTERA';
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "fecha_deposito" DATE;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "banco_deposito" VARCHAR(100);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "cuenta_deposito" VARCHAR(50);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "fecha_cobro_real" DATE;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "fecha_rechazo" DATE;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "motivo_rechazo" VARCHAR(100);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "gastos_rechazo" NUMERIC(10,2);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "fecha_endoso" DATE;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "endosado_a" VARCHAR(100);
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "proveedor_endoso_id" INTEGER;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_cheques_cartera" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "cheque_id" INTEGER;
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "estado_anterior" VARCHAR(20);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "estado_nuevo" VARCHAR(20);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "fecha_cambio" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "operacion" VARCHAR(30);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "documento_relacionado_tipo" VARCHAR(30);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "documento_relacionado_id" INTEGER;
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "documento_relacionado_numero" VARCHAR(30);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "usuario_nombre" VARCHAR(200);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "monto" NUMERIC(15,2);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "fecha_vencimiento" DATE;
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "banco" VARCHAR(100);
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_cheques_historial" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "codigo_cliente" VARCHAR(20);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "razon_social" VARCHAR(255);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "nombre_fantasia" VARCHAR(255);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "tipo_cliente" VARCHAR(20) DEFAULT 'PERSONA_FISICA';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "documento_tipo" VARCHAR(20) DEFAULT 'CUIT';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "documento_numero" VARCHAR(20);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "documento_formateado" VARCHAR(30);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "telefono" VARCHAR(50);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "celular" VARCHAR(50);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "whatsapp" VARCHAR(50);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "website" VARCHAR(255);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "domicilio_calle" VARCHAR(255);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "domicilio_numero" VARCHAR(20);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "domicilio_piso" VARCHAR(10);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "domicilio_depto" VARCHAR(10);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "domicilio_completo" TEXT;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "ciudad" VARCHAR(100);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "provincia_estado" VARCHAR(100);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "codigo_postal" VARCHAR(20);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "pais" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "latitud" NUMERIC(10,8);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "longitud" NUMERIC(11,8);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "categoria_cliente" VARCHAR(50) DEFAULT 'GENERAL';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "lista_precio" VARCHAR(50) DEFAULT 'GENERAL';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "descuento_maximo" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "limite_credito" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "credito_disponible" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "dias_vencimiento" INTEGER DEFAULT 30;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "vendedor_asignado_id" INTEGER;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "canal_venta" VARCHAR(50) DEFAULT 'DIRECTO';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "origen_cliente" VARCHAR(50) DEFAULT 'MANUAL';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "requiere_orden_compra" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "formato_facturacion" VARCHAR(20) DEFAULT 'A';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "email_facturacion" VARCHAR(255);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "fecha_alta" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "fecha_primera_compra" DATE;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "fecha_ultima_compra" DATE;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "total_compras" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "cantidad_facturas" INTEGER DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "promedio_compra" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "notas_internas" TEXT;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "datos_extra" JSONB DEFAULT '{}';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'ACTIVO';
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "motivo_inactivacion" TEXT;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "provincia" VARCHAR(100);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "localidad" VARCHAR(100);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "calle" VARCHAR(200);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "numero" VARCHAR(20);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "piso" VARCHAR(10);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "departamento" VARCHAR(10);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "condicion_fiscal" VARCHAR(50);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "condicion_fiscal_code" VARCHAR(20);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "cuenta_corriente_habilitada" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "plazo_pago_dias" INTEGER DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "credito_maximo" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "credito_utilizado" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "bloqueo_por_vencimiento" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "bloqueo_por_credito" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "fecha_ultimo_analisis" DATE;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "observaciones_credito" TEXT;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "banco" VARCHAR(100);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "tipo_cuenta" VARCHAR(50);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "numero_cuenta" VARCHAR(50);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(22);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "alias_cbu" VARCHAR(100);
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "descuento_general" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "lista_precios_id" INTEGER;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "vendedor_id" INTEGER;
ALTER TABLE "siac_clientes" ADD COLUMN IF NOT EXISTS "zona_comercial" VARCHAR(100);
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "plazo_maximo_cheques_diferidos" INTEGER;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "interes_mensual_cheques_diferidos" NUMERIC(5,2);
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "tasa_interes_diaria_custom" NUMERIC(8,5);
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "tasa_interes_mensual_custom" NUMERIC(8,4);
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "dias_gracia_custom" INTEGER;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "descuento_pronto_pago" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "dias_pronto_pago" INTEGER DEFAULT 10;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "exento_retencion_iva" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "exento_retencion_ganancias" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "exento_retencion_iibb" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "certificado_exencion_numero" VARCHAR(50);
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "certificado_exencion_vencimiento" DATE;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "jurisdiccion_iibb" VARCHAR(50);
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_clientes_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "nombre" VARCHAR(100);
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "apellido" VARCHAR(100);
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "cargo" VARCHAR(100);
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "departamento" VARCHAR(100);
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "telefono" VARCHAR(50);
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "celular" VARCHAR(50);
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "es_contacto_principal" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "recibe_facturas" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "recibe_cobranzas" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "recibe_marketing" BOOLEAN DEFAULT true;
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_clientes_contactos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "tipo_direccion" VARCHAR(30) DEFAULT 'ADICIONAL';
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "nombre_direccion" VARCHAR(100);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "calle" VARCHAR(255);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "numero" VARCHAR(20);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "piso" VARCHAR(10);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "departamento" VARCHAR(10);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "entre_calles" VARCHAR(255);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "referencias" TEXT;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "ciudad" VARCHAR(100);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "provincia_estado" VARCHAR(100);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "codigo_postal" VARCHAR(20);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "pais" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "latitud" NUMERIC(10,8);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "longitud" NUMERIC(11,8);
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "es_direccion_principal" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "activa_para_facturacion" BOOLEAN DEFAULT true;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "activa_para_entrega" BOOLEAN DEFAULT true;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "horarios_entrega" JSONB DEFAULT '{}';
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_clientes_direcciones" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "producto_id" INTEGER;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "producto_codigo" VARCHAR(50);
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "producto_descripcion" VARCHAR(255);
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "precio_especial" NUMERIC(15,4);
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "moneda" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "tipo_precio" VARCHAR(20) DEFAULT 'FIJO';
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "valor_descuento" NUMERIC(15,4);
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "fecha_desde" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "fecha_hasta" DATE;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "cantidad_minima" INTEGER DEFAULT 1;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "solo_contado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_clientes_precios_especiales" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "fecha" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "hora" TIME DEFAULT CURRENT_TIME;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "tipo_accion" VARCHAR(30);
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "resultado" VARCHAR(30);
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "contacto_nombre" VARCHAR(100);
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "contacto_telefono" VARCHAR(50);
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "promesa_fecha" DATE;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "promesa_monto" NUMERIC(15,2);
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "promesa_cumplida" BOOLEAN;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "proxima_accion_fecha" DATE;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "proxima_accion_tipo" VARCHAR(30);
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "proxima_accion_asignado_id" INTEGER;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "cobrador_id" INTEGER;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_cobranza_seguimiento" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "aplica_intereses_mora" BOOLEAN DEFAULT false;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "tasa_interes_diaria" NUMERIC(8,5) DEFAULT 0.001;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "tasa_interes_mensual" NUMERIC(8,4) DEFAULT 3.00;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "tipo_calculo_interes" VARCHAR(20) DEFAULT 'DIARIO';
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "dias_gracia" INTEGER DEFAULT 0;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "bloqueo_automatico_morosos" BOOLEAN DEFAULT false;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "dias_atraso_bloqueo" INTEGER DEFAULT 90;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "credito_default_nuevos_clientes" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "requiere_aprobacion_credito" BOOLEAN DEFAULT true;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "requiere_autorizacion_anulacion" BOOLEAN DEFAULT false;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "monto_minimo_autorizacion_anulacion" NUMERIC(15,2) DEFAULT 100000;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "plazo_maximo_cheques_diferidos" INTEGER DEFAULT 30;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "plazo_minimo_cheques_diferidos" INTEGER DEFAULT 0;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "interes_mensual_cheques_diferidos" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "aplica_retenciones_automaticas" BOOLEAN DEFAULT true;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "tax_template_id" INTEGER;
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_config_cuenta_corriente" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "razon_social" VARCHAR(255);
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "domicilio" VARCHAR(255);
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "cuit" VARCHAR(15);
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "ingresos_brutos" VARCHAR(20);
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "condicion_iva" VARCHAR(50) DEFAULT 'RESPONSABLE_INSCRIPTO';
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "punto_venta" INTEGER DEFAULT 1;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "agente_retencion_iva" BOOLEAN DEFAULT false;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "agente_percepcion_iva" BOOLEAN DEFAULT false;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "agente_retencion_ib" BOOLEAN DEFAULT false;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "agente_percepcion_ib" BOOLEAN DEFAULT false;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "porc_retencion_iva" NUMERIC(5,2) DEFAULT 10.50;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "porc_percepcion_iva" NUMERIC(5,2) DEFAULT 21.00;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "porc_retencion_ib" NUMERIC(5,2) DEFAULT 3.00;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "porc_percepcion_ib" NUMERIC(5,2) DEFAULT 3.50;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "habilita_facturacion" BOOLEAN DEFAULT true;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "factura_a_numero" INTEGER DEFAULT 1;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "factura_b_numero" INTEGER DEFAULT 1;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "factura_c_numero" INTEGER DEFAULT 1;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "pais" VARCHAR(3) DEFAULT 'ARG';
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "moneda" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_configuracion_empresa" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "terminal_id" VARCHAR(50);
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "nombre_terminal" VARCHAR(100);
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "tipo_terminal" VARCHAR(30) DEFAULT 'CAJA';
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "impresora_principal" VARCHAR(100);
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "impresora_tickets" VARCHAR(100);
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "display_cliente" VARCHAR(100);
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "lector_codigo_barras" VARCHAR(100);
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "modulos_habilitados" JSONB DEFAULT '[]';
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "permisos_especiales" JSONB DEFAULT '{}';
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "punto_venta_asignado" INTEGER;
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "certificado_fiscal" VARCHAR(255);
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "ultimo_uso" TIMESTAMP;
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_configuracion_terminal" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "fecha" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "fecha_vencimiento" DATE;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "tipo" VARCHAR(20);
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "concepto" VARCHAR(50);
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "comprobante_tipo" VARCHAR(20);
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "comprobante_numero" VARCHAR(20);
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "recibo_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "nota_credito_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "nota_debito_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "debe" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "haber" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "saldo" NUMERIC(15,2);
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "saldo_pendiente" NUMERIC(15,2);
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'PENDIENTE';
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "moneda" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "cotizacion" NUMERIC(15,4) DEFAULT 1;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "monto_original" NUMERIC(15,2);
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "saldo_total" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "facturas_pendientes" INTEGER DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "a_vencer" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "vencido_1_30" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "vencido_31_60" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "vencido_61_90" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "vencido_mas_90" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "monto_total_vencido" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "dias_mayor_atraso" INTEGER DEFAULT 0;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "ultimo_debito_fecha" DATE;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "ultimo_debito_monto" NUMERIC(15,2);
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "ultimo_credito_fecha" DATE;
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "ultimo_credito_monto" NUMERIC(15,2);
ALTER TABLE "siac_cuenta_corriente_resumen" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "caja_id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "tipo_comprobante_id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "numero_completo" VARCHAR(50);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "prefijo" VARCHAR(10);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "numero" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "fecha_factura" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "fecha_vencimiento" DATE;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "fecha_entrega" DATE;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_codigo" VARCHAR(50);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_razon_social" VARCHAR(200);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_documento_tipo" VARCHAR(10);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_documento_numero" VARCHAR(20);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_direccion" TEXT;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_telefono" VARCHAR(50);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_email" VARCHAR(100);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_condicion_iva" VARCHAR(50) DEFAULT 'CONSUMIDOR_FINAL';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "descuento_porcentaje" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "descuento_importe" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "total_impuestos" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "total_neto" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "total_factura" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'PENDIENTE';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "factura_original_id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "motivo_anulacion" TEXT;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "autorizada_por" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cae" VARCHAR(50);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cae_vencimiento" DATE;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "codigo_barras" TEXT;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "notas_internas" TEXT;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "presupuesto_id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "company_id" INTEGER DEFAULT 1;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "punto_venta" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "tipo_comprobante_afip" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "numero_comprobante" BIGINT;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "estado_afip" VARCHAR(20) DEFAULT 'PENDIENTE';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "observaciones_afip" TEXT;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_cuit" VARCHAR(13);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "concepto" INTEGER DEFAULT 1;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "moneda" VARCHAR(3) DEFAULT 'PES';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cotizacion" NUMERIC(10,4) DEFAULT 1;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "fecha_servicio_desde" DATE;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "fecha_servicio_hasta" DATE;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "items" JSONB DEFAULT '[]';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "impuestos" JSONB DEFAULT '[]';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "invoice_number" VARCHAR(50);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cliente_condicion_iva_id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "cancela_misma_moneda_ext" BOOLEAN DEFAULT false;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "remito_id" INTEGER;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "estado_pago" VARCHAR(20) DEFAULT 'PENDIENTE';
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "saldo_pendiente" NUMERIC(15,2);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "percepciones_iva" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "percepciones_iibb" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "percepciones_iibb_jurisdiccion" VARCHAR(50);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "impuestos_internos" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "otros_tributos" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "pdf_path" VARCHAR(500);
ALTER TABLE "siac_facturas" ADD COLUMN IF NOT EXISTS "pdf_generado_at" TIMESTAMP;
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "codigo_impuesto" VARCHAR(20);
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "nombre_impuesto" VARCHAR(100);
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "tipo_impuesto" VARCHAR(50) DEFAULT 'IVA';
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "base_imponible" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "alicuota_porcentaje" NUMERIC(8,2) DEFAULT 0;
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "importe_impuesto" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "condicion_impuesto" VARCHAR(50);
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "codigo_afip" INTEGER;
ALTER TABLE "siac_facturas_impuestos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "numero_item" INTEGER;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "producto_id" INTEGER;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "producto_codigo" VARCHAR(50);
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "producto_descripcion" TEXT;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "producto_unidad_medida" VARCHAR(20) DEFAULT 'UNI';
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "cantidad" NUMERIC(10,3) DEFAULT 1;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "precio_unitario" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "descuento_porcentaje" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "descuento_importe" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "subtotal_con_descuento" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "alicuota_iva" NUMERIC(5,2) DEFAULT 21.00;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "importe_iva" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "otros_impuestos" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "total_item" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "categoria_producto" VARCHAR(100);
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "marca_producto" VARCHAR(100);
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "codigo_barras" VARCHAR(50);
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "notas" TEXT;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas_items" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "forma_pago" VARCHAR(50);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "descripcion_pago" VARCHAR(200);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "importe_pago" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "numero_tarjeta" VARCHAR(20);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "tipo_tarjeta" VARCHAR(50);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "numero_cupon" VARCHAR(50);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "numero_lote" VARCHAR(20);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "codigo_autorizacion" VARCHAR(50);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "numero_cheque" VARCHAR(50);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "banco_cheque" VARCHAR(100);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "fecha_cheque" DATE;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "fecha_vencimiento_cheque" DATE;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "numero_operacion" VARCHAR(50);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "banco_origen" VARCHAR(100);
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "genera_cuenta_corriente" BOOLEAN DEFAULT false;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "estado_pago" VARCHAR(20) DEFAULT 'CONFIRMADO';
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "fecha_pago" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas_pagos" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_facturas_tributos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_facturas_tributos" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_facturas_tributos" ADD COLUMN IF NOT EXISTS "tributo_id" INTEGER;
ALTER TABLE "siac_facturas_tributos" ADD COLUMN IF NOT EXISTS "descripcion" VARCHAR(100);
ALTER TABLE "siac_facturas_tributos" ADD COLUMN IF NOT EXISTS "base_imponible" NUMERIC(15,2);
ALTER TABLE "siac_facturas_tributos" ADD COLUMN IF NOT EXISTS "alicuota" NUMERIC(5,2);
ALTER TABLE "siac_facturas_tributos" ADD COLUMN IF NOT EXISTS "importe" NUMERIC(15,2);
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "codigo_lista" VARCHAR(20);
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "nombre_lista" VARCHAR(100);
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "descripcion" TEXT;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "tipo_lista" VARCHAR(20) DEFAULT 'GENERAL';
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "factor_multiplicador" NUMERIC(8,4) DEFAULT 1.0000;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "redondeo" VARCHAR(20) DEFAULT 'CENTAVO';
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "fecha_vigencia_desde" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "fecha_vigencia_hasta" DATE;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "aplica_automaticamente" BOOLEAN DEFAULT false;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_listas_precios" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "codigo" VARCHAR(30);
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "nombre" VARCHAR(100);
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "tipo" VARCHAR(30);
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "aplica_descuento" BOOLEAN DEFAULT false;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "porcentaje_descuento" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "aplica_recargo" BOOLEAN DEFAULT false;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "porcentaje_recargo" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "dias_descuento_pronto_pago" INTEGER;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "porcentaje_pronto_pago" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "plazo_maximo_dias" INTEGER DEFAULT 180;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "plazo_minimo_dias" INTEGER DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "aplica_retencion_iva" BOOLEAN DEFAULT false;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "porcentaje_retencion_iva" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "aplica_retencion_ganancias" BOOLEAN DEFAULT false;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "porcentaje_retencion_ganancias" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "aplica_retencion_iibb" BOOLEAN DEFAULT false;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "porcentaje_retencion_iibb" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "requiere_autorizacion" BOOLEAN DEFAULT false;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "monto_minimo_autorizacion" NUMERIC(15,2) DEFAULT 100000;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "monto_minimo" NUMERIC(15,2);
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "monto_maximo" NUMERIC(15,2);
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "afecta_caja" BOOLEAN DEFAULT true;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "orden_mostrar" INTEGER DEFAULT 0;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "siac_medios_pago" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "modulo_codigo" VARCHAR(50);
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "modulo_nombre" VARCHAR(100);
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "modulo_descripcion" TEXT;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "fecha_contratacion" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "fecha_vencimiento" DATE;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "configuracion" JSONB DEFAULT '{}';
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "precio_mensual" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_modulos_empresa" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "caja_id" INTEGER;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "tipo_comprobante_id" INTEGER;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "numero_actual" INTEGER DEFAULT 0;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "prefijo" VARCHAR(10) DEFAULT '';
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "sufijo" VARCHAR(10) DEFAULT '';
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "numero_desde" INTEGER DEFAULT 1;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "numero_hasta" INTEGER DEFAULT 999999999;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "fecha_autorizacion" DATE;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "fecha_vencimiento_autorizacion" DATE;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "requiere_cae" BOOLEAN DEFAULT false;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_numeracion_comprobantes" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "tipo_comprobante" VARCHAR(50);
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "numero_asignado" INTEGER;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "numero_anterior" INTEGER;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "session_id" VARCHAR(100);
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "terminal_id" VARCHAR(50);
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "timestamp_asignacion" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "siac_numeracion_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "numero_presupuesto" VARCHAR(50);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "prefijo" VARCHAR(10);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "numero" INTEGER;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_codigo" VARCHAR(50);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_razon_social" VARCHAR(200);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_documento_tipo" VARCHAR(10);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_documento_numero" VARCHAR(20);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_direccion" TEXT;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_telefono" VARCHAR(50);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_email" VARCHAR(100);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cliente_condicion_iva" VARCHAR(50) DEFAULT 'CONSUMIDOR_FINAL';
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "fecha_emision" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "fecha_validez" DATE;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "tipo_facturacion" VARCHAR(20) DEFAULT 'OCASIONAL';
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "frecuencia_facturacion" VARCHAR(20);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "fecha_inicio_facturacion" DATE;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "fecha_fin_facturacion" DATE;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "proximo_periodo_facturacion" DATE;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "items" JSONB DEFAULT '[]';
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "descuento_porcentaje" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "descuento_importe" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "total_impuestos" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "total_neto" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "total_presupuesto" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'PENDIENTE';
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "fecha_aprobacion" TIMESTAMP;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "aprobado_por" VARCHAR(255);
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "cantidad_facturas_generadas" INTEGER DEFAULT 0;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "facturas_generadas" JSONB DEFAULT '[]';
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "contract_id" UUID;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "notas_internas" TEXT;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "terminos_condiciones" TEXT;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "siac_presupuestos" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "codigo_producto" VARCHAR(50);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "codigo_barras" VARCHAR(50);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "codigo_fabricante" VARCHAR(50);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "codigo_proveedor" VARCHAR(50);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "nombre_producto" VARCHAR(255);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "descripcion_corta" VARCHAR(500);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "descripcion_larga" TEXT;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "categoria_id" INTEGER;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "marca_id" INTEGER;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "proveedor_principal_id" INTEGER;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "unidad_medida" VARCHAR(20) DEFAULT 'UNIDAD';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "unidad_compra" VARCHAR(20) DEFAULT 'UNIDAD';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "factor_conversion" NUMERIC(10,4) DEFAULT 1;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "precio_compra" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "precio_venta" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "precio_lista" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "moneda" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "margen_porcentaje" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "margen_absoluto" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "precio_minimo" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "precio_sugerido" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "controla_stock" BOOLEAN DEFAULT true;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "stock_actual" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "stock_minimo" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "stock_maximo" NUMERIC(15,4) DEFAULT 1000;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "punto_reposicion" NUMERIC(15,4) DEFAULT 10;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "peso" NUMERIC(10,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "volumen" NUMERIC(10,4) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "dimensiones" JSONB DEFAULT '{}';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "aplica_iva" BOOLEAN DEFAULT true;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "alicuota_iva" NUMERIC(5,2) DEFAULT 21.00;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "aplica_impuesto_interno" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "alicuota_impuesto_interno" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "permite_fraccionamiento" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "requiere_lote" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "requiere_vencimiento" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "dias_vida_util" INTEGER;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "es_servicio" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "es_combo" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "imagen_principal" VARCHAR(500);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "imagenes_adicionales" JSONB DEFAULT '[]';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "ficha_tecnica_url" VARCHAR(500);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "slug" VARCHAR(255);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "keywords" TEXT;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "meta_description" VARCHAR(500);
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "visible_web" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "destacado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "atributos_especiales" JSONB DEFAULT '{}';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'ACTIVO';
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "motivo_inactivacion" TEXT;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "fecha_alta" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "fecha_baja" DATE;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_productos" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "codigo_categoria" VARCHAR(20);
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "nombre_categoria" VARCHAR(100);
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "descripcion" TEXT;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "categoria_padre_id" INTEGER;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "nivel_jerarquia" INTEGER DEFAULT 1;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "orden_visualizacion" INTEGER DEFAULT 1;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "imagen_url" VARCHAR(500);
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "configuracion_especial" JSONB DEFAULT '{}';
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_productos_categorias" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "producto_padre_id" INTEGER;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "producto_componente_id" INTEGER;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "cantidad_componente" NUMERIC(10,4) DEFAULT 1;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "precio_componente" NUMERIC(15,4);
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "es_opcional" BOOLEAN DEFAULT false;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "orden_visualizacion" INTEGER DEFAULT 1;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_productos_componentes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "codigo_marca" VARCHAR(20);
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "nombre_marca" VARCHAR(100);
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "descripcion" TEXT;
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "logo_url" VARCHAR(500);
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "sitio_web" VARCHAR(255);
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "contacto_proveedor" VARCHAR(255);
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_productos_marcas" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "producto_id" INTEGER;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "lista_precios_id" INTEGER;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "precio_especial" NUMERIC(15,4);
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "precio_con_descuento" NUMERIC(15,4);
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "descuento_porcentaje" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "fecha_vigencia_desde" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "fecha_vigencia_hasta" DATE;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "cantidad_minima" NUMERIC(10,4) DEFAULT 1;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_productos_precios" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "codigo_punto_venta" VARCHAR(10);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "nombre_punto_venta" VARCHAR(100);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "direccion" TEXT;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "telefono" VARCHAR(50);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "email" VARCHAR(100);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "responsable_nombre" VARCHAR(100);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "responsable_documento" VARCHAR(20);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "cuit_empresa" VARCHAR(13);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "razon_social_empresa" VARCHAR(200);
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "condicion_iva" VARCHAR(50) DEFAULT 'RESPONSABLE_INSCRIPTO';
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "punto_venta_afip" INTEGER;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "certificado_afip" TEXT;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "clave_fiscal" TEXT;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "permite_factura_a" BOOLEAN DEFAULT true;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "permite_factura_b" BOOLEAN DEFAULT true;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "permite_factura_c" BOOLEAN DEFAULT true;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "permite_nota_credito" BOOLEAN DEFAULT true;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "permite_nota_debito" BOOLEAN DEFAULT true;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "permite_presupuestos" BOOLEAN DEFAULT true;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "predeterminado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "siac_puntos_venta" ADD COLUMN IF NOT EXISTS "updated_by" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "punto_venta" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "numero_recibo" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "numero_completo" VARCHAR(20);
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "fecha" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "cliente_nombre" VARCHAR(255);
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "total" NUMERIC(15,2);
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "moneda" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "cotizacion" NUMERIC(15,4) DEFAULT 1;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'EMITIDO';
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "cobrador_id" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "sesion_caja_id" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "anulado_por" INTEGER;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "anulado_at" TIMESTAMP;
ALTER TABLE "siac_recibos" ADD COLUMN IF NOT EXISTS "motivo_anulacion" TEXT;
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "recibo_id" INTEGER;
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "movimiento_cta_cte_id" INTEGER;
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "factura_numero" VARCHAR(20);
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "factura_fecha" DATE;
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "factura_total" NUMERIC(15,2);
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "saldo_anterior" NUMERIC(15,2);
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "monto_imputado" NUMERIC(15,2);
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "saldo_posterior" NUMERIC(15,2);
ALTER TABLE "siac_recibos_imputaciones" ADD COLUMN IF NOT EXISTS "es_anticipo" BOOLEAN DEFAULT false;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "recibo_id" INTEGER;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "medio_pago" VARCHAR(30);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "monto" NUMERIC(15,2);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_numero" VARCHAR(20);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_banco" VARCHAR(100);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_sucursal" VARCHAR(50);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_cuit_emisor" VARCHAR(15);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_titular" VARCHAR(100);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_fecha_emision" DATE;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_fecha_cobro" DATE;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_a_la_orden" VARCHAR(100);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "cheque_cruzado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "transferencia_referencia" VARCHAR(50);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "transferencia_banco" VARCHAR(100);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "transferencia_fecha" DATE;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "transferencia_cbu_origen" VARCHAR(25);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "tarjeta_tipo" VARCHAR(20);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "tarjeta_ultimos_digitos" VARCHAR(4);
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "tarjeta_cuotas" INTEGER DEFAULT 1;
ALTER TABLE "siac_recibos_medios_pago" ADD COLUMN IF NOT EXISTS "tarjeta_autorizacion" VARCHAR(20);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "recibo_id" INTEGER;
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "tipo_retencion" VARCHAR(30);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "descripcion" VARCHAR(200);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "base_imponible" NUMERIC(15,2);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "porcentaje" NUMERIC(5,2);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "monto_retenido" NUMERIC(15,2);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "numero_certificado" VARCHAR(50);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "fecha_certificado" DATE;
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "jurisdiccion" VARCHAR(50);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "codigo_jurisdiccion" VARCHAR(10);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "cuit_agente_retencion" VARCHAR(20);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "razon_social_agente" VARCHAR(200);
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "anulado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "fecha_anulacion" TIMESTAMP;
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_recibos_retenciones" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "tipo_remito" VARCHAR(1) DEFAULT 'R';
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "punto_venta" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "numero_remito" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "numero_completo" VARCHAR(20);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "fecha" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "cai" VARCHAR(20);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "cai_vencimiento" DATE;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "cliente_id" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "cliente_nombre" VARCHAR(255);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "cliente_cuit" VARCHAR(15);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "cliente_domicilio" TEXT;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "entrega_domicilio" TEXT;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "entrega_localidad" VARCHAR(100);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "entrega_provincia" VARCHAR(100);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "entrega_codigo_postal" VARCHAR(10);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "entrega_contacto" VARCHAR(100);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "entrega_telefono" VARCHAR(50);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "transporte" VARCHAR(100);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "patente" VARCHAR(20);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "chofer" VARCHAR(100);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "chofer_dni" VARCHAR(15);
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "presupuesto_id" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'EMITIDO';
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "facturado_at" TIMESTAMP;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "cantidad_items" INTEGER DEFAULT 0;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "anulado_por" INTEGER;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "anulado_at" TIMESTAMP;
ALTER TABLE "siac_remitos" ADD COLUMN IF NOT EXISTS "motivo_anulacion" TEXT;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "remito_id" INTEGER;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "producto_id" INTEGER;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "codigo" VARCHAR(50);
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "descripcion" VARCHAR(255);
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "unidad_medida" VARCHAR(20) DEFAULT 'UN';
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "cantidad" NUMERIC(15,4);
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "cantidad_facturada" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "presupuesto_item_id" INTEGER;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "lote" VARCHAR(50);
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "numero_serie" VARCHAR(100);
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "fecha_vencimiento" DATE;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "orden" INTEGER DEFAULT 0;
ALTER TABLE "siac_remitos_items" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "caja_id" INTEGER;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "fecha_apertura" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "fecha_cierre" TIMESTAMP;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "usuario_apertura" INTEGER;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "usuario_cierre" INTEGER;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "monto_inicial_efectivo" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "monto_final_efectivo" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "diferencia_efectivo" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "total_ventas_efectivo" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "total_ventas_tarjetas" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "total_ventas_otros" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "total_ventas_sesion" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "cantidad_facturas" INTEGER DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "cantidad_notas_credito" INTEGER DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "cantidad_anulaciones" INTEGER DEFAULT 0;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'ABIERTA';
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "observaciones_apertura" TEXT;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "observaciones_cierre" TEXT;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "motivo_diferencia" TEXT;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_sesiones_caja" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "session_id" VARCHAR(100);
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "terminal_id" VARCHAR(50);
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "facturacion_temp" JSONB DEFAULT '[]';
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "recibos_temp" JSONB DEFAULT '[]';
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "ordenes_pago_temp" JSONB DEFAULT '[]';
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "otros_temp" JSONB DEFAULT '{}';
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "locked_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "last_activity" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "configuracion_local" JSONB DEFAULT '{}';
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_sesiones_locales" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "producto_id" INTEGER;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "tipo_movimiento" VARCHAR(20);
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "cantidad" NUMERIC(15,4);
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "precio_unitario" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "stock_anterior" NUMERIC(15,4);
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "stock_resultante" NUMERIC(15,4);
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "factura_id" INTEGER;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "compra_id" INTEGER;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "ajuste_id" INTEGER;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "motivo" VARCHAR(100);
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "observaciones" TEXT;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "lote" VARCHAR(50);
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "fecha_vencimiento" DATE;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "deposito" VARCHAR(50) DEFAULT 'PRINCIPAL';
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "ubicacion" VARCHAR(100);
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "usuario_id" INTEGER;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "fecha_movimiento" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_stock_movimientos" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "codigo_tipo" VARCHAR(10);
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "nombre_tipo" VARCHAR(100);
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "descripcion" TEXT;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "codigo_afip" INTEGER;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "letra_comprobante" character;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "discrimina_iva" BOOLEAN DEFAULT false;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "es_factura" BOOLEAN DEFAULT true;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "es_nota_credito" BOOLEAN DEFAULT false;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "es_nota_debito" BOOLEAN DEFAULT false;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "es_presupuesto" BOOLEAN DEFAULT false;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "afecta_stock" BOOLEAN DEFAULT true;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "afecta_cuenta_corriente" BOOLEAN DEFAULT true;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "requiere_autorizacion" BOOLEAN DEFAULT false;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "permite_descuento" BOOLEAN DEFAULT true;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "usa_numeracion_automatica" BOOLEAN DEFAULT true;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "formato_numero" VARCHAR(50) DEFAULT '00000-00000000';
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "activo" BOOLEAN DEFAULT true;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "predeterminado" BOOLEAN DEFAULT false;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "configuracion_adicional" JSONB DEFAULT '{}';
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_tipos_comprobantes" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "session_id" VARCHAR(100);
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "tipo_operacion" VARCHAR(50);
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "estado" VARCHAR(20) DEFAULT 'INICIADA';
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "datos_operacion" JSONB;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "numero_comprobante" INTEGER;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "iniciada_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "completada_at" TIMESTAMP;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "reintentos" INTEGER DEFAULT 0;
ALTER TABLE "siac_transacciones_pendientes" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "approver_id" VARCHAR(100);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "approver_role" VARCHAR(50);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "request_type" VARCHAR(50);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "total_requests" INTEGER DEFAULT 0;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "avg_response_hours" NUMERIC(10,2);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "median_response_hours" NUMERIC(10,2);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "min_response_hours" NUMERIC(10,2);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "max_response_hours" NUMERIC(10,2);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "sla_target_hours" INTEGER;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "within_sla_count" INTEGER DEFAULT 0;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "outside_sla_count" INTEGER DEFAULT 0;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "sla_compliance_percent" NUMERIC(5,2);
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "sla_metrics" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "is_extreme" BOOLEAN DEFAULT false;
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "risk_level" VARCHAR(20) DEFAULT 'low';
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "requires_medical_clearance" BOOLEAN DEFAULT false;
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "sports_catalog" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "username" VARCHAR(50);
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "password" VARCHAR(255);
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(200);
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "permissions" JSONB DEFAULT '{}';
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "super_users" ADD COLUMN IF NOT EXISTS "last_login" TIMESTAMP;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "portal_user_id" INTEGER;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "token" VARCHAR(6);
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "operation_type" VARCHAR(50);
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMPTZ;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "attempts_remaining" INTEGER DEFAULT 3;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "last_attempt_at" TIMESTAMPTZ;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "last_attempt_ip" VARCHAR(45);
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMPTZ;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "verified_from_ip" VARCHAR(45);
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "cancelled_at" TIMESTAMPTZ;
ALTER TABLE "supplier_auth_tokens" ADD COLUMN IF NOT EXISTS "cancelled_reason" TEXT;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "claim_id" INTEGER;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "po_item_id" INTEGER;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "gr_item_id" INTEGER;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "quantity_affected" NUMERIC(12,3);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "total_affected" NUMERIC(15,2);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "defect_type" VARCHAR(50);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "defect_description" TEXT;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "batch_number" VARCHAR(50);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "serial_numbers" JSONB DEFAULT '[]';
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "photos" JSONB DEFAULT '[]';
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "resolution_status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "resolution_type" VARCHAR(30);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "resolution_quantity" NUMERIC(12,3);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "resolution_amount" NUMERIC(15,2);
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_claim_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "claim_id" INTEGER;
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "sender_type" VARCHAR(20);
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "sender_user_id" INTEGER;
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMPTZ;
ALTER TABLE "supplier_claim_messages" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "claim_number" VARCHAR(30);
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "purchase_order_id" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "goods_receipt_id" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "claim_type" VARCHAR(30);
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "claim_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "resolution_deadline" DATE;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "total_affected_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "total_affected_quantity" NUMERIC(12,3) DEFAULT 0;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "requested_resolution" VARCHAR(30);
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "submitted_at" TIMESTAMPTZ;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "submitted_by" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMPTZ;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "acknowledged_by_supplier" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "supplier_response" TEXT;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "supplier_response_date" TIMESTAMPTZ;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "resolution_type" VARCHAR(30);
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "resolution_amount" NUMERIC(15,2);
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "resolution_notes" TEXT;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMPTZ;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "resolved_by" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "satisfaction_rating" INTEGER;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_claims" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "credit_note_id" INTEGER;
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "claim_item_id" INTEGER;
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "invoice_item_id" INTEGER;
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(12,3);
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "tax_rate" NUMERIC(5,2) DEFAULT 21;
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "line_subtotal" NUMERIC(15,2);
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "line_tax" NUMERIC(15,2);
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_credit_note_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "internal_number" VARCHAR(30);
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "claim_id" INTEGER;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "credit_note_type" VARCHAR(20);
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "credit_note_number" VARCHAR(30);
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "credit_note_point_of_sale" VARCHAR(10);
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "credit_note_date" DATE;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "cae" VARCHAR(20);
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "cae_expiry" DATE;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "reason" VARCHAR(50);
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "iva_21" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "iva_10_5" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "other_taxes" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "amount_applied" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "balance" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "verified_by" INTEGER;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMPTZ;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "applied_to_invoice_id" INTEGER;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "applied_at" TIMESTAMPTZ;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_credit_notes" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "invoice_id" INTEGER;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "po_item_id" INTEGER;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "gr_item_id" INTEGER;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(12,3);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "discount_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "tax_rate" NUMERIC(5,2) DEFAULT 21;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "line_subtotal" NUMERIC(15,2);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "line_tax" NUMERIC(15,2);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_invoice_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "internal_number" VARCHAR(30);
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "purchase_order_id" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "goods_receipt_id" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "invoice_type" VARCHAR(20);
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "invoice_number" VARCHAR(30);
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "invoice_point_of_sale" VARCHAR(10);
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "invoice_date" DATE;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "cae" VARCHAR(20);
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "cae_expiry" DATE;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "exchange_rate" NUMERIC(10,4) DEFAULT 1;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "discount_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "taxable_base" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "iva_21" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "iva_10_5" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "iva_27" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "other_taxes" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "perceptions" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "retentions" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "amount_paid" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "balance_due" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "payment_blocked" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "payment_block_reason" TEXT;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "verified_by" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMPTZ;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "approved_by" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(255);
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "file_path" TEXT;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "file_size" BIGINT;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "dms_document_id" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "uploaded_by" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "uploaded_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "invoice_required" BOOLEAN DEFAULT true;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "invoice_validated" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "invoice_validation_notes" TEXT;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "validated_by" INTEGER;
ALTER TABLE "supplier_invoices" ADD COLUMN IF NOT EXISTS "validated_at" TIMESTAMPTZ;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "year" INTEGER;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "month" INTEGER;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "total_orders" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "on_time_deliveries" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "late_deliveries" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "on_time_rate" NUMERIC(5,2);
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "total_claims" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "claims_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "quality_rate" NUMERIC(5,2);
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "avg_response_time_hours" NUMERIC(10,2);
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "quotations_submitted" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "quotations_won" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "win_rate" NUMERIC(5,2);
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "credit_notes_received" INTEGER DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "credit_notes_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_monthly_stats" ADD COLUMN IF NOT EXISTS "calculated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(50);
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(30);
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "reference_id" INTEGER;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "action_url" VARCHAR(500);
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "action_required" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "action_deadline" TIMESTAMPTZ;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMPTZ;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "email_sent" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "email_sent_at" TIMESTAMPTZ;
ALTER TABLE "supplier_notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "offer_id" INTEGER;
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "regular_price" NUMERIC(15,4);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "offer_price" NUMERIC(15,4);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "discount_percent" NUMERIC(5,2);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "min_quantity" NUMERIC(12,3) DEFAULT 1;
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "max_quantity" NUMERIC(12,3);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "available_stock" NUMERIC(12,3);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "image_url" VARCHAR(500);
ALTER TABLE "supplier_offer_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_offer_views" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_offer_views" ADD COLUMN IF NOT EXISTS "offer_id" INTEGER;
ALTER TABLE "supplier_offer_views" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "supplier_offer_views" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "supplier_offer_views" ADD COLUMN IF NOT EXISTS "viewed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_offer_views" ADD COLUMN IF NOT EXISTS "view_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "offer_number" VARCHAR(30);
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "offer_type" VARCHAR(30);
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "min_order_amount" NUMERIC(15,2);
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "min_order_quantity" NUMERIC(12,3);
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "discount_type" VARCHAR(20);
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "discount_value" NUMERIC(10,2);
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "free_shipping" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "terms_conditions" TEXT;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "target_companies" JSONB DEFAULT '[]';
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'draft';
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "submitted_at" TIMESTAMPTZ;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "submitted_by" INTEGER;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "approved_by" INTEGER;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "views_count" INTEGER DEFAULT 0;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "clicks_count" INTEGER DEFAULT 0;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "orders_generated" INTEGER DEFAULT 0;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "revenue_generated" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_offers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "password_hash" VARCHAR(255);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(30);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "position" VARCHAR(100);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "role" VARCHAR(30) DEFAULT 'sales';
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "is_primary_contact" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "email_verified" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "email_verified_at" TIMESTAMPTZ;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "verification_token" VARCHAR(100);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "reset_token" VARCHAR(100);
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "reset_token_expires" TIMESTAMPTZ;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "last_login" TIMESTAMPTZ;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "login_count" INTEGER DEFAULT 0;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "preferences" JSONB DEFAULT '{}';
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "must_change_password" BOOLEAN DEFAULT true;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "banking_info_complete" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "banking_info_verified_at" TIMESTAMPTZ;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "banking_info_verified_by" INTEGER;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "can_quote" BOOLEAN;
ALTER TABLE "supplier_portal_users" ADD COLUMN IF NOT EXISTS "compliance_status" VARCHAR(30) DEFAULT 'incomplete';
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "quotation_id" INTEGER;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "rfq_item_id" INTEGER;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "item_number" INTEGER;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "is_alternative" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "alternative_for_item_id" INTEGER;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(12,3);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "discount_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "tax_rate" NUMERIC(5,2) DEFAULT 21;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "line_total" NUMERIC(15,2);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "delivery_days" INTEGER;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "availability" VARCHAR(50);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "brand" VARCHAR(100);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "origin" VARCHAR(50);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "warranty" VARCHAR(100);
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_quotation_items" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "rfq_id" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "quotation_number" VARCHAR(30);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "quotation_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "discount_percent" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "discount_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "payment_terms" VARCHAR(200);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "delivery_terms" VARCHAR(200);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "delivery_days" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "warranty_terms" VARCHAR(200);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "supplier_notes" TEXT;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "is_partial" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "is_alternative" BOOLEAN DEFAULT false;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "submitted_at" TIMESTAMPTZ;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "submitted_by" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMPTZ;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "reviewed_by" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "acceptance_notes" TEXT;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "score_price" NUMERIC(5,2);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "score_quality" NUMERIC(5,2);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "score_delivery" NUMERIC(5,2);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "score_total" NUMERIC(5,2);
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "rank" INTEGER;
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "supplier_quotations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "log_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "ticket_id" UUID;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "support_user_id" UUID;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "session_id" UUID;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "session_started_at" TIMESTAMPTZ;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "session_ended_at" TIMESTAMPTZ;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "activity_type" VARCHAR(100);
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "action_description" TEXT;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "affected_data" JSONB;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "support_activity_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "attempt_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "ticket_id" UUID;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "assistant_type" VARCHAR(50);
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "user_question" TEXT;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "assistant_response" TEXT;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "confidence_score" NUMERIC(3,2);
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "user_satisfied" BOOLEAN;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "user_feedback" TEXT;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "attempted_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "responded_at" TIMESTAMPTZ;
ALTER TABLE "support_assistant_attempts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "escalation_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "ticket_id" UUID;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "escalated_from_user_id" UUID;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "escalated_to_user_id" UUID;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "escalation_reason" VARCHAR(100);
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "escalated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMPTZ;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "escalation_notes" TEXT;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "resolution_notes" TEXT;
ALTER TABLE "support_escalations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "response_time_hours" INTEGER;
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "resolution_time_hours" INTEGER;
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "escalation_time_hours" INTEGER;
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "support_sla_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "plan_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "plan_name" VARCHAR(100);
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "display_name" VARCHAR(200);
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "first_response_hours" INTEGER;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "resolution_hours" INTEGER;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "escalation_hours" INTEGER;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "price_monthly" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "has_ai_assistant" BOOLEAN DEFAULT false;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "priority_level" INTEGER DEFAULT 3;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_sla_plans" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "ticket_id" UUID;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "from_level" INTEGER;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "to_level" INTEGER;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "from_staff_id" UUID;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "to_staff_id" UUID;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "escalation_type" VARCHAR(20);
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "escalated_by" UUID;
ALTER TABLE "support_ticket_escalations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "message_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "ticket_id" UUID;
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "user_role" VARCHAR(50);
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "is_internal" BOOLEAN DEFAULT false;
ALTER TABLE "support_ticket_messages" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "ticket_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "ticket_number" VARCHAR(50);
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "created_by_user_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "module_display_name" VARCHAR(200);
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(500);
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "allow_support_access" BOOLEAN DEFAULT false;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "temp_support_user_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "temp_password_hash" VARCHAR(255);
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "temp_password_expires_at" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "temp_access_granted_at" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "assigned_to_vendor_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'open';
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "closed_by_user_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "close_reason" TEXT;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "rating" INTEGER;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "rating_comment" TEXT;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "rated_at" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "sla_first_response_deadline" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "sla_resolution_deadline" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "sla_escalation_deadline" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "first_response_at" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "escalated_to_supervisor_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "assistant_attempted" BOOLEAN DEFAULT false;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "assistant_resolved" BOOLEAN DEFAULT false;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "thread_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "notification_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "feedback" TEXT;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 1;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "assigned_staff_id" UUID;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "escalated_at" TIMESTAMPTZ;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "escalation_reason" TEXT;
ALTER TABLE "support_tickets" ADD COLUMN IF NOT EXISTS "sla_breach_at" TIMESTAMPTZ;
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "stat_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "total_tickets" INTEGER DEFAULT 0;
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "tickets_resolved" INTEGER DEFAULT 0;
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "tickets_closed" INTEGER DEFAULT 0;
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "avg_resolution_time_hours" NUMERIC(10,2);
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "avg_rating" NUMERIC(3,2);
ALTER TABLE "support_vendor_stats" ADD COLUMN IF NOT EXISTS "calculated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "assignment_id" UUID DEFAULT uuid_generate_v4();
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "assigned_by_user_id" UUID;
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "support_vendor_supervisors" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "sanction_id" INTEGER;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "total_work_days" INTEGER;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "days_served" INTEGER DEFAULT 0;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "block_type" VARCHAR(50) DEFAULT 'full';
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "blocked_actions" JSONB DEFAULT '["checkin", "checkout"]';
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "deactivated_at" TIMESTAMP;
ALTER TABLE "suspension_blocks" ADD COLUMN IF NOT EXISTS "deactivated_by" UUID;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "config_key" VARCHAR(100);
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "config_group" VARCHAR(50);
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "value_type" VARCHAR(20);
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "value" TEXT;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "default_value" TEXT;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "validation_rules" JSONB;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "is_required" BOOLEAN DEFAULT false;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "is_sensitive" BOOLEAN DEFAULT false;
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "synapse_config" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(100);
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "doc_key" VARCHAR(100);
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "summary" TEXT;
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20) DEFAULT '1.0.0';
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "related_docs" TEXT[];
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "synapse_documentation" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(100);
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "execution_id" VARCHAR(100);
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "execution_type" VARCHAR(50);
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "preset_id" INTEGER;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "config_snapshot" JSONB;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "total_modules" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "modules_passed" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "modules_failed" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "total_tests" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "tests_passed" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "tests_failed" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMP;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "duration_ms" INTEGER;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "brain_analysis" JSONB;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "fixes_applied" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "fixes_successful" INTEGER DEFAULT 0;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "modules_details" JSONB;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "error_summary" TEXT;
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "triggered_by" VARCHAR(100);
ALTER TABLE "synapse_execution_history" ADD COLUMN IF NOT EXISTS "environment" VARCHAR(50) DEFAULT 'local';
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "preset_name" VARCHAR(100);
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "config" JSONB;
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "usage_count" INTEGER DEFAULT 0;
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "last_used_at" TIMESTAMP;
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "synapse_test_presets" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "connectionMode" TEXT DEFAULT 'local';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "toleranceMinutesEntry" INTEGER DEFAULT 10;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "toleranceMinutesExit" INTEGER DEFAULT 15;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "maxOvertimeHours" NUMERIC(4,2) DEFAULT 3;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "gpsRadius" INTEGER DEFAULT 50;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "requireAdminApproval" BOOLEAN DEFAULT true;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "sendNotifications" BOOLEAN DEFAULT true;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "autoBackup" BOOLEAN DEFAULT true;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "backupHour" INTEGER DEFAULT 2;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "maxLoginAttempts" INTEGER DEFAULT 5;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "lockoutDuration" INTEGER DEFAULT 30;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "sessionTimeout" INTEGER DEFAULT 24;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "companyName" VARCHAR(255) DEFAULT 'Mi Empresa';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "companyLogo" VARCHAR(255);
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(255) DEFAULT 'America/Argentina/Buenos_Aires';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "locale" VARCHAR(255) DEFAULT 'es-AR';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(255) DEFAULT 'ARS';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "emailSettings" JSON DEFAULT '{}';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "smsSettings" JSON DEFAULT '{}';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "whatsappSettings" JSON DEFAULT '{}';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "biometricSettings" JSON DEFAULT '{"fingerprintEnabled":true,"faceRecognitionEnabled":true,"maxFingerprints":5,"readerType":"zkteco"}';
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "system_config" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "log_id" BIGINT;
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "event_data" JSONB;
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "result" VARCHAR(20);
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "system_consciousness_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "metadata_id" INTEGER;
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "metadata_key" VARCHAR(100);
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "metadata_value" JSONB;
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "metadata_type" VARCHAR(50);
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "system_metadata" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(50);
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "category" TEXT DEFAULT 'core';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "base_price" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "is_core" BOOLEAN DEFAULT false;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "features" JSONB DEFAULT '[]';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "requirements" JSONB DEFAULT '[]';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20) DEFAULT '1.0.0';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "min_employees" INTEGER;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "max_employees" INTEGER;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "rubro" VARCHAR(100) DEFAULT 'General';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "bundled_modules" JSONB DEFAULT '[]';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "available_in" VARCHAR(20) DEFAULT 'both';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "provides_to" JSONB DEFAULT '[]';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "integrates_with" JSONB DEFAULT '[]';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "ui_metadata" JSONB DEFAULT '{"tabs": [], "inputs": [], "modals": [], "mainButtons": []}';
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "parent_module_key" VARCHAR(100);
ALTER TABLE "system_modules" ADD COLUMN IF NOT EXISTS "module_type" VARCHAR(20) DEFAULT 'standalone';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "registry_id" INTEGER;
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(255);
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "module_category" VARCHAR(50);
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "pricing" NUMERIC(10,2) DEFAULT 0.00;
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "dependencies" JSONB DEFAULT '[]';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "optional_dependencies" JSONB DEFAULT '[]';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "provides_to" JSONB DEFAULT '[]';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "integrates_with" JSONB DEFAULT '[]';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "limits" JSONB DEFAULT '{}';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "features" JSONB DEFAULT '[]';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20) DEFAULT '1.0.0';
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "system_modules_registry" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "key" VARCHAR(100);
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "value" TEXT;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "data_type" VARCHAR(20) DEFAULT 'string';
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "default_value" TEXT;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "display_name" VARCHAR(200);
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "is_sensitive" BOOLEAN DEFAULT false;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "requires_restart" BOOLEAN DEFAULT false;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "validation_regex" VARCHAR(500);
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "options" JSONB;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "modified_by_staff_id" UUID;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "modified_at" TIMESTAMPTZ;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "system_settings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "primary_user_id" UUID;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "cover_user_id" UUID;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "compatibility_score" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "coverable_tasks" JSONB DEFAULT '[]';
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "max_coverage_hours" INTEGER;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "max_concurrent_tasks" INTEGER DEFAULT 3;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "last_performance_score" NUMERIC(5,2);
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "total_coverage_hours" INTEGER DEFAULT 0;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "successful_coverages" INTEGER DEFAULT 0;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "is_auto_calculated" BOOLEAN DEFAULT false;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "last_calculation_date" DATE;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "calculation_data" JSONB;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "manual_notes" TEXT;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "task_compatibility" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "tax_template_id" INTEGER;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "concept_code" VARCHAR(20);
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "concept_name" VARCHAR(100);
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "calculation_order" INTEGER DEFAULT 1;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "base_amount" VARCHAR(20) DEFAULT 'neto_final';
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "concept_type" VARCHAR(20) DEFAULT 'tax';
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "is_percentage" BOOLEAN DEFAULT true;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "is_compound" BOOLEAN DEFAULT false;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "affects_total" BOOLEAN DEFAULT true;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "tax_concepts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "tax_template_id" INTEGER;
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "condition_code" VARCHAR(20);
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "condition_name" VARCHAR(100);
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 1;
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "tax_conditions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "tax_concept_id" INTEGER;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "rate_code" VARCHAR(20);
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "rate_name" VARCHAR(100);
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "rate_percentage" NUMERIC(8,4);
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "minimum_amount" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "maximum_amount" NUMERIC(15,4);
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "applicable_conditions" JSONB;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "date_from" DATE;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "date_to" DATE;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "tax_rates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "country" VARCHAR(50);
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(100);
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_format" VARCHAR(50);
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_field_name" VARCHAR(50) DEFAULT 'CUIT';
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_validation_regex" VARCHAR(200);
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "remove_separators" BOOLEAN DEFAULT true;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "currencies" JSONB DEFAULT '["ARS"]';
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "default_currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_field_description" VARCHAR(200);
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_format_mask" VARCHAR(50);
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_min_length" INTEGER DEFAULT 8;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_max_length" INTEGER DEFAULT 15;
ALTER TABLE "tax_templates" ADD COLUMN IF NOT EXISTS "tax_id_required_for_invoicing" BOOLEAN DEFAULT true;
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "grant_id" UUID;
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "activity_type" VARCHAR(50);
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "module_accessed" VARCHAR(100);
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "action_performed" VARCHAR(100);
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "session_id" VARCHAR(255);
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "request_details" JSONB DEFAULT '{}';
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "response_status" INTEGER;
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "temporary_access_activity_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(200);
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(20);
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(20);
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "organization" VARCHAR(200);
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "access_type" VARCHAR(50) DEFAULT 'external_auditor';
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "username" VARCHAR(100);
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "password_hash" VARCHAR(255);
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "temp_password_plain" TEXT;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "allowed_modules" JSONB DEFAULT '[]';
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "permission_level" VARCHAR(20) DEFAULT 'read_only';
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "custom_permissions" JSONB DEFAULT '{}';
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "allowed_ip_ranges" TEXT[];
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "max_concurrent_sessions" INTEGER DEFAULT 1;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "require_password_change" BOOLEAN DEFAULT true;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "two_factor_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "valid_from" TIMESTAMP DEFAULT now();
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "valid_until" TIMESTAMP;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "auto_revoke_on_expiry" BOOLEAN DEFAULT true;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "first_login_at" TIMESTAMP;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "last_login_at" TIMESTAMP;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "password_changed" BOOLEAN DEFAULT false;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "password_changed_at" TIMESTAMP;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "total_logins" INTEGER DEFAULT 0;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "failed_login_attempts" INTEGER DEFAULT 0;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "last_failed_login_at" TIMESTAMP;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "revoked_by" UUID;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "revoked_at" TIMESTAMP;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "revocation_reason" TEXT;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "purpose" TEXT;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "temporary_access_grants" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "grant_id" UUID;
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(50);
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "channel" VARCHAR(20);
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "recipient_email" VARCHAR(255);
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "recipient_phone" VARCHAR(20);
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(500);
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "content" TEXT;
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMP;
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMP;
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "failed_reason" TEXT;
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "temporary_access_notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "template_key" VARCHAR(100);
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10) DEFAULT 'üë§';
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "color" VARCHAR(20) DEFAULT '#667eea';
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "access_type" VARCHAR(50);
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "default_duration_days" INTEGER DEFAULT 30;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "allowed_modules" JSONB DEFAULT '[]';
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "permission_level" VARCHAR(20) DEFAULT 'read_only';
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "require_password_change" BOOLEAN DEFAULT true;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "two_factor_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "max_concurrent_sessions" INTEGER DEFAULT 1;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "is_global" BOOLEAN DEFAULT false;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "display_order" INTEGER DEFAULT 0;
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "temporary_access_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "execution_id" UUID;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "environment" VARCHAR(20);
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "module" VARCHAR(100);
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "cycles" INTEGER DEFAULT 1;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "slow_mo" INTEGER DEFAULT 50;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "base_url" VARCHAR(500);
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "total_tests" INTEGER DEFAULT 0;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "ui_tests_passed" INTEGER DEFAULT 0;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "ui_tests_failed" INTEGER DEFAULT 0;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "db_tests_passed" INTEGER DEFAULT 0;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "db_tests_failed" INTEGER DEFAULT 0;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "success_rate" NUMERIC(5,2);
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "start_time" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "end_time" TIMESTAMPTZ;
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "duration_seconds" NUMERIC(10,2);
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "errors" JSONB DEFAULT '[]';
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "tickets" JSONB DEFAULT '[]';
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "logs" JSONB DEFAULT '[]';
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "test_executions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "test_timestamp" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "total_tests" INTEGER DEFAULT 0;
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "passed" INTEGER DEFAULT 0;
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "failed" INTEGER DEFAULT 0;
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "coverage" INTEGER DEFAULT 0;
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "duration_ms" INTEGER DEFAULT 0;
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "results_json" JSONB DEFAULT '{}';
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "discoveries_json" JSONB DEFAULT '{}';
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "test_results" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "ticket_number" VARCHAR(20);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'PENDING_REPAIR';
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "module_name" VARCHAR(100);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "error_type" VARCHAR(100);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "error_stack" TEXT;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "error_details" JSONB;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "file_path" VARCHAR(500);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "line_number" INTEGER;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "function_name" VARCHAR(255);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "test_name" VARCHAR(255);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "test_type" VARCHAR(50);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "test_context" JSONB;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100) DEFAULT 'ollama-auditor';
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "assigned_to" VARCHAR(100) DEFAULT 'claude-code';
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "fix_attempted" BOOLEAN DEFAULT false;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "fix_strategy" VARCHAR(255);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "fix_description" TEXT;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "fix_files_modified" JSONB;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "fix_applied_at" TIMESTAMPTZ;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "fix_applied_by" VARCHAR(100);
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "retest_count" INTEGER DEFAULT 0;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "retest_passed" BOOLEAN;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "retest_last_at" TIMESTAMPTZ;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "retest_details" JSONB;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "closed_at" TIMESTAMPTZ;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "time_to_fix_minutes" INTEGER;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "time_to_close_minutes" INTEGER;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "last_message" TEXT;
ALTER TABLE "testing_tickets" ADD COLUMN IF NOT EXISTS "conversation_log" JSONB DEFAULT '[]';
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "training_id" INTEGER;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "progress_percentage" INTEGER DEFAULT 0;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "time_spent_minutes" INTEGER DEFAULT 0;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMPTZ;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "score" NUMERIC(5,2);
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "certificate_url" VARCHAR(500);
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "source_module" VARCHAR(50);
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "source_entity_type" VARCHAR(50);
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "source_entity_id" INTEGER;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "auto_assigned" BOOLEAN DEFAULT false;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "assignment_reason" TEXT;
ALTER TABLE "training_assignments" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "training_id" INTEGER;
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "rule_type" VARCHAR(50);
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "rule_config" JSONB;
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_eligibility_rules" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "source_module" VARCHAR(50);
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "source_entity_type" VARCHAR(50);
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "source_entity_id" INTEGER;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "training_id" INTEGER;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "assignment_id" INTEGER;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "success" BOOLEAN DEFAULT true;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_integration_log" ADD COLUMN IF NOT EXISTS "created_by" INTEGER;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "assignment_id" BIGINT;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "attempt_number" INTEGER DEFAULT 1;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "score" INTEGER;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "passed" BOOLEAN DEFAULT false;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "answers" JSONB;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "certificate_url" TEXT;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "certificate_issued_at" TIMESTAMPTZ;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "instructor_feedback" TEXT;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "student_feedback" TEXT;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "training_progress" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "duration" INTEGER DEFAULT 60;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "type" VARCHAR(50);
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "content_url" TEXT;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "deadline" DATE;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "instructor" VARCHAR(255);
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "max_score" INTEGER DEFAULT 100;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "min_score" INTEGER DEFAULT 70;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "attempts" INTEGER DEFAULT 2;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "mandatory" BOOLEAN DEFAULT false;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "certificate" BOOLEAN DEFAULT false;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "participants" INTEGER DEFAULT 0;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "completed" INTEGER DEFAULT 0;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "progress" INTEGER DEFAULT 0;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "requires_medical_clearance" BOOLEAN DEFAULT false;
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "required_medical_exams" TEXT[];
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "linked_procedure_ids" TEXT[];
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "hse_violation_codes" TEXT[];
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "risk_categories" TEXT[];
ALTER TABLE "trainings" ADD COLUMN IF NOT EXISTS "risk_level" VARCHAR(20) DEFAULT 'low';
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "kiosk_id" INTEGER;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(255);
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "employee_department" VARCHAR(100);
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "kiosk_authorized_departments" JSONB;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "attempt_type" VARCHAR(50);
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "biometric_similarity" NUMERIC(12,2);
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "security_photo" BYTEA;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP DEFAULT now();
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(255);
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(50);
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "reason" VARCHAR(255);
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "requires_hr_review" BOOLEAN DEFAULT true;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "reviewed_by" UUID;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "review_notes" TEXT;
ALTER TABLE "unauthorized_access_attempts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "interaction_type" VARCHAR(20);
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "question" TEXT;
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "answer" TEXT;
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "unified_help_interactions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "unified_help_stats" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "unified_help_stats" ADD COLUMN IF NOT EXISTS "chat_count" BIGINT;
ALTER TABLE "unified_help_stats" ADD COLUMN IF NOT EXISTS "tickets_created" BIGINT;
ALTER TABLE "unified_help_stats" ADD COLUMN IF NOT EXISTS "positive_feedback" BIGINT;
ALTER TABLE "unified_help_stats" ADD COLUMN IF NOT EXISTS "negative_feedback" BIGINT;
ALTER TABLE "unified_help_stats" ADD COLUMN IF NOT EXISTS "day" TIMESTAMPTZ;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "thread_id" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "parent_id" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sequence_in_thread" INTEGER DEFAULT 1;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "origin_type" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "origin_id" VARCHAR(100);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "origin_name" VARCHAR(255);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "origin_role" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "recipient_id" VARCHAR(100);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(255);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "recipient_role" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "recipient_department_id" INTEGER;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "recipient_hierarchy_level" INTEGER DEFAULT 0;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50) DEFAULT 'general';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(100);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'medium';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "short_message" VARCHAR(280);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "related_entity_type" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "related_entity_id" VARCHAR(100);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "read_by" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_options" JSONB DEFAULT '[]';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_deadline" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_taken_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_taken_by" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_response" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_notes" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "workflow_id" INTEGER;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "workflow_step" INTEGER DEFAULT 0;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "workflow_status" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sla_hours" INTEGER;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sla_deadline" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sla_breached" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sla_breach_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 0;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "escalated_from_id" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "escalated_to_id" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "escalation_reason" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "channels" JSONB DEFAULT '["app"]';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sent_via_app" BOOLEAN DEFAULT true;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sent_via_email" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sent_via_push" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "email_sent_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "push_sent_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "ai_analyzed" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "ai_analyzed_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "ai_suggested_response" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "ai_confidence" NUMERIC(5,4);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "ai_auto_responded" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "ai_topic" VARCHAR(100);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "ai_sentiment" VARCHAR(20);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "deleted_by" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "direction" VARCHAR(20) DEFAULT 'internal';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "external_email" VARCHAR(255);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "external_name" VARCHAR(255);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "aponnt_department" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "is_commercial" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "response_required_by" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "partner_id" INTEGER;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "partner_category" VARCHAR(50);
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "partner_substitution_id" INTEGER;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "email_sent" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "escalation_path" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sla_warning_sent" BOOLEAN DEFAULT false;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "sla_warning_sent_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "rich_content" JSONB;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "attachments" JSONB DEFAULT '[]';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "action_buttons" JSONB DEFAULT '[]';
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "image_url" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "icon_url" TEXT;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "unified_notifications" ADD COLUMN IF NOT EXISTS "is_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "used_tokens" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "used_tokens" ADD COLUMN IF NOT EXISTS "token" VARCHAR(500);
ALTER TABLE "used_tokens" ADD COLUMN IF NOT EXISTS "message_id" UUID;
ALTER TABLE "used_tokens" ADD COLUMN IF NOT EXISTS "used_at" TIMESTAMP DEFAULT now();
ALTER TABLE "used_tokens" ADD COLUMN IF NOT EXISTS "used_by" VARCHAR(100);
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "restriction_type" VARCHAR(100);
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "is_permanent" BOOLEAN DEFAULT false;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "medical_certificate_url" TEXT;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "issuing_doctor" VARCHAR(255);
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_activity_restrictions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "allergen" VARCHAR(255);
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "allergy_type" VARCHAR(50);
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(50);
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "symptoms" TEXT;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "diagnosed_date" DATE;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "requires_epipen" BOOLEAN DEFAULT false;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_allergies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "measurement_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "weight_kg" NUMERIC(5,2);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(5,2);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "bmi" NUMERIC(4,2);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "waist_circumference_cm" NUMERIC(5,2);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "hip_circumference_cm" NUMERIC(5,2);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "body_fat_percentage" NUMERIC(4,2);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "muscle_mass_kg" NUMERIC(5,2);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "blood_pressure_systolic" INTEGER;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "blood_pressure_diastolic" INTEGER;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "heart_rate_bpm" INTEGER;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "blood_type" VARCHAR(5);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "rh_factor" VARCHAR(10);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "measured_by" VARCHAR(200);
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_anthropometric_data" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "task_id" INTEGER;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "assigned_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pendiente';
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(50);
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "progress_percentage" INTEGER DEFAULT 0;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "completion_date" DATE;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "actual_hours" NUMERIC(5,2);
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT false;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "submitted_for_approval" BOOLEAN DEFAULT false;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "approval_date" DATE;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "approval_notes" TEXT;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "attachments" JSONB;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "comments" JSONB;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "reminder_sent" BOOLEAN DEFAULT false;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "reminder_date" DATE;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_assigned_tasks" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "changed_by_user_id" UUID;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "field_name" VARCHAR(100);
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "old_value" TEXT;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "new_value" TEXT;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "user_audit_logs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(50);
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "birth_date" DATE;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "gender" VARCHAR(20);
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "lives_with_employee" BOOLEAN DEFAULT true;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "is_dependent" BOOLEAN DEFAULT true;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "health_insurance_coverage" BOOLEAN DEFAULT false;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "special_needs" TEXT;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "school_name" VARCHAR(255);
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "grade_level" VARCHAR(50);
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_children" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "condition_name" VARCHAR(255);
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "diagnosis_date" DATE;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(50);
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "requires_treatment" BOOLEAN DEFAULT false;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "requires_monitoring" BOOLEAN DEFAULT false;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_chronic_conditions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "condition_catalog_id" INTEGER;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "condition_name" VARCHAR(200);
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "diagnosis_date" DATE;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "diagnosed_by" VARCHAR(200);
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20) DEFAULT 'moderate';
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "current_status" VARCHAR(30) DEFAULT 'active';
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "treatment_status" VARCHAR(30);
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "affects_work_capacity" BOOLEAN DEFAULT false;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "work_restrictions" TEXT;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "medications_required" TEXT;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "monitoring_frequency" VARCHAR(50);
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "last_checkup_date" DATE;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "next_checkup_date" DATE;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "specialist_doctor" VARCHAR(200);
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "specialist_phone" VARCHAR(50);
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_chronic_conditions_v2" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "user_consent_id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "user_type" VARCHAR(50);
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "consent_id" UUID;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "consent_version" VARCHAR(20);
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "accepted_at" TIMESTAMP;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMP;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "revoked_at" TIMESTAMP;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "ip_address" VARCHAR(45);
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "signature_data" TEXT;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_consents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "field_name" VARCHAR(100);
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "old_value" TEXT;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "new_value" TEXT;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "changed_by" UUID;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "change_reason" TEXT;
ALTER TABLE "user_contact_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(100);
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(50);
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "date_occurred" DATE;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "action_taken" TEXT;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "issued_by" UUID;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "issued_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "follow_up_required" BOOLEAN DEFAULT false;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "follow_up_date" DATE;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "employee_acknowledgement" BOOLEAN DEFAULT false;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "employee_comments" TEXT;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "supporting_document_url" TEXT;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_disciplinary_actions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(100);
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(100);
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "issuing_authority" VARCHAR(255);
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "file_url" TEXT;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_documents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "license_type" VARCHAR(50);
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "license_number" VARCHAR(100);
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "license_class" VARCHAR(20);
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "subclass" VARCHAR(50);
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "photo_url" TEXT;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "issuing_authority" VARCHAR(255);
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "issuing_country" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "restrictions" TEXT;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "observations" TEXT;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "requires_glasses" BOOLEAN DEFAULT false;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "suspension_start_date" DATE;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "suspension_end_date" DATE;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "suspension_reason" TEXT;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_driver_licenses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "education_level" VARCHAR(100);
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "institution_name" VARCHAR(255);
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "degree_title" VARCHAR(255);
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "field_of_study" VARCHAR(255);
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "graduated" BOOLEAN DEFAULT false;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "certificate_file_url" TEXT;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_education" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "is_primary" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN DEFAULT false;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "verification_token" VARCHAR(255);
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "receive_system_notifications" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "receive_attendance_alerts" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "receive_vacation_updates" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "receive_medical_notifications" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "receive_legal_notices" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "receive_shifts_changes" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "receive_payroll_notifications" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "email_format" VARCHAR(20) DEFAULT 'html';
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "email_frequency" VARCHAR(20) DEFAULT 'instant';
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "bounced" BOOLEAN DEFAULT false;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "bounced_at" TIMESTAMP;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "bounce_count" INTEGER DEFAULT 0;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_emails" ADD COLUMN IF NOT EXISTS "last_email_sent" TIMESTAMP;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 1;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "relationship" VARCHAR(30);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "phone_primary" VARCHAR(30);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "phone_secondary" VARCHAR(30);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "phone_work" VARCHAR(30);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "available_hours" VARCHAR(100);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "preferred_contact_method" VARCHAR(20) DEFAULT 'phone';
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "special_instructions" TEXT;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "speaks_languages" VARCHAR(100);
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "can_make_medical_decisions" BOOLEAN DEFAULT false;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "can_pickup_employee" BOOLEAN DEFAULT true;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "has_keys_to_home" BOOLEAN DEFAULT false;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMPTZ;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_emergency_contacts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "relationship" VARCHAR(100);
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(50);
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "birth_date" DATE;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "lives_with_employee" BOOLEAN DEFAULT false;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "is_dependent" BOOLEAN DEFAULT false;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "is_emergency_contact" BOOLEAN DEFAULT false;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "health_insurance_coverage" BOOLEAN DEFAULT false;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_family_members" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "does_regular_exercise" BOOLEAN DEFAULT false;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "exercise_minutes_per_week" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "sedentary_hours_per_day" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "smoking_status" VARCHAR(30);
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "cigarettes_per_day" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "smoking_years" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "quit_date" DATE;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "alcohol_consumption" VARCHAR(30);
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "drinks_per_week" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "diet_type" VARCHAR(50);
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "diet_restrictions" TEXT;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "meals_per_day" INTEGER;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "drinks_water_liters" NUMERIC(3,1);
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "average_sleep_hours" NUMERIC(3,1);
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "sleep_quality" VARCHAR(30);
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "has_sleep_disorders" BOOLEAN DEFAULT false;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "sleep_disorder_details" TEXT;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "stress_level" VARCHAR(30);
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "stress_management_activities" TEXT;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "last_general_checkup" DATE;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "last_dental_checkup" DATE;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "last_vision_checkup" DATE;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "last_gynecological_checkup" DATE;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "last_urological_checkup" DATE;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "last_updated" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_healthy_habits" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(255);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "relationship" VARCHAR(30);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "birth_date" DATE;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "gender" VARCHAR(20);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(20);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "is_dependent" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "is_cohabitant" BOOLEAN DEFAULT true;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "has_disability" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "disability_type" VARCHAR(100);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "has_chronic_illness" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "chronic_illness_notes" TEXT;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "works_externally" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "occupation" VARCHAR(100);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "education_level" VARCHAR(30);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "is_student" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "school_name" VARCHAR(255);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "has_own_health_insurance" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "health_insurance_provider" VARCHAR(100);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "is_covered_by_employee" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "is_life_insurance_beneficiary" BOOLEAN DEFAULT false;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "beneficiary_percentage" NUMERIC(5,2);
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "user_household_members" ADD COLUMN IF NOT EXISTS "updated_by" UUID;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "issue_type" VARCHAR(100);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "issue_subtype" VARCHAR(255);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "case_number" VARCHAR(100);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "court" VARCHAR(255);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "jurisdiction" VARCHAR(255);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "filing_date" DATE;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "resolution_date" DATE;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "last_hearing_date" DATE;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "next_hearing_date" DATE;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "plaintiff" VARCHAR(255);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "defendant" VARCHAR(255);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "outcome" TEXT;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "sentence_details" TEXT;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "fine_amount" NUMERIC(12,2);
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "affects_employment" BOOLEAN DEFAULT false;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "employment_restriction_details" TEXT;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "document_url" TEXT;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "is_confidential" BOOLEAN DEFAULT false;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "is_locked" BOOLEAN DEFAULT false;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "locked_at" TIMESTAMP;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "edit_count" INTEGER DEFAULT 0;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "last_edited_by" UUID;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "last_edited_at" TIMESTAMP;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "is_deleted" BOOLEAN DEFAULT false;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMP;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "deleted_by" UUID;
ALTER TABLE "user_legal_issues" ADD COLUMN IF NOT EXISTS "deletion_reason" TEXT;
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "marital_status" VARCHAR(50);
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "spouse_name" VARCHAR(255);
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "spouse_dni" VARCHAR(50);
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "spouse_phone" VARCHAR(50);
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "spouse_occupation" VARCHAR(255);
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "marriage_date" DATE;
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_marital_status" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(100);
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "document_name" VARCHAR(255);
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "file_url" TEXT;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "upload_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_medical_documents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "exam_type" VARCHAR(100);
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "exam_date" DATE;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "result" VARCHAR(50);
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "observations" TEXT;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "next_exam_date" DATE;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "medical_center" VARCHAR(255);
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "examining_doctor" VARCHAR(255);
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "certificate_url" TEXT;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_medical_exams" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "medication_name" VARCHAR(255);
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "dosage" VARCHAR(100);
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "frequency" VARCHAR(100);
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "route" VARCHAR(50);
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "is_continuous" BOOLEAN DEFAULT false;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "prescribing_doctor" VARCHAR(255);
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "purpose" TEXT;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_medications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "receive_app" BOOLEAN DEFAULT true;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "receive_email" BOOLEAN DEFAULT true;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "receive_push" BOOLEAN DEFAULT true;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "receive_whatsapp" BOOLEAN DEFAULT false;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "receive_sms" BOOLEAN DEFAULT false;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "quiet_hours_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "quiet_hours_start" TIME DEFAULT '22:00:00';
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "quiet_hours_end" TIME DEFAULT '08:00:00';
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "quiet_days" JSONB DEFAULT '[]';
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "daily_digest" BOOLEAN DEFAULT false;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "digest_time" TIME DEFAULT '08:00:00';
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "allow_ai_responses" BOOLEAN DEFAULT true;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "ai_auto_respond_threshold" NUMERIC(3,2) DEFAULT 0.85;
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_notification_preferences" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "base_salary" NUMERIC(15,2);
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "hourly_rate" NUMERIC(10,4);
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "calculation_basis" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "effective_from" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "effective_to" DATE;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "is_current" BOOLEAN DEFAULT true;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "assignment_id" INTEGER;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "salary_type" VARCHAR(20) DEFAULT 'monthly';
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "bank_account_number" VARCHAR(50);
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "bank_account_type" VARCHAR(20);
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(20) DEFAULT 'bank_transfer';
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(20);
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "hire_date" DATE;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "seniority_date" DATE;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "termination_date" DATE;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "work_schedule" JSONB DEFAULT '{"type": "full_time", "days_per_week": 5, "hours_per_week": 40}';
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_payroll_assignment" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "bonus_code" VARCHAR(50);
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "bonus_name" VARCHAR(200);
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "bonus_type" VARCHAR(30);
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "concept_type_id" INTEGER;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "amount" NUMERIC(15,2);
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "percentage" NUMERIC(6,4);
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "percentage_base" VARCHAR(100);
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "frequency" VARCHAR(30) DEFAULT 'monthly';
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "next_payment_date" DATE;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "last_payment_date" DATE;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT false;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "effective_from" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "effective_to" DATE;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "reason_category" VARCHAR(50);
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "reason_detail" TEXT;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "bonus_id" INTEGER;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "is_remunerative" BOOLEAN DEFAULT true;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "is_taxable" BOOLEAN DEFAULT true;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "payment_month" INTEGER;
ALTER TABLE "user_payroll_bonuses" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "assignment_id" INTEGER;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "template_concept_id" INTEGER;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "concept_type_id" INTEGER;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "custom_concept_code" VARCHAR(50);
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "custom_concept_name" VARCHAR(200);
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "override_value" NUMERIC(15,4);
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "override_percentage" NUMERIC(6,4);
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "is_percentage" BOOLEAN DEFAULT false;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "applies_from" DATE;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "applies_to" DATE;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "override_id" INTEGER;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "concept_id" INTEGER;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "override_type" VARCHAR(20) DEFAULT 'replace';
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "fixed_amount" NUMERIC(15,2);
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "percentage_value" NUMERIC(8,4);
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "is_remunerative" BOOLEAN;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "user_payroll_concept_overrides" ADD COLUMN IF NOT EXISTS "effective_to" DATE;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "period_year" INTEGER;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "period_month" INTEGER;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "period_type" VARCHAR(30);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "base_salary" NUMERIC(12,2);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "seniority_bonus" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "presentation_bonus" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "overtime_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "overtime_50_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "overtime_100_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "vacation_days_paid" INTEGER DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "vacation_amount" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "sac_aguinaldo" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "commissions" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "bonuses" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "other_earnings" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "other_earnings_detail" TEXT;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "gross_total" NUMERIC(12,2);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "jubilacion" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "obra_social" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "ley_19032" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "sindicato" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "ganancias" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "other_deductions" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "other_deductions_detail" TEXT;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "deductions_total" NUMERIC(12,2);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "net_salary" NUMERIC(12,2);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "regular_hours_worked" NUMERIC(6,2);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "overtime_50_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "overtime_100_hours" NUMERIC(6,2) DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "total_hours_worked" NUMERIC(6,2);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "days_worked" INTEGER;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "absent_days" INTEGER DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "vacation_days_taken" INTEGER DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "sick_days" INTEGER DEFAULT 0;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "receipt_number" VARCHAR(50);
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "digital_receipt_url" TEXT;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "signed_by_employee" BOOLEAN DEFAULT false;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "signed_date" DATE;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "user_payroll_records" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "request_type" VARCHAR(100);
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "total_days" INTEGER;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pendiente';
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "requested_date" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "approval_date" TIMESTAMP;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "supporting_document_url" TEXT;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_permission_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "module_id" VARCHAR(50);
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "action_id" VARCHAR(100);
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "has_access" BOOLEAN DEFAULT true;
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "granted_by" UUID;
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "granted_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "revoked_at" TIMESTAMPTZ;
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_permissions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "physician_name" VARCHAR(255);
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "specialty" VARCHAR(255);
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "clinic_name" VARCHAR(255);
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "clinic_address" TEXT;
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_primary_physician" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "license_name" VARCHAR(255);
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "profession" VARCHAR(255);
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "license_number" VARCHAR(100);
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "issuing_body" VARCHAR(255);
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "issuing_country" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "jurisdiction" VARCHAR(255);
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "certificate_url" TEXT;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "verification_url" TEXT;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "requires_renewal" BOOLEAN DEFAULT true;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "renewal_frequency" VARCHAR(50);
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "last_renewal_date" DATE;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "is_suspended" BOOLEAN DEFAULT false;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "suspension_start_date" DATE;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "suspension_end_date" DATE;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "suspension_reason" TEXT;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "specializations" TEXT;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "observations" TEXT;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_professional_licenses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "treatment_type" VARCHAR(50);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "condition_treated" VARCHAR(200);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "diagnosis_date" DATE;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "treatment_start_date" DATE;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "treatment_end_date" DATE;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "is_current" BOOLEAN DEFAULT true;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "treating_professional" VARCHAR(200);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "professional_type" VARCHAR(50);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "professional_license" VARCHAR(50);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "professional_phone" VARCHAR(50);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "session_frequency" VARCHAR(50);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "takes_psychiatric_medication" BOOLEAN DEFAULT false;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "medication_details" TEXT;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "medication_side_effects" TEXT;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "affects_work_performance" BOOLEAN DEFAULT false;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "work_accommodations_needed" TEXT;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "emergency_protocol" TEXT;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "hospitalization_history" BOOLEAN DEFAULT false;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "hospitalization_details" TEXT;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "last_crisis_date" DATE;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "crisis_frequency" VARCHAR(50);
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "confidentiality_level" VARCHAR(20) DEFAULT 'restricted';
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_psychiatric_treatments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "role_id" INTEGER;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "scope_override" JSONB;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "valid_from" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "valid_until" DATE;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "is_primary" BOOLEAN DEFAULT false;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "deactivated_at" TIMESTAMP;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "deactivated_by" UUID;
ALTER TABLE "user_role_assignments" ADD COLUMN IF NOT EXISTS "deactivation_reason" TEXT;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "base_salary" NUMERIC(12,2);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "salary_currency" VARCHAR(10) DEFAULT 'ARS';
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "salary_type" VARCHAR(50);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "payment_frequency" VARCHAR(50);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "payment_day" INTEGER;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(255);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "bank_account_number" VARCHAR(100);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "bank_account_type" VARCHAR(50);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(22);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "alias_cbu" VARCHAR(100);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "swift_code" VARCHAR(15);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50) DEFAULT 'transferencia';
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "payment_notes" TEXT;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "bonuses" JSONB;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "allowances" JSONB;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "deductions" JSONB;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "has_obra_social" BOOLEAN DEFAULT true;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "obra_social_deduction" NUMERIC(10,2);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "has_sindicato" BOOLEAN DEFAULT false;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "sindicato_deduction" NUMERIC(10,2);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "tax_withholding_percentage" NUMERIC(5,2);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "has_tax_exemption" BOOLEAN DEFAULT false;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "tax_exemption_reason" TEXT;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "overtime_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "overtime_rate_weekday" NUMERIC(5,2) DEFAULT 1.50;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "overtime_rate_weekend" NUMERIC(5,2) DEFAULT 2.00;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "overtime_rate_holiday" NUMERIC(5,2) DEFAULT 2.00;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "vacation_days_per_year" INTEGER DEFAULT 14;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "vacation_days_used" INTEGER DEFAULT 0;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "vacation_days_pending" INTEGER DEFAULT 14;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "sac_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "sac_calculation_method" VARCHAR(50) DEFAULT 'best_salary';
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "last_salary_review_date" DATE;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "next_salary_review_date" DATE;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "salary_increase_percentage" NUMERIC(5,2);
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "salary_increase_notes" TEXT;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "last_updated_by" UUID;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_salary_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "labor_agreement_id" INTEGER;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "salary_category_id" INTEGER;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "custom_category" VARCHAR(100);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "payment_type" VARCHAR(30);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "base_salary" NUMERIC(12,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "gross_salary" NUMERIC(12,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "net_salary" NUMERIC(12,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(10) DEFAULT 'ARS';
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "seniority_bonus" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "presentation_bonus" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "food_allowance" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "transport_allowance" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "other_bonuses" NUMERIC(12,2) DEFAULT 0;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "other_bonuses_detail" TEXT;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "contracted_hours_per_week" NUMERIC(4,1) DEFAULT 48;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "work_schedule_type" VARCHAR(30);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "hourly_rate" NUMERIC(10,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "overtime_rate_50" NUMERIC(10,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "overtime_rate_100" NUMERIC(10,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "last_salary_update" DATE;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "previous_base_salary" NUMERIC(12,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "salary_increase_percentage" NUMERIC(5,2);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "salary_increase_reason" VARCHAR(200);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "next_review_date" DATE;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "bank_account_type" VARCHAR(30);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "bank_account_number" VARCHAR(50);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "bank_cbu" VARCHAR(30);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "bank_alias" VARCHAR(50);
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "effective_from" DATE;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "effective_to" DATE;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "is_current" BOOLEAN DEFAULT true;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_salary_config_v2" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "shift_id" UUID;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "join_date" DATE;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "assigned_phase" VARCHAR(50);
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "group_name" VARCHAR(255);
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "sector" VARCHAR(100);
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "assigned_by" UUID;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "deactivated_at" TIMESTAMP;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "deactivated_by" UUID;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_shift_assignments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "user_shifts" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_shifts" ADD COLUMN IF NOT EXISTS "shift_id" UUID;
ALTER TABLE "user_shifts" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_shifts" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "sport_catalog_id" INTEGER;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "sport_name" VARCHAR(100);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "practice_level" VARCHAR(30);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "frequency" VARCHAR(30);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "hours_per_week" NUMERIC(4,1);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "years_practicing" INTEGER;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "is_federated" BOOLEAN DEFAULT false;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "federation_name" VARCHAR(200);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "license_number" VARCHAR(50);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "team_club_name" VARCHAR(200);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "participates_in_competitions" BOOLEAN DEFAULT false;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "competition_level" VARCHAR(50);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "competitions_per_year" INTEGER;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "last_competition_date" DATE;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "achievements" TEXT;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "has_coach" BOOLEAN DEFAULT false;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "coach_name" VARCHAR(200);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "training_location" VARCHAR(200);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "medical_clearance_required" BOOLEAN DEFAULT false;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "medical_clearance_date" DATE;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "medical_clearance_expiry" DATE;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "is_extreme_sport" BOOLEAN DEFAULT false;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "insurance_required" BOOLEAN DEFAULT false;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "insurance_company" VARCHAR(200);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "insurance_policy" VARCHAR(100);
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_sports_activities" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "surgery_type" VARCHAR(200);
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "surgery_date" DATE;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "hospital_clinic" VARCHAR(200);
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "surgeon_name" VARCHAR(200);
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "complications" BOOLEAN DEFAULT false;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "complications_details" TEXT;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "recovery_days" INTEGER;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "return_to_work_date" DATE;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "has_permanent_effects" BOOLEAN DEFAULT false;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "permanent_effects_details" TEXT;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "follow_up_required" BOOLEAN DEFAULT false;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "follow_up_frequency" VARCHAR(50);
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "last_follow_up_date" DATE;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "documents_attached" TEXT[];
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_surgeries" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "full_name" TEXT;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "tasks_pending" BIGINT;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "tasks_in_progress" BIGINT;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "tasks_completed" BIGINT;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "tasks_overdue" BIGINT;
ALTER TABLE "user_tasks_summary" ADD COLUMN IF NOT EXISTS "total_tasks" BIGINT;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "union_name" VARCHAR(255);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "union_full_name" VARCHAR(500);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "union_cuit" VARCHAR(15);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "membership_number" VARCHAR(100);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "affiliation_date" DATE;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "resignation_date" DATE;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "delegate_role" VARCHAR(100);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "delegate_start_date" DATE;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "delegate_end_date" DATE;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "section_or_branch" VARCHAR(255);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "workplace_delegate" BOOLEAN DEFAULT false;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "has_fuero_sindical" BOOLEAN DEFAULT false;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "fuero_start_date" DATE;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "fuero_end_date" DATE;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "monthly_dues" NUMERIC(10,2);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "dues_payment_method" VARCHAR(50);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "last_payment_date" DATE;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "union_phone" VARCHAR(50);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "union_email" VARCHAR(255);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "union_address" TEXT;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "union_delegate_contact" VARCHAR(255);
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "membership_card_url" TEXT;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "certificate_url" TEXT;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "benefits" TEXT;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_union_affiliation" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "vaccine_name" VARCHAR(255);
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "vaccine_type" VARCHAR(100);
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "dose_number" INTEGER;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "total_doses" INTEGER;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "date_administered" DATE;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "next_dose_date" DATE;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "administering_institution" VARCHAR(255);
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(100);
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "certificate_url" TEXT;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_vaccinations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "work_arrangement_type_id" INTEGER;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "source" VARCHAR(20) DEFAULT 'manual';
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "effective_from" DATE;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "effective_until" DATE;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "office_days" TEXT[];
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "remote_days" TEXT[];
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "custom_schedule" JSONB;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "requires_webcam_consent" BOOLEAN DEFAULT false;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "approval_reason" TEXT;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "is_contingency_mode" BOOLEAN DEFAULT false;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "contingency_type" VARCHAR(50);
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "contingency_start_date" DATE;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "contingency_end_date" DATE;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "contingency_reason" TEXT;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_work_arrangements" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "position" VARCHAR(255);
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "currently_working" BOOLEAN DEFAULT false;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "reason_for_leaving" TEXT;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "responsibilities" TEXT;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "supervisor_name" VARCHAR(255);
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "supervisor_contact" VARCHAR(100);
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_work_history" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "restriction_type" VARCHAR(100);
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "is_permanent" BOOLEAN DEFAULT false;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "medical_certificate_url" TEXT;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "issuing_doctor" VARCHAR(255);
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "affects_current_role" BOOLEAN DEFAULT false;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "accommodation_needed" TEXT;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "user_work_restrictions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "employeeId" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "firstName" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "lastName" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(20);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "password" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "role" TEXT DEFAULT 'employee';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "position" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "salary" NUMERIC(10,2);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "hireDate" DATE;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "birthDate" DATE;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "emergencyContact" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "emergencyPhone" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "allowOutsideRadius" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "convenioColectivo" VARCHAR(200);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "whatsapp_number" VARCHAR(20);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "accepts_support_packages" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "accepts_auctions" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "accepts_email_notifications" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "accepts_whatsapp_notifications" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "accepts_sms_notifications" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "communication_consent_date" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "global_rating" NUMERIC(3,2);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(22);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "usuario" VARCHAR(50);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "department_id" BIGINT;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "default_branch_id" UUID;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "birth_date" DATE;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "cuil" VARCHAR(15);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "emergency_contact" JSONB;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "work_schedule" JSONB DEFAULT '{}';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "last_login" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "failed_login_attempts" INTEGER DEFAULT 0;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "locked_until" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "password_reset_token" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "password_reset_expires" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "two_factor_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "two_factor_secret" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "permissions" JSONB DEFAULT '{}';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "settings" JSONB DEFAULT '{}';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "has_fingerprint" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "has_facial_data" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_last_updated" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "gps_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "allowed_locations" JSONB DEFAULT '[]';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "concurrent_sessions" INTEGER DEFAULT 0;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "last_activity" TIMESTAMPTZ;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "display_name" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "vendor_code" VARCHAR(20);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_enrolled" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_templates_count" INTEGER DEFAULT 0;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "last_biometric_scan" TIMESTAMP;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_quality_avg" NUMERIC(4,2);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "ai_analysis_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "fatigue_monitoring" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "emotion_monitoring" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_notes" TEXT;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "can_authorize_late_arrivals" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "authorized_departments" JSONB DEFAULT '[]';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "notification_preference_late_arrivals" VARCHAR(20) DEFAULT 'email';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "can_use_mobile_app" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "can_use_kiosk" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "can_use_all_kiosks" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "authorized_kiosks" JSONB DEFAULT '[]';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "has_flexible_schedule" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "flexible_schedule_notes" TEXT;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "legajo" VARCHAR(50);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_photo_url" TEXT;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_photo_date" TIMESTAMP;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "biometric_photo_expiration" TIMESTAMP;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "email_verified" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "email_verified_at" TIMESTAMP;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "pending_consents" TEXT[] DEFAULT '{}';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "verification_pending" BOOLEAN DEFAULT true;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "account_status" TEXT DEFAULT 'pending_verification';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "secondary_phone" VARCHAR(20);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "home_phone" VARCHAR(20);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "province" VARCHAR(100);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "postal_code" VARCHAR(10);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "neighborhood" VARCHAR(100);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "street" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "street_number" VARCHAR(20);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "floor_apt" VARCHAR(20);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "health_insurance_provider" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "health_insurance_plan" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "health_insurance_number" VARCHAR(100);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "health_insurance_expiry" DATE;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "branch_id" UUID;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "additional_roles" JSONB DEFAULT '[]';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "branch_scope" JSONB;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "is_core_user" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "force_password_change" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "password_changed_at" TIMESTAMP;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "core_user_created_at" TIMESTAMP;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "onboarding_trace_id" VARCHAR(100);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "sector_id" INTEGER;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "salary_category_id" INTEGER;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "organizational_position_id" INTEGER;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "street_address" VARCHAR(255);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "country" VARCHAR(100) DEFAULT 'Argentina';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "address_latitude" NUMERIC(10,8);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "address_longitude" NUMERIC(11,8);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "residence_type" VARCHAR(20) DEFAULT 'own';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "housing_type" VARCHAR(20) DEFAULT 'apartment';
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "residence_since" DATE;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "previous_moves_5years" INTEGER DEFAULT 0;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "household_size" INTEGER DEFAULT 1;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "dependents_count" INTEGER DEFAULT 0;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "lives_alone" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "has_vehicle" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "vehicle_type" VARCHAR(50);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "commute_method" VARCHAR(50);
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "commute_time_minutes" INTEGER;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "search_vector" tsvector;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "is_system_user" BOOLEAN DEFAULT false;
ALTER TABLE "users" ADD COLUMN IF NOT EXISTS "is_visible" BOOLEAN DEFAULT true;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(100);
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "discovery_type" VARCHAR(50);
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "discovery_data" JSONB;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "context" VARCHAR(100);
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "screen_location" VARCHAR(100);
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "validation_status" VARCHAR(20) DEFAULT 'discovered';
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "validation_count" INTEGER DEFAULT 1;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "last_seen_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "first_seen_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "works_correctly" BOOLEAN;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "error_details" TEXT;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "test_execution_id" VARCHAR(100);
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "browser_context" JSONB;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "ux_discoveries" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(100);
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "gps_lat" NUMERIC(10,8);
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "gps_lng" NUMERIC(11,8);
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "is_configured" BOOLEAN;
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "company_slug" VARCHAR(255);
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_active_kiosks" ADD COLUMN IF NOT EXISTS "total_attendances" BIGINT;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(200);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "username" VARCHAR(100);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "access_type" VARCHAR(50);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "organization" VARCHAR(200);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "allowed_modules" JSONB;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "permission_level" VARCHAR(20);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "valid_from" TIMESTAMP;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "valid_until" TIMESTAMP;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "first_login_at" TIMESTAMP;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "last_login_at" TIMESTAMP;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "total_logins" INTEGER;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "days_remaining" NUMERIC(12,2);
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "validity_status" TEXT;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_active_temp_accesses" ADD COLUMN IF NOT EXISTS "created_by_email" VARCHAR(255);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "task_code" VARCHAR(50);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "task_type" VARCHAR(50);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "due_date" TIMESTAMP;
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "assigned_role" VARCHAR(50);
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "urgency" TEXT;
ALTER TABLE "v_ai_detectable_violations" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "v_ai_detectable_violations" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "v_ai_detectable_violations" ADD COLUMN IF NOT EXISTS "name_short" VARCHAR(50);
ALTER TABLE "v_ai_detectable_violations" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "v_ai_detectable_violations" ADD COLUMN IF NOT EXISTS "ai_model_tag" VARCHAR(100);
ALTER TABLE "v_ai_detectable_violations" ADD COLUMN IF NOT EXISTS "ai_confidence_threshold" NUMERIC(3,2);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "assignment_id" INTEGER;
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "benefit_name" VARCHAR(150);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "asset_type" VARCHAR(50);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "asset_brand" VARCHAR(100);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "asset_model" VARCHAR(100);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "asset_serial_number" VARCHAR(200);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "asset_plate_number" VARCHAR(20);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "asset_value" NUMERIC(15,2);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "current_value" NUMERIC(15,2);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "assignment_date" DATE;
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "expected_return_date" DATE;
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "actual_return_date" DATE;
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "asset_condition" VARCHAR(30);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "contract_number" VARCHAR(100);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "contract_type" VARCHAR(30);
ALTER TABLE "v_assigned_assets_full" ADD COLUMN IF NOT EXISTS "contract_status" VARCHAR(30);
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "date" DATE;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "check_in" TIMESTAMPTZ;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "check_out" TIMESTAMPTZ;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "checkInMethod" TEXT;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "checkOutMethod" TEXT;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "workingHours" NUMERIC(4,2);
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "status" TEXT;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "branch_id" UUID;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "kiosk_id" INTEGER;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "origin_type" VARCHAR(20);
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "break_out" TIMESTAMP;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "break_in" TIMESTAMP;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_attendances_360" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "application_id" INTEGER;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "job_posting_id" INTEGER;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "job_title" VARCHAR(255);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "department_name" VARCHAR(100);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_first_name" VARCHAR(100);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_last_name" VARCHAR(100);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_full_name" TEXT;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_email" VARCHAR(255);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_phone" VARCHAR(50);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_dni" VARCHAR(20);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_birth_date" DATE;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "candidate_gender" VARCHAR(20);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "admin_approved_at" TIMESTAMPTZ;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "admin_approved_by" UUID;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "notification_sent_to_medical" BOOLEAN;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMPTZ;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "applied_at" TIMESTAMPTZ;
ALTER TABLE "v_candidates_pending_medical" ADD COLUMN IF NOT EXISTS "days_since_approval" NUMERIC(12,2);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "thread_id" UUID;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "company_email" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "direction" VARCHAR(20);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "origin_type" VARCHAR(50);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "origin_name" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(50);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "external_email" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "external_name" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "module" VARCHAR(50);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(100);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "short_message" VARCHAR(280);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "vendor_name" TEXT;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "vendor_email" VARCHAR(255);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "aponnt_department" VARCHAR(50);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "read_at" TIMESTAMP;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "action_status" VARCHAR(50);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "action_deadline" TIMESTAMP;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "response_required_by" TIMESTAMP;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "channels" JSONB;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "sent_via_email" BOOLEAN;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "email_sent_at" TIMESTAMP;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "related_entity_type" VARCHAR(50);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "related_entity_id" VARCHAR(100);
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_commercial_notifications" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(50);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "category" TEXT;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "base_price" NUMERIC(10,2);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "is_core" BOOLEAN;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "display_order" INTEGER;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "features" JSONB;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "requirements" JSONB;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "version" VARCHAR(20);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "min_employees" INTEGER;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "max_employees" INTEGER;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "rubro" VARCHAR(100);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "bundled_modules" JSONB;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "available_in" VARCHAR(20);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "provides_to" JSONB;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "integrates_with" JSONB;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "ui_metadata" JSONB;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "parent_module_key" VARCHAR(100);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "module_type" VARCHAR(20);
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "is_commercializable" BOOLEAN;
ALTER TABLE "v_commercializable_modules" ADD COLUMN IF NOT EXISTS "parent_module_name" VARCHAR(255);
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "config_id" UUID;
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "company_slug" VARCHAR(255);
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "imap_host" VARCHAR(255);
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "imap_port" INTEGER;
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "imap_user" VARCHAR(255);
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "imap_folder" VARCHAR(100);
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "imap_last_poll" TIMESTAMP;
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "imap_last_uid" INTEGER;
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "poll_interval_seconds" INTEGER;
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "smtp_from_email" VARCHAR(255);
ALTER TABLE "v_companies_with_imap" ADD COLUMN IF NOT EXISTS "bidirectional_enabled" BOOLEAN;
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "sender_type" VARCHAR(50);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "recipient_email" VARCHAR(255);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(255);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(50);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "subject" TEXT;
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMP;
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "delivered_at" TIMESTAMP;
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "opened_at" TIMESTAMP;
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "category" VARCHAR(100);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "message_id" VARCHAR(255);
ALTER TABLE "v_company_email_audit" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "v_company_work_arrangements_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_company_work_arrangements_summary" ADD COLUMN IF NOT EXISTS "arrangement_code" VARCHAR(50);
ALTER TABLE "v_company_work_arrangements_summary" ADD COLUMN IF NOT EXISTS "arrangement_name" VARCHAR(100);
ALTER TABLE "v_company_work_arrangements_summary" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "v_company_work_arrangements_summary" ADD COLUMN IF NOT EXISTS "employee_count" BIGINT;
ALTER TABLE "v_company_work_arrangements_summary" ADD COLUMN IF NOT EXISTS "requires_webcam" BOOLEAN;
ALTER TABLE "v_concept_dependencies_summary" ADD COLUMN IF NOT EXISTS "concept_id" INTEGER;
ALTER TABLE "v_concept_dependencies_summary" ADD COLUMN IF NOT EXISTS "concept_name" VARCHAR(200);
ALTER TABLE "v_concept_dependencies_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_concept_dependencies_summary" ADD COLUMN IF NOT EXISTS "total_dependencies" BIGINT;
ALTER TABLE "v_concept_dependencies_summary" ADD COLUMN IF NOT EXISTS "dependencies_list" TEXT;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "type_code" VARCHAR(30);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "type_name" VARCHAR(100);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "classification_code" VARCHAR(30);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "classification_name" VARCHAR(100);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "monetary_sign" INTEGER;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_deduction" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_employer_cost" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_taxable" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_remunerative" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_pre_tax" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_proportional_to_time" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "calculation_base_type" VARCHAR(30);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "default_employee_rate" NUMERIC(8,4);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "default_employer_rate" NUMERIC(8,4);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "rate_ceiling" NUMERIC(15,2);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "icon_name" VARCHAR(50);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "help_tooltip" VARCHAR(200);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "help_detailed" TEXT;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "legal_reference" TEXT;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "names_by_locale" JSONB;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "examples_by_country" JSONB;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "display_order" INTEGER;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "v_concept_types_with_help" ADD COLUMN IF NOT EXISTS "country_name" VARCHAR(100);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(50);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "category" TEXT;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "module_type" VARCHAR(20);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "parent_module_key" VARCHAR(100);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "available_in" VARCHAR(20);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "is_core" BOOLEAN;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "display_order" INTEGER;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "requirements" JSONB;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "features" JSONB;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "base_price" NUMERIC(10,2);
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "integrates_with" JSONB;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "provides_to" JSONB;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "bundled_modules" JSONB;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "is_commercializable" BOOLEAN;
ALTER TABLE "v_dashboard_modules" ADD COLUMN IF NOT EXISTS "parent_module_name" VARCHAR(255);
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "department_id" BIGINT;
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "department_name" VARCHAR(100);
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "users_analyzed" BIGINT;
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "avg_wellness_score" NUMERIC(12,2);
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "avg_fatigue_score" NUMERIC(12,2);
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "avg_stress_score" NUMERIC(12,2);
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "avg_happiness" NUMERIC(12,2);
ALTER TABLE "v_department_wellness" ADD COLUMN IF NOT EXISTS "analysis_date" TIMESTAMPTZ;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "institutional_email" VARCHAR(255);
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "is_verified" BOOLEAN;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "current_daily_count" INTEGER;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "daily_limit" INTEGER;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "current_monthly_count" INTEGER;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "monthly_limit" INTEGER;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "last_error" TEXT;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "error_count" INTEGER;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "total_employee_emails" BIGINT;
ALTER TABLE "v_email_configurations_summary" ADD COLUMN IF NOT EXISTS "emails_sent_today" BIGINT;
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "total_sent" BIGINT;
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "total_delivered" BIGINT;
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "total_bounced" BIGINT;
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "total_opened" BIGINT;
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "delivery_rate" NUMERIC(12,2);
ALTER TABLE "v_email_stats_by_company" ADD COLUMN IF NOT EXISTS "open_rate" NUMERIC(12,2);
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "benefit_code" VARCHAR(50);
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "benefit_name" VARCHAR(150);
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "assigned_amount" NUMERIC(15,2);
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "assigned_quantity" INTEGER;
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "effective_from" DATE;
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "effective_until" DATE;
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "has_required_documents" BOOLEAN;
ALTER TABLE "v_employee_benefits_summary" ADD COLUMN IF NOT EXISTS "expiration_status" TEXT;
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "legajo" VARCHAR(50);
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "active_loans" BIGINT;
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "total_borrowed" NUMERIC(12,2);
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "total_repaid" NUMERIC(12,2);
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "current_debt" NUMERIC(12,2);
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "oldest_loan_date" TIMESTAMP;
ALTER TABLE "v_employee_loan_status" ADD COLUMN IF NOT EXISTS "loans_repaid" BIGINT;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(255);
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "procedure_id" UUID;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "type" VARCHAR(20);
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "version_label" VARCHAR(20);
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "effective_date" DATE;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "is_critical" BOOLEAN;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "acknowledgement_status" VARCHAR(20);
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMP;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "notification_sent_at" TIMESTAMP;
ALTER TABLE "v_employee_procedures" ADD COLUMN IF NOT EXISTS "scope_type" VARCHAR(20);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "entity_code" VARCHAR(30);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "entity_name" VARCHAR(200);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(200);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "flow_direction" VARCHAR(30);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "period_year" INTEGER;
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "period_month" INTEGER;
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "total_employees" INTEGER;
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "total_employer_contribution" NUMERIC(18,2);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "total_employee_contribution" NUMERIC(18,2);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "grand_total" NUMERIC(18,2);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "v_entities_period_summary" ADD COLUMN IF NOT EXISTS "is_paid" BOOLEAN;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "settlement_id" INTEGER;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "entity_code" VARCHAR(30);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "entity_name" VARCHAR(200);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "period_year" INTEGER;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "period_month" INTEGER;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "settlement_code" VARCHAR(50);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "total_employees" INTEGER;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "total_employer_contribution" NUMERIC(18,2);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "total_employee_contribution" NUMERIC(18,2);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "grand_total" NUMERIC(18,2);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "generated_at" TIMESTAMP;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "paid_at" TIMESTAMP;
ALTER TABLE "v_entity_settlements_summary" ADD COLUMN IF NOT EXISTS "payment_reference" VARCHAR(100);
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "employee_email" VARCHAR(255);
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "dependency_name" VARCHAR(150);
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "family_member_name" VARCHAR(150);
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "expiration_date" DATE;
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "days_until_expiration" INTEGER;
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "v_expiring_documents" ADD COLUMN IF NOT EXISTS "notification_days" JSONB;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "alert_type" TEXT;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "employee_name" VARCHAR(255);
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "employee_department" VARCHAR(100);
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "kiosk_name" VARCHAR(100);
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "attempt_type" VARCHAR(255);
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "reason" VARCHAR(255);
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "timestamp" TIMESTAMP;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "requires_hr_review" BOOLEAN;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "reviewed_by" UUID;
ALTER TABLE "v_hr_security_alerts" ADD COLUMN IF NOT EXISTS "reviewed_at" TIMESTAMP;
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "case_number" VARCHAR(50);
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "employee_id" UUID;
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "case_type" VARCHAR(50);
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "reported_violations" TEXT[];
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "correlation_score" NUMERIC(5,2);
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "assigned_to" INTEGER;
ALTER TABLE "v_hse_pending_cases" ADD COLUMN IF NOT EXISTS "days_open" NUMERIC(12,2);
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "total_applications" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "nuevas" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "en_revision" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "en_entrevista" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "aprobadas_admin" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "en_examen_medico" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "aptos" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "contratados" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "rechazados" BIGINT;
ALTER TABLE "v_job_applications_summary" ADD COLUMN IF NOT EXISTS "no_aptos" BIGINT;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "lifecycle_stage" TEXT;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "temperature" TEXT;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "lead_count" BIGINT;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "avg_score" INTEGER;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "avg_bant" INTEGER;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "hot_count" BIGINT;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "warm_count" BIGINT;
ALTER TABLE "v_lead_pipeline" ADD COLUMN IF NOT EXISTS "cold_count" BIGINT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_industry" TEXT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_size" VARCHAR(50);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_employee_count" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_country" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_province" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_city" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_website" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "company_linkedin" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_email" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(50);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_whatsapp" VARCHAR(50);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_job_title" VARCHAR(150);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_department" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_is_decision_maker" BOOLEAN;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contact_linkedin" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "additional_contacts" JSONB;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "lead_source" TEXT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "lead_source_detail" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "utm_source" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "utm_medium" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "utm_campaign" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "referrer_url" VARCHAR(500);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "landing_page" VARCHAR(500);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "assigned_vendor_id" UUID;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "assigned_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "previous_vendor_id" UUID;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "lifecycle_stage" TEXT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "lifecycle_changed_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "lifecycle_history" JSONB;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "temperature" TEXT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "temperature_changed_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "total_score" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "bant_budget" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "bant_authority" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "bant_need" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "bant_timeline" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "bant_notes" JSONB;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "bant_last_updated" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "behavioral_score" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "emails_sent" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "emails_opened" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "emails_clicked" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "website_visits" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "last_website_visit" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "meetings_scheduled" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "meetings_attended" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "meetings_no_show" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "interested_modules" JSONB;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "primary_interest" VARCHAR(100);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "expected_decision_date" DATE;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "budget_available_date" DATE;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "contract_end_current_vendor" DATE;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "current_vendor" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "competitors_evaluating" JSONB;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "is_disqualified" BOOLEAN;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "disqualification_reason" TEXT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "disqualification_notes" TEXT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "disqualified_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "disqualified_by" UUID;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "can_reactivate" BOOLEAN;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "reactivate_after" DATE;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "converted_to_opportunity_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "opportunity_id" UUID;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "converted_to_customer_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "customer_company_id" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "first_activity_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "last_activity_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "days_since_last_activity" INTEGER;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "next_action" VARCHAR(255);
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "next_action_date" DATE;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "v_leads_to_reactivate" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "supplier_business_name" VARCHAR(150);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "supplier_type" VARCHAR(30);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "aponnt_commission_percent" NUMERIC(5,2);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "associate_id" UUID;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "associate_category" TEXT;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "specialty" VARCHAR(200);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "associate_hourly_rate" NUMERIC(10,2);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "rating_average" NUMERIC(3,2);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "rating_count" INTEGER;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "contracts_completed" INTEGER;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "associate_verified" BOOLEAN;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(30);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "bank_account_number" VARCHAR(50);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "bank_account_type" VARCHAR(30);
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "contracted_companies" JSON;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_marketplace_providers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "v_medical_selectable_violations" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "v_medical_selectable_violations" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "v_medical_selectable_violations" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "v_medical_selectable_violations" ADD COLUMN IF NOT EXISTS "name_short" VARCHAR(50);
ALTER TABLE "v_medical_selectable_violations" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "v_medical_selectable_violations" ADD COLUMN IF NOT EXISTS "related_cie10_codes" TEXT[];
ALTER TABLE "v_medical_selectable_violations" ADD COLUMN IF NOT EXISTS "body_locations" TEXT[];
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "module_key" VARCHAR(50);
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "category" TEXT;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "module_type" VARCHAR(20);
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "available_in" VARCHAR(20);
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "is_core" BOOLEAN;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "target_panel" TEXT;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "commercial_type" TEXT;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "show_as_card" BOOLEAN;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "v_modules_by_panel" ADD COLUMN IF NOT EXISTS "display_order" INTEGER;
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(100);
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "pending_responses" BIGINT;
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "overdue_responses" BIGINT;
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "unread_messages" BIGINT;
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "escalated_count" BIGINT;
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "sla_breaches" BIGINT;
ALTER TABLE "v_notification_pending_summary" ADD COLUMN IF NOT EXISTS "last_notification_at" TIMESTAMP;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "candidate_name" TEXT;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "candidate_email" VARCHAR(255);
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "position_title" VARCHAR(255);
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "screening_type_code" VARCHAR(100);
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "screening_type_name" TEXT;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "scheduled_date" TIMESTAMP;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "overall_result" VARCHAR(50);
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(2);
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "approved_for_hiring" BOOLEAN;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_oh_active_screenings" ADD COLUMN IF NOT EXISTS "validity_status" TEXT;
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "partner_id" UUID;
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "partner_name" TEXT;
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "specialty" VARCHAR(100);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "commission_type" VARCHAR(30);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "current_percentage" NUMERIC(5,2);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "cases_this_month" INTEGER;
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "billable_this_month" NUMERIC(12,2);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "commission_this_month" NUMERIC(12,2);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "pending_this_month" NUMERIC(12,2);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "total_pending" NUMERIC(12,2);
ALTER TABLE "v_partner_commission_dashboard" ADD COLUMN IF NOT EXISTS "total_paid" NUMERIC(12,2);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "country_name" VARCHAR(100);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(50);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(200);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "flow_direction" VARCHAR(30);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "icon_name" VARCHAR(50);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "color_hex" VARCHAR(7);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "consolidation_group" VARCHAR(50);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "entity_code" VARCHAR(30);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "entity_name" VARCHAR(200);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "entity_short_name" VARCHAR(50);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(30);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "legal_name" VARCHAR(200);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "bank_cbu" VARCHAR(30);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "presentation_format" VARCHAR(50);
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "is_government" BOOLEAN;
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "is_mandatory" BOOLEAN;
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_payroll_entities_with_category" ADD COLUMN IF NOT EXISTS "settings" JSONB;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "template_code" VARCHAR(30);
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(100);
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "layout_config" JSONB;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "required_fields" JSONB;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "legal_disclaimers" JSONB;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "logo_url" VARCHAR(500);
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "signature_config" JSONB;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "is_system" BOOLEAN;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(3);
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "country_name" VARCHAR(100);
ALTER TABLE "v_payslip_templates_full" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "request_id" UUID;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "legajo" VARCHAR(50);
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "department_name" VARCHAR(100);
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "hours_requested" NUMERIC(6,2);
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "redemption_type" VARCHAR(20);
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "balance_at_request" NUMERIC(8,2);
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "supervisor_name" TEXT;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "supervisor_decision_at" TIMESTAMP;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "supervisor_comments" TEXT;
ALTER TABLE "v_pending_hr_approvals" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMP;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "message_id" VARCHAR(500);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "in_reply_to" VARCHAR(500);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "references_header" TEXT;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "from_email" VARCHAR(255);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "from_name" VARCHAR(255);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "to_email" VARCHAR(255);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "to_name" VARCHAR(255);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "cc_emails" JSONB;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(1000);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "body_text" TEXT;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "body_html" TEXT;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "attachments" JSONB;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "raw_headers" JSONB;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "linked_notification_id" UUID;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "linked_thread_id" UUID;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "linked_group_id" UUID;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "linked_company_id" INTEGER;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "linked_user_id" INTEGER;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "processing_status" VARCHAR(50);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "processing_error" TEXT;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "processed_at" TIMESTAMP;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "created_message_id" UUID;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "response_sent" BOOLEAN;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "response_sent_at" TIMESTAMP;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "email_provider" VARCHAR(50);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "provider_event_id" VARCHAR(255);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "spam_score" NUMERIC(5,2);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "is_auto_reply" BOOLEAN;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "detected_language" VARCHAR(10);
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "v_pending_inbound_emails" ADD COLUMN IF NOT EXISTS "linkage_status" TEXT;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "employee_email" VARCHAR(255);
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "sender_id" UUID;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "sender_name" TEXT;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "subject" VARCHAR(500);
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "communication_type" VARCHAR(20);
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "related_entity_type" VARCHAR(50);
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "related_entity_id" UUID;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "urgency" VARCHAR(20);
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMPTZ;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "response_deadline" TIMESTAMPTZ;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(50);
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "is_overdue" BOOLEAN;
ALTER TABLE "v_pending_medical_acknowledgments" ADD COLUMN IF NOT EXISTS "hours_since_sent" NUMERIC(12,2);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "pre_invoice_code" VARCHAR(50);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "company_slug" VARCHAR(255);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "cliente_razon_social" VARCHAR(255);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "cliente_cuit" VARCHAR(15);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "periodo_desde" DATE;
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "periodo_hasta" DATE;
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "subtotal" NUMERIC(15,2);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "iva_21" NUMERIC(15,2);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "total" NUMERIC(15,2);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "contract_id" UUID;
ALTER TABLE "v_pending_pre_invoices" ADD COLUMN IF NOT EXISTS "contract_number" VARCHAR(50);
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "request_id" UUID;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "legajo" VARCHAR(50);
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "department_name" VARCHAR(100);
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "hours_requested" NUMERIC(6,2);
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "redemption_type" VARCHAR(20);
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "balance_at_request" NUMERIC(8,2);
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMP;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "v_pending_supervisor_approvals" ADD COLUMN IF NOT EXISTS "supervisor_name" TEXT;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "type" VARCHAR(20);
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "hierarchy_level" INTEGER;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "parent_id" UUID;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "parent_code" VARCHAR(50);
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "parent_title" VARCHAR(255);
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "hierarchy_path" TEXT;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "children_count" BIGINT;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "descendants_count" BIGINT;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "icon" TEXT;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "level_name" TEXT;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_procedure_hierarchy" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_company_name" VARCHAR(255);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_company_type" TEXT;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_country" VARCHAR(100);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_province" VARCHAR(100);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_city" VARCHAR(100);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_employee_count" INTEGER;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_phone" VARCHAR(50);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_email" VARCHAR(255);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_website" VARCHAR(255);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "prospect_notes" TEXT;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_date" DATE;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_time" TIME;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_timezone" VARCHAR(50);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_duration_minutes" INTEGER;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_location" VARCHAR(255);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_platform" VARCHAR(100);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_link" VARCHAR(500);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "assigned_vendor_id" UUID;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "created_by_id" UUID;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "supervisor_id" UUID;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "status" TEXT;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "send_reminder_24h" BOOLEAN;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "reminder_sent_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "survey_token" UUID;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "survey_sent_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "survey_deadline" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "pitch_generated_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "pitch_data" JSONB;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "vendor_pitch_data" JSONB;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_started_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "meeting_ended_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "welcome_message_sent_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "feedback_submitted_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "feedback_data" JSONB;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "follow_up_required" BOOLEAN;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "follow_up_type" VARCHAR(50);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "quote_requested" BOOLEAN;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "quote_modules" JSONB;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "satisfaction_sent_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "satisfaction_data" JSONB;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "vendor_name" TEXT;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "vendor_email" VARCHAR(255);
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "attendee_count" BIGINT;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "surveys_completed" BIGINT;
ALTER TABLE "v_sales_meetings_summary" ADD COLUMN IF NOT EXISTS "high_interest_modules" TEXT[];
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "source_system" TEXT;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "lead_id" TEXT;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "contact_email" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "contact_phone" VARCHAR(50);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "industry" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "lead_status" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "seller_id" UUID;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "seller_name" TEXT;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "follow_up_date" DATE;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "follow_up_notes" TEXT;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "campaign_source" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "interaction_count" INTEGER;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "flyer_sent_at" TIMESTAMP;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "flyer_sent_via" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "quote_id" INTEGER;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "quote_number" VARCHAR(50);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "quote_status" VARCHAR(20);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "quote_amount" NUMERIC(10,2);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "has_trial" BOOLEAN;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "quote_sent_date" TIMESTAMP;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "quote_accepted_date" TIMESTAMP;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "contract_id" UUID;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "contract_number" VARCHAR(50);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "contract_status" VARCHAR(50);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "company_created_name" VARCHAR(255);
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "company_active" BOOLEAN;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "company_activated_at" TIMESTAMP;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "pipeline_stage" TEXT;
ALTER TABLE "v_sales_pipeline" ADD COLUMN IF NOT EXISTS "stage_order" INTEGER;
ALTER TABLE "v_sent_notifications_awaiting_response" ADD COLUMN IF NOT EXISTS "employee_id" VARCHAR(100);
ALTER TABLE "v_sent_notifications_awaiting_response" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_sent_notifications_awaiting_response" ADD COLUMN IF NOT EXISTS "awaiting_response" BIGINT;
ALTER TABLE "v_sent_notifications_awaiting_response" ADD COLUMN IF NOT EXISTS "overdue_no_response" BIGINT;
ALTER TABLE "v_sent_notifications_awaiting_response" ADD COLUMN IF NOT EXISTS "escalated_count" BIGINT;
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "staff_id" UUID;
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "role_id" UUID;
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "role_code" VARCHAR(10);
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "role_name" VARCHAR(100);
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "role_default_percentage" NUMERIC(5,2);
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "staff_override_percentage" NUMERIC(5,2);
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "effective_pyramid_percentage" NUMERIC(12,2);
ALTER TABLE "v_staff_pyramid_percentage" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "grant_id" UUID;
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "full_name" VARCHAR(200);
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "username" VARCHAR(100);
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "activity_type" VARCHAR(50);
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "module_accessed" VARCHAR(100);
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_temp_access_recent_activity" ADD COLUMN IF NOT EXISTS "severity" TEXT;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "concept_id" INTEGER;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(200);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "concept_code" VARCHAR(50);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "concept_name" VARCHAR(200);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "short_name" VARCHAR(50);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "calculation_type" VARCHAR(30);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "default_value" NUMERIC(15,4);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "concept_type_code" VARCHAR(30);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "concept_type_name" VARCHAR(100);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "is_deduction" BOOLEAN;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "is_employer_cost" BOOLEAN;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "is_taxable" BOOLEAN;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "affects_gross" BOOLEAN;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_code" VARCHAR(30);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_name" VARCHAR(200);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_category_code" VARCHAR(50);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_category_name" VARCHAR(200);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_flow" VARCHAR(30);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_color" VARCHAR(7);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_label" VARCHAR(100);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "entity_account_code" VARCHAR(50);
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "display_order" INTEGER;
ALTER TABLE "v_template_concepts_with_entity" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "full_name" TEXT;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "address_line1" TEXT;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "neighborhood" VARCHAR(255);
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "city_province" TEXT;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "country" VARCHAR(255);
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "residence_type" VARCHAR(20);
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "housing_type" VARCHAR(20);
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "household_size" INTEGER;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "dependents_count" INTEGER;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "total_household_members" BIGINT;
ALTER TABLE "v_user_socioeconomic_summary" ADD COLUMN IF NOT EXISTS "emergency_contacts_count" BIGINT;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "thread_id" UUID;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "direction" VARCHAR(20);
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "direction_label" TEXT;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(100);
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "trace_id" VARCHAR(100);
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "is_read" BOOLEAN;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "requires_action" BOOLEAN;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "action_status" VARCHAR(50);
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "response_required_by" TIMESTAMP;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "workflow_phase" TEXT;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "budget_code" TEXT;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "contract_code" TEXT;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "invoice_number" TEXT;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "v_vendor_notifications" ADD COLUMN IF NOT EXISTS "unread_in_thread" BIGINT;
ALTER TABLE "v_wellness_trends" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_wellness_trends" ADD COLUMN IF NOT EXISTS "hour_bucket" TIMESTAMPTZ;
ALTER TABLE "v_wellness_trends" ADD COLUMN IF NOT EXISTS "time_of_day" VARCHAR(20);
ALTER TABLE "v_wellness_trends" ADD COLUMN IF NOT EXISTS "scans_count" BIGINT;
ALTER TABLE "v_wellness_trends" ADD COLUMN IF NOT EXISTS "avg_wellness" NUMERIC(12,2);
ALTER TABLE "v_wellness_trends" ADD COLUMN IF NOT EXISTS "avg_fatigue" NUMERIC(12,2);
ALTER TABLE "v_wellness_trends" ADD COLUMN IF NOT EXISTS "avg_stress" NUMERIC(12,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "internal_code" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "barcode" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "supplier_code" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "family_code" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "short_name" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "brand_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "product_type" VARCHAR(20);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "unit_of_measure_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "units_per_pack" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "packaging_type" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "size" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "color" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "flavor" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "weight_net" NUMERIC(12,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "weight_gross" NUMERIC(12,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_weighted" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "barcode_contains_weight" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "barcode_contains_price" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "barcode_article_digits" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "barcode_value_digits" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "barcode_value_decimals" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_perishable" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "shelf_life_days" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "requires_batch_tracking" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "requires_cold_chain" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "storage_temperature_min" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "storage_temperature_max" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_sellable" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_purchasable" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "allows_discount" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "allows_returns" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "commission_percent" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_kit" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "parent_product_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "length_cm" NUMERIC(10,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "width_cm" NUMERIC(10,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(10,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "volume_cm3" NUMERIC(15,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "stacking_limit" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_price_locked" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "price_lock_expires_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "price_lock_reason" VARCHAR(200);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_blocked" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "blocked_reason" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "image_url" VARCHAR(500);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "thumbnail_url" VARCHAR(500);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_catch_weight" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "nominal_weight" NUMERIC(15,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_serialized" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "volume_m3" NUMERIC(10,6);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "requires_expiry_control" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "expiry_alert_days" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "gondola_section" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "shelf_level" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "facing_count" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "shelf_depth_units" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "display_type" VARCHAR(30);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(12,3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(12,3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(12,3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "min_order_qty" NUMERIC(12,3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "order_multiple" NUMERIC(12,3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "lead_time_days" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_seasonal" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "season_start_month" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "season_end_month" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "seasonality_factor" JSONB;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "abc_class" character;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "xyz_class" character;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "abc_xyz_last_calculated" TIMESTAMPTZ;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "avg_daily_sales" NUMERIC(12,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "sales_velocity" NUMERIC(10,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "days_of_supply" NUMERIC(10,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "stockout_probability" NUMERIC(5,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "iva_type" VARCHAR(20);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "iva_rate" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "internal_tax_rate" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "perception_iva_rate" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "perception_iibb_rate" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "ncm_code" VARCHAR(20);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "hs_code" VARCHAR(20);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "country_of_origin" VARCHAR(3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "customs_tariff_rate" NUMERIC(6,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "manufacturer_name" VARCHAR(200);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "manufacturer_code" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "alternate_part_number" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "oem_code" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "certifications" JSONB;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "quality_inspection_required" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "quality_inspection_type" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "quality_inspection_frequency" VARCHAR(20);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "quality_hold_days" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "handling_instructions" TEXT;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "storage_zone_type" VARCHAR(30);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_hazardous" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "hazmat_class" VARCHAR(20);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "hazmat_un_number" VARCHAR(10);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "hazmat_packing_group" VARCHAR(10);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "requires_fifo" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "requires_fefo" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "shelf_life_percent_for_receipt" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "is_critical" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "criticality_level" VARCHAR(10);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "economic_order_qty" NUMERIC(15,3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "reorder_qty" NUMERIC(15,3);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "purchasing_cycle_days" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "preferred_supplier_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "alternate_supplier_ids" TEXT[];
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "last_purchase_date" DATE;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "last_purchase_price" NUMERIC(15,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "avg_purchase_price" NUMERIC(15,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "sales_unit_measure_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "conversion_factor" NUMERIC(15,6);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "suggested_retail_price" NUMERIC(15,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "minimum_sale_price" NUMERIC(15,4);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "target_margin_percent" NUMERIC(5,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "allows_fractional_sales" BOOLEAN;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "lifecycle_status" VARCHAR(20);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "phase_out_date" DATE;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "replacement_product_id" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "last_sale_date" DATE;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "days_without_movement" INTEGER;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "tags" VARCHAR(500);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "keywords" TEXT;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "custom_attributes" JSONB;
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "brand_name" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "supplier_name" VARCHAR(150);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "unit_code" VARCHAR(10);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "unit_name" VARCHAR(50);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "preferred_supplier_name" VARCHAR(150);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "sales_unit_code" VARCHAR(10);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "warehouse_type_name" VARCHAR(100);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "total_stock_qty" NUMERIC(12,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "total_stock_value" NUMERIC(12,2);
ALTER TABLE "v_wms_products_complete" ADD COLUMN IF NOT EXISTS "warehouses_with_stock" BIGINT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "request_number" VARCHAR(50);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "requested_by" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "requester_department_id" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "requester_name" VARCHAR(200);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "requester_position" VARCHAR(200);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "destination_type" VARCHAR(30);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "destination_warehouse_id" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "destination_department_id" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "destination_employee_id" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "destination_project_code" VARCHAR(50);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "destination_notes" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "source_warehouse_id" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "request_date" DATE;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "required_date" DATE;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "required_time" TIME;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "urgency_level" VARCHAR(20);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "approval_notes" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "rejected_by" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "reservation_status" VARCHAR(30);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "reserved_by" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "reserved_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "reservation_notes" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "prepared_by" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "prepared_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "dispatched_by" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "dispatched_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "received_by" UUID;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "reception_notes" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "generated_document_type" VARCHAR(30);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "generated_document_id" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "purpose" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "cost_center" VARCHAR(50);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "project_code" VARCHAR(50);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "priority_score" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "total_lines" INTEGER;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(15,4);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "estimated_value" NUMERIC(15,2);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "notifications_sent" JSONB;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "purchase_request_generated" BOOLEAN;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "purchase_request_ids" JSONB;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "requester_email" VARCHAR(255);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "urgency_status" TEXT;
ALTER TABLE "v_wms_requests_due_alerts" ADD COLUMN IF NOT EXISTS "days_until_due" INTEGER;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "vacation_interruptible" BOOLEAN DEFAULT true;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "min_continuous_days" INTEGER DEFAULT 7;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "max_fractions" INTEGER DEFAULT 3;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "auto_scheduling_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "min_advance_notice_days" INTEGER DEFAULT 15;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "max_simultaneous_percentage" INTEGER DEFAULT 30;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "vacation_configurations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "request_type" VARCHAR(50) DEFAULT 'vacation';
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "extraordinary_license_id" INTEGER;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "total_days" INTEGER;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'pending';
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "approval_date" TIMESTAMPTZ;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "approval_comments" TEXT;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50) DEFAULT 'manual';
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "coverage_assignments" JSONB DEFAULT '[]';
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "supporting_documents" JSONB DEFAULT '[]';
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "is_auto_generated" BOOLEAN DEFAULT false;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "auto_generation_data" JSONB;
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "compatibility_score" NUMERIC(5,2);
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "conflicts" JSONB DEFAULT '[]';
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "modification_history" JSONB DEFAULT '[]';
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vacation_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "years_from" NUMERIC(4,2);
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "years_to" NUMERIC(4,2);
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "range_description" VARCHAR(100);
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "vacation_days" INTEGER;
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 0;
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "vacation_scales" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "commission_type" VARCHAR(20);
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "percentage" NUMERIC(5,2);
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "monthly_amount" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "is_transferable" BOOLEAN DEFAULT false;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "original_vendor_id" UUID;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "transferred_date" TIMESTAMPTZ;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "transfer_reason" TEXT;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "referral_id" BIGINT;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "base_commission_amount" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "total_users" INTEGER DEFAULT 0;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "start_date" DATE;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "end_date" DATE;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "last_calculated" TIMESTAMPTZ;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vendor_commissions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "rating" NUMERIC(3,2);
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "response_time_score" NUMERIC(3,2) DEFAULT 5.0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "resolution_quality_score" NUMERIC(3,2) DEFAULT 5.0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "customer_satisfaction_score" NUMERIC(3,2) DEFAULT 5.0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "total_tickets" INTEGER DEFAULT 0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "resolved_tickets" INTEGER DEFAULT 0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "avg_response_time" INTEGER DEFAULT 0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "avg_resolution_time" INTEGER DEFAULT 0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "last_review_date" TIMESTAMPTZ;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "improvement_plan" TEXT;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "is_under_review" BOOLEAN DEFAULT false;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "review_notes" TEXT;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "responseTimeScore" NUMERIC(3,2) DEFAULT 5;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "resolutionQualityScore" NUMERIC(3,2) DEFAULT 5;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "customerSatisfactionScore" NUMERIC(3,2) DEFAULT 5;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "totalTickets" INTEGER DEFAULT 0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "resolvedTickets" INTEGER DEFAULT 0;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "averageResponseTimeMinutes" INTEGER;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "averageResolutionTimeHours" NUMERIC(8,2);
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "reviewStartDate" TIMESTAMP;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "improvementPlan" TEXT;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMP;
ALTER TABLE "vendor_ratings" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMP;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "id" BIGINT;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "referrer_id" UUID;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "referred_id" UUID;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "referral_code" VARCHAR(50);
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "level" INTEGER DEFAULT 1;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "commission_percentage" NUMERIC(5,2) DEFAULT 5.0;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "total_commission_earned" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "activation_date" TIMESTAMPTZ;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "last_commission_date" TIMESTAMPTZ;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "referrerId" INTEGER;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "referredId" INTEGER;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "activationDate" TIMESTAMP;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "commissionPercentage" NUMERIC(5,2) DEFAULT 5;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "totalCommissionEarned" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "monthlyCommissionEarned" NUMERIC(10,2) DEFAULT 0;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "lastCommissionDate" TIMESTAMP;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "contractStartDate" TIMESTAMP;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "contractEndDate" TIMESTAMP;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "referralCode" VARCHAR(20);
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "createdAt" TIMESTAMP;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "updatedAt" TIMESTAMP;
ALTER TABLE "vendor_referrals" ADD COLUMN IF NOT EXISTS "deletedAt" TIMESTAMP;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "vendor_id" UUID;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "total_companies" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "sales_companies" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "support_companies" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "total_users" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "sales_users" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "support_users" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "sales_commission_percentage" NUMERIC(5,2) DEFAULT 10.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "total_sales_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "monthly_sales_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "support_commission_percentage" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "total_support_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "monthly_support_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "total_referrals" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "referral_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "grand_total_commission_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "total_modules_value_usd" NUMERIC(12,2) DEFAULT 0.00;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "rating" NUMERIC(3,1) DEFAULT 0.0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "total_ratings" INTEGER DEFAULT 0;
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "cbu" VARCHAR(22);
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "last_updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "vendor_statistics" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "total_visitors" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "pending_count" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "authorized_count" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "rejected_count" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "completed_count" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "currently_inside" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "vip_count" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "contractor_count" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "gps_enabled_count" BIGINT;
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "avg_visit_duration_minutes" NUMERIC(12,2);
ALTER TABLE "visitor_analytics_by_company" ADD COLUMN IF NOT EXISTS "last_visitor_created_at" TIMESTAMPTZ;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "visitor_id" INTEGER;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "latitude" NUMERIC(10,8);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "longitude" NUMERIC(11,8);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "accuracy" NUMERIC(6,2);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "recorded_at" TIMESTAMPTZ;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "is_inside_facility" BOOLEAN DEFAULT true;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "distance_from_center_meters" NUMERIC(10,2);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "battery_level" INTEGER;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "signal_strength" INTEGER;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "gps_lat" NUMERIC(10,8);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "gps_lng" NUMERIC(11,8);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "altitude" NUMERIC(8,2);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "speed" NUMERIC(6,2);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "distance_from_facility" NUMERIC(10,2);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "alert_generated" BOOLEAN DEFAULT false;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "alert_type" VARCHAR(255);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "alert_message" TEXT;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "area_id" INTEGER;
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "area_name" VARCHAR(100);
ALTER TABLE "visitor_gps_tracking" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(100);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "dni" VARCHAR(20);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "first_name" VARCHAR(100);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "last_name" VARCHAR(100);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "email" VARCHAR(255);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(20);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "visit_reason" TEXT;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "visiting_department_id" INTEGER;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "responsible_employee_id" UUID;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "authorization_status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "authorized_by" UUID;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "authorized_at" TIMESTAMPTZ;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "gps_tracking_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "keyring_id" VARCHAR(50);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "facial_template" TEXT;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "photo_url" TEXT;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "check_in" TIMESTAMPTZ;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "check_out" TIMESTAMPTZ;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "kiosk_id" INTEGER;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "scheduled_visit_date" TIMESTAMPTZ;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "expected_duration_minutes" INTEGER DEFAULT 60;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "deleted_at" TIMESTAMPTZ;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "visitor_category" VARCHAR(50) DEFAULT 'standard';
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "badge_number" VARCHAR(50);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "security_clearance_level" INTEGER DEFAULT 1;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "audit_reason" TEXT;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "audit_ip_address" VARCHAR(45);
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "audit_user_agent" TEXT;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "status_updated_at" TIMESTAMP;
ALTER TABLE "visitors" ADD COLUMN IF NOT EXISTS "status_updated_by" UUID;
ALTER TABLE "voice_gamification_config" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "voice_gamification_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "voice_gamification_config" ADD COLUMN IF NOT EXISTS "config_key" VARCHAR(100);
ALTER TABLE "voice_gamification_config" ADD COLUMN IF NOT EXISTS "config_value" JSONB;
ALTER TABLE "voice_gamification_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "voice_gamification_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "id" UUID DEFAULT gen_random_uuid();
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "total_points" INTEGER DEFAULT 0;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "current_level" VARCHAR(20) DEFAULT 'BRONZE';
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "badges" JSONB DEFAULT '[]';
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "suggestions_submitted" INTEGER DEFAULT 0;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "suggestions_approved" INTEGER DEFAULT 0;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "suggestions_implemented" INTEGER DEFAULT 0;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "upvotes_received" INTEGER DEFAULT 0;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "downvotes_received" INTEGER DEFAULT 0;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "comments_made" INTEGER DEFAULT 0;
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "voice_user_stats" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT now();
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "task_type" VARCHAR(100);
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "title" VARCHAR(255);
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20);
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "due_date" DATE;
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP;
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "company_slug" VARCHAR(255);
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "assigned_to_name" TEXT;
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "days_pending" INTEGER;
ALTER TABLE "vw_admin_tasks_dashboard" ADD COLUMN IF NOT EXISTS "is_overdue" BOOLEAN;
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "id" UUID;
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "payment_code" VARCHAR(50);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "commission_type" VARCHAR(50);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "net_amount" NUMERIC(12,2);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "payment_method" VARCHAR(50);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "vendor_name" TEXT;
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "vendor_email" VARCHAR(255);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "liquidation_code" VARCHAR(50);
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "vw_commission_payments_dashboard" ADD COLUMN IF NOT EXISTS "executed_date" DATE;
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "liquidation_id" UUID;
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "liquidation_code" VARCHAR(50);
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "liquidation_type" VARCHAR(50);
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "liquidation_date" DATE;
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50);
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "total_commission_amount" NUMERIC(12,2);
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "company_slug" VARCHAR(255);
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "invoice_number" TEXT;
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "payment_scheduled_date" DATE;
ALTER TABLE "vw_commissions_dashboard" ADD COLUMN IF NOT EXISTS "vendor_count" INTEGER;
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "branch_id" UUID;
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "department_id" BIGINT;
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "user_name" TEXT;
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "legajo" VARCHAR(255);
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "hours_accrued" NUMERIC(12,2);
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "hours_used" NUMERIC(12,2);
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "overtime_to_bank" NUMERIC(12,2);
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "overtime_to_pay" NUMERIC(12,2);
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "bank_ratio_pct" NUMERIC(12,2);
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "decisions_pending" BIGINT;
ALTER TABLE "vw_hour_bank_drilldown" ADD COLUMN IF NOT EXISTS "current_balance" NUMERIC(12,2);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "run_id" INTEGER;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "run_code" VARCHAR(50);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "period_year" INTEGER;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "period_month" INTEGER;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "payment_date" DATE;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "employee_code" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "document_number" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "position_name" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "position_code" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "department_name" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "branch_name" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "template_name" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "category_name" TEXT;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "base_salary_at_time" NUMERIC(12,2);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "seniority_at_time" INTEGER;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "gross_earnings" NUMERIC(15,2);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "total_deductions" NUMERIC(15,2);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "net_salary" NUMERIC(15,2);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "employer_contributions" NUMERIC(15,2);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "receipt_number" VARCHAR(50);
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "receipt_generated_at" TIMESTAMP;
ALTER TABLE "vw_payroll_historical_details" ADD COLUMN IF NOT EXISTS "liquidation_date" TIMESTAMP;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "position_code" VARCHAR(30);
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "position_name" VARCHAR(100);
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "parent_position_id" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "level_order" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "salary_category_id" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "payslip_template_id" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "payroll_template_id" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "template_name" VARCHAR(100);
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "template_code" VARCHAR(30);
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "vw_positions_with_templates" ADD COLUMN IF NOT EXISTS "parent_position_name" VARCHAR(100);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "employee_name" TEXT;
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "user_branch_uuid" UUID;
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "agreement_code" VARCHAR(20);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "agreement_name" VARCHAR(300);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "category_code" VARCHAR(20);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(200);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "category_base_salary" NUMERIC(12,2);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "user_base_salary" NUMERIC(12,2);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "gross_salary" NUMERIC(12,2);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "hourly_rate" NUMERIC(10,2);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "overtime_rate_50" NUMERIC(10,2);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "overtime_rate_100" NUMERIC(10,2);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(10);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "effective_from" DATE;
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "last_salary_update" DATE;
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "last_increase_pct" NUMERIC(5,2);
ALTER TABLE "vw_user_salary_complete" ADD COLUMN IF NOT EXISTS "is_current" BOOLEAN;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "consent_version" VARCHAR(20) DEFAULT '1.0';
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "consent_type" VARCHAR(50) DEFAULT 'remote_webcam_monitoring';
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "consented_at" TIMESTAMP;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "consent_ip_address" VARCHAR(45);
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "consent_user_agent" TEXT;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "declined_at" TIMESTAMP;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "decline_reason" TEXT;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "revoked_at" TIMESTAMP;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "revoke_reason" TEXT;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "alternative_method" VARCHAR(50);
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "country_code" VARCHAR(10);
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "legal_framework" VARCHAR(100);
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "full_text_hash" VARCHAR(64);
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "signature_data" TEXT;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "webcam_monitoring_consents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "abc_class" character;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "value_percentage" NUMERIC(5,2);
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "xyz_class" character;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "demand_cv" NUMERIC(10,4);
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "combined_class" VARCHAR(2);
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "recommended_reorder_policy" VARCHAR(30);
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "recommended_safety_stock" NUMERIC(15,4);
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "analysis_date" DATE;
ALTER TABLE "wms_abc_classification" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "recall_number" VARCHAR(50);
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "recall_type" VARCHAR(30);
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "severity_level" VARCHAR(20);
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "affected_batches" TEXT[];
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "total_units_affected" INTEGER;
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "total_units_recovered" INTEGER;
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "recovery_percentage" NUMERIC(5,2);
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "initiated_at" TIMESTAMP;
ALTER TABLE "wms_active_recalls" ADD COLUMN IF NOT EXISTS "initiated_by_name" TEXT;
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "adjustment_type" VARCHAR(20);
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT true;
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_adjustment_reasons" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "anomaly_type" VARCHAR(50);
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20) DEFAULT 'MEDIUM';
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "stock_quantity" NUMERIC(15,4);
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "stock_value" NUMERIC(15,2);
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "potential_loss" NUMERIC(15,2);
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "holding_cost_monthly" NUMERIC(15,2);
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'OPEN';
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "recommended_action" VARCHAR(50);
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "detected_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "resolved_at" TIMESTAMPTZ;
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "resolution_notes" TEXT;
ALTER TABLE "wms_anomaly_alerts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "workflow_code" VARCHAR(30);
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(50);
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "min_amount" NUMERIC(15,2);
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "approval_levels" JSONB;
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "require_all_levels" BOOLEAN DEFAULT false;
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_approval_workflows" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "sku" VARCHAR(50);
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "quantity_on_hand" NUMERIC(15,4);
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "unit_cost" INTEGER;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "stock_value" INTEGER;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "last_movement_date" TIMESTAMPTZ;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "days_since_movement" INTEGER;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "risk_category" TEXT;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "abc_class" character;
ALTER TABLE "wms_at_risk_inventory" ADD COLUMN IF NOT EXISTS "xyz_class" character;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "delegator_id" UUID;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "delegate_id" UUID;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "operation_types" TEXT[];
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "valid_from" TIMESTAMP;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "valid_until" TIMESTAMP;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "revoked_at" TIMESTAMP;
ALTER TABLE "wms_authorization_delegations" ADD COLUMN IF NOT EXISTS "revoked_by" UUID;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "request_id" INTEGER;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "approval_level" INTEGER;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "action" VARCHAR(20);
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "action_by" UUID;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "action_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "role_at_action" VARCHAR(100);
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "comments" TEXT;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "digital_signature" TEXT;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "signature_timestamp" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_authorization_history" ADD COLUMN IF NOT EXISTS "snapshot_data" JSONB;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "role_name" VARCHAR(100);
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "operation_type" VARCHAR(50);
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "min_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "max_amount" NUMERIC(15,2);
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "min_quantity" INTEGER DEFAULT 0;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "max_quantity" INTEGER;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "can_self_approve" BOOLEAN DEFAULT false;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "requires_dual_approval" BOOLEAN DEFAULT false;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "escalation_hours" INTEGER DEFAULT 24;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "escalation_role" VARCHAR(100);
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_authorization_levels" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "request_number" VARCHAR(50);
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "operation_type" VARCHAR(50);
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(50);
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "reference_id" INTEGER;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "requested_by" UUID;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2);
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "total_quantity" INTEGER;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "justification" TEXT;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "urgency_level" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "current_level" INTEGER DEFAULT 1;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "required_levels" INTEGER DEFAULT 1;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "final_decision_at" TIMESTAMP;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "final_decision_by" UUID;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_authorization_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "config_name" VARCHAR(50);
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "total_digits" INTEGER DEFAULT 13;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "prefix_start" INTEGER DEFAULT 1;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "prefix_digits" INTEGER DEFAULT 2;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "prefix_values" VARCHAR(100);
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "article_start" INTEGER;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "article_digits" INTEGER;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "value_start" INTEGER;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "value_digits" INTEGER;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "value_decimals" INTEGER DEFAULT 3;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "value_type" VARCHAR(20);
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "has_checksum" BOOLEAN DEFAULT true;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "checksum_position" INTEGER;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_barcode_configs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "tax_template_id" INTEGER;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "default_currency_id" INTEGER;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "state_province" VARCHAR(100);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "postal_code" VARCHAR(20);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "email" VARCHAR(100);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "manager_name" VARCHAR(100);
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(50) DEFAULT 'America/Argentina/Buenos_Aires';
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "is_headquarters" BOOLEAN DEFAULT false;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_branches" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "logo_url" VARCHAR(500);
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "website" VARCHAR(200);
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "is_own_brand" BOOLEAN DEFAULT false;
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_brands" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "code" VARCHAR(30);
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "parent_id" INTEGER;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "level" INTEGER DEFAULT 1;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "full_path" VARCHAR(500);
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "default_tax_rate_id" INTEGER;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "default_margin_percent" NUMERIC(10,4);
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(50);
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "color" VARCHAR(7);
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_categories" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "zone_id" INTEGER;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "incident_number" VARCHAR(50);
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "incident_type" VARCHAR(50);
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "severity" VARCHAR(20);
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "detected_at" TIMESTAMP;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "duration_minutes" INTEGER;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "min_temp_recorded" NUMERIC(10,2);
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "max_temp_recorded" NUMERIC(10,2);
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "affected_products" JSONB;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "root_cause" TEXT;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "immediate_actions" TEXT;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "product_disposition" VARCHAR(50);
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "quality_assessment" TEXT;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "reported_by" UUID;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "investigated_by" UUID;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "investigation_completed_at" TIMESTAMP;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'open';
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cold_chain_incidents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "zone_id" INTEGER;
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "zone_name" VARCHAR(100);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "branch_name" VARCHAR(100);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "parameter_type" VARCHAR(50);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "min_value" NUMERIC(10,2);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "max_value" NUMERIC(10,2);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "unit" VARCHAR(20);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "last_reading" NUMERIC(10,2);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "last_reading_at" TIMESTAMP;
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "alert_level" VARCHAR(20);
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "is_within_range" BOOLEAN;
ALTER TABLE "wms_cold_chain_status" ADD COLUMN IF NOT EXISTS "open_incidents" BIGINT;
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "code" VARCHAR(3);
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "default_currency_id" INTEGER;
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "phone_code" VARCHAR(5);
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "date_format" VARCHAR(20) DEFAULT 'DD/MM/YYYY';
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_countries" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "sku" VARCHAR(50);
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "quantity_on_hand" NUMERIC(15,4);
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(15,4);
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(15,4);
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "stock_status" TEXT;
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "nearest_expiry" DATE;
ALTER TABLE "wms_critical_stock_dashboard" ADD COLUMN IF NOT EXISTS "days_to_expiry" INTEGER;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "operation_id" INTEGER;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "received_quantity" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "shipped_quantity" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "destination_customer" VARCHAR(200);
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "destination_address" TEXT;
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_cross_dock_lines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "operation_number" VARCHAR(50);
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "receiving_dock_id" INTEGER;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "shipping_dock_id" INTEGER;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'planned';
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "inbound_reference" VARCHAR(100);
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "outbound_reference" VARCHAR(100);
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "expected_arrival" TIMESTAMP;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "actual_arrival" TIMESTAMP;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "expected_departure" TIMESTAMP;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "actual_departure" TIMESTAMP;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 5;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "special_handling_instructions" TEXT;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cross_dock_operations" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "code" VARCHAR(3);
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "name" VARCHAR(50);
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "symbol" VARCHAR(5);
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "decimal_places" INTEGER DEFAULT 2;
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "thousand_separator" VARCHAR(1) DEFAULT '.';
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "decimal_separator" VARCHAR(1) DEFAULT ',';
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_currencies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "count_id" INTEGER;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "expected_quantity" NUMERIC(15,4);
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "counted_quantity" NUMERIC(15,4);
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "variance" NUMERIC(15,4);
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "variance_percentage" NUMERIC(5,2);
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "counted_at" TIMESTAMP;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "adjustment_type" VARCHAR(20);
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "adjustment_reason" TEXT;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "investigation_notes" TEXT;
ALTER TABLE "wms_cycle_count_lines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "count_frequency" VARCHAR(20);
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "abc_class_filter" TEXT[];
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "zone_filter" TEXT[];
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "last_run_at" TIMESTAMP;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "next_run_at" TIMESTAMP;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "tolerance_percentage" NUMERIC(5,2) DEFAULT 2.00;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "auto_adjust_small_variances" BOOLEAN DEFAULT false;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cycle_count_plans" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "plan_id" INTEGER;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "count_number" VARCHAR(50);
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "scheduled_date" DATE;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMP;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "counted_by" UUID;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "total_items" INTEGER DEFAULT 0;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "items_counted" INTEGER DEFAULT 0;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "discrepancies_found" INTEGER DEFAULT 0;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "discrepancies_resolved" INTEGER DEFAULT 0;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_cycle_counts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "delivery_note_id" INTEGER;
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "quantity_delivered" NUMERIC(15,4);
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "quantity_returned" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "serial_numbers" TEXT[];
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_delivery_note_lines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "delivery_number" VARCHAR(50);
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "source_warehouse_id" INTEGER;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "material_request_id" INTEGER;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "recipient_type" VARCHAR(30);
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "recipient_user_id" UUID;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "recipient_department_id" INTEGER;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "recipient_name" VARCHAR(200);
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "recipient_position" VARCHAR(200);
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "signed_by" UUID;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "signed_at" TIMESTAMPTZ;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "signature_data" TEXT;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "is_returnable" BOOLEAN DEFAULT false;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "return_due_date" DATE;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "return_status" VARCHAR(20);
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_delivery_notes" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "forecast_method" VARCHAR(50);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "period_type" VARCHAR(10);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "forecast_quantity" NUMERIC(15,4);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "confidence_level" NUMERIC(5,2);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "lower_bound" NUMERIC(15,4);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "upper_bound" NUMERIC(15,4);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "actual_quantity" NUMERIC(15,4);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "forecast_error" NUMERIC(15,4);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "mape" NUMERIC(5,2);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "generated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "generated_by" VARCHAR(50);
ALTER TABLE "wms_demand_forecasts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "period_type" VARCHAR(10);
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "actual_demand" NUMERIC(15,4);
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "units_sold" NUMERIC(15,4);
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "revenue" NUMERIC(15,2);
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "num_transactions" INTEGER;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "avg_transaction_size" NUMERIC(15,4);
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "stockout_days" INTEGER DEFAULT 0;
ALTER TABLE "wms_demand_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(50);
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "signer_id" UUID;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "signer_name" VARCHAR(200);
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "signer_role" VARCHAR(100);
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "signed_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "signature_hash" VARCHAR(128);
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "previous_hash" VARCHAR(128);
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "data_snapshot" JSONB;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "user_agent" TEXT;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "certificate_id" VARCHAR(200);
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "verification_url" TEXT;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "is_valid" BOOLEAN DEFAULT true;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "invalidated_reason" TEXT;
ALTER TABLE "wms_digital_signatures" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "appointment_number" VARCHAR(30);
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "appointment_type" VARCHAR(20);
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "dock_id" INTEGER;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "scheduled_arrival" TIMESTAMPTZ;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "scheduled_departure" TIMESTAMPTZ;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "duration_minutes" INTEGER DEFAULT 60;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "carrier_name" VARCHAR(200);
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "driver_name" VARCHAR(200);
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "vehicle_plate" VARCHAR(20);
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "expected_pallets" INTEGER;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "expected_weight" NUMERIC(15,4);
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'SCHEDULED';
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "check_in_at" TIMESTAMPTZ;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMPTZ;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "actual_pallets" INTEGER;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_dock_appointments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "dock_number" VARCHAR(20);
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "dock_type" VARCHAR(20);
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "height_cm" INTEGER;
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "width_cm" INTEGER;
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "is_refrigerated" BOOLEAN DEFAULT false;
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'AVAILABLE';
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_docks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "document_id" INTEGER;
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "link_type" VARCHAR(50);
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "is_required" BOOLEAN DEFAULT false;
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "linked_by" UUID;
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "linked_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_document_links" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "required_for" TEXT[];
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "retention_years" INTEGER DEFAULT 7;
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT false;
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "template_url" TEXT;
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_document_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "document_type_id" INTEGER;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(100);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "title" VARCHAR(500);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "file_path" TEXT;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "file_name" VARCHAR(500);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "file_size" INTEGER;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "mime_type" VARCHAR(100);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "file_hash" VARCHAR(128);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "external_reference" VARCHAR(200);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "issue_date" DATE;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "issuer_name" VARCHAR(200);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "issuer_tax_id" VARCHAR(50);
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "version" INTEGER DEFAULT 1;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "parent_document_id" INTEGER;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "uploaded_by" UUID;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "uploaded_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "verified_by" UUID;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "verified_at" TIMESTAMP;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "archived_at" TIMESTAMP;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "retention_until" DATE;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_documents" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "zone_id" INTEGER;
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "parameter_type" VARCHAR(50);
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "min_value" NUMERIC(10,2);
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "max_value" NUMERIC(10,2);
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "unit" VARCHAR(20);
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "alert_threshold_warning" NUMERIC(10,2);
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "alert_threshold_critical" NUMERIC(10,2);
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "reading_interval_minutes" INTEGER DEFAULT 15;
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "sensor_id" VARCHAR(100);
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "sensor_location" TEXT;
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_environmental_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "config_id" INTEGER;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "reading_value" NUMERIC(10,2);
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "reading_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "is_within_range" BOOLEAN;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "alert_level" VARCHAR(20);
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "sensor_status" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "raw_data" JSONB;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "acknowledged_by" UUID;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMP;
ALTER TABLE "wms_environmental_logs" ADD COLUMN IF NOT EXISTS "corrective_action" TEXT;
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(200);
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "title" VARCHAR(500);
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(100);
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "days_until_expiry" INTEGER;
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "external_reference" VARCHAR(200);
ALTER TABLE "wms_expiring_documents" ADD COLUMN IF NOT EXISTS "issuer_name" VARCHAR(200);
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(100);
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "quantity_remaining" NUMERIC(15,4);
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "alert_type" VARCHAR(30);
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "days_to_expiry" INTEGER;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "acknowledged_by" UUID;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "acknowledged_at" TIMESTAMPTZ;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "resolution_notes" TEXT;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_expiry_alerts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "internal_code" VARCHAR(50);
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "batch_number" VARCHAR(50);
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(50);
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "batch_quantity" NUMERIC(15,4);
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "batch_status" VARCHAR(20);
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "days_to_expiry" INTEGER;
ALTER TABLE "wms_expiry_alerts_view" ADD COLUMN IF NOT EXISTS "alert_type" TEXT;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "transfer_id" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "transfer_line_id" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "selected_batch_id" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "selected_lot_number" VARCHAR(100);
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "selected_expiry_date" DATE;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "recommended_batch_id" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "recommended_lot_number" VARCHAR(100);
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "recommended_expiry_date" DATE;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "days_difference" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "ignored_by" UUID;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "ignored_at" TIMESTAMPTZ;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "ignore_reason" TEXT;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "notification_sent" BOOLEAN DEFAULT false;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "notification_id" INTEGER;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "escalation_level" INTEGER DEFAULT 0;
ALTER TABLE "wms_fifo_violations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "abc_class" character;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "xyz_class" character;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "combined_class" VARCHAR(2);
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "annual_consumption_value" NUMERIC(15,2);
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "demand_variability" NUMERIC(5,4);
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "last_calculated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "calculation_period_months" INTEGER DEFAULT 12;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_inventory_classification" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "schedule_id" INTEGER;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "execution_code" VARCHAR(30);
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMPTZ;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "total_products" INTEGER DEFAULT 0;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "products_with_difference" INTEGER DEFAULT 0;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "total_difference_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "wms_inventory_executions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "schedule_code" VARCHAR(30);
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "inventory_type" VARCHAR(30);
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "frequency" VARCHAR(20);
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "tolerance_percentage" NUMERIC(5,2) DEFAULT 2.0;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "requires_blind_count" BOOLEAN DEFAULT false;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "require_approval" BOOLEAN DEFAULT true;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "next_execution_date" TIMESTAMPTZ;
ALTER TABLE "wms_inventory_schedules" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "valuation_date" DATE;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "valuation_method" VARCHAR(20);
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "quantity_on_hand" NUMERIC(15,4);
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "total_value" NUMERIC(15,2);
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'ARS';
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "previous_valuation_id" INTEGER;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "adjustment_amount" NUMERIC(15,2);
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "adjustment_reason" TEXT;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "calculated_by" UUID;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "wms_inventory_valuation" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "snapshot_date" DATE;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "period_type" VARCHAR(20);
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "total_sku_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "active_sku_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "total_stock_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "avg_inventory_turnover" NUMERIC(10,4);
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "avg_days_inventory" NUMERIC(10,2);
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "slow_moving_sku_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "dead_stock_sku_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "dead_stock_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "space_utilization_percentage" NUMERIC(5,2);
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "inventory_accuracy_percentage" NUMERIC(5,2);
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "total_storage_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "total_capital_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "total_holding_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "fill_rate_percentage" NUMERIC(5,2);
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "stockout_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "near_expiry_sku_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "near_expiry_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "expired_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_kpi_snapshots" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "shift_date" DATE;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "task_type" VARCHAR(50);
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "task_reference_id" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "from_location_id" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "to_location_id" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "lines_processed" INTEGER DEFAULT 0;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "units_processed" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "started_at" TIMESTAMPTZ;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "duration_seconds" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "expected_duration_seconds" INTEGER;
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "performance_percentage" NUMERIC(5,2);
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "device_id" VARCHAR(100);
ALTER TABLE "wms_labor_tasks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "facings" INTEGER DEFAULT 1;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "depth" INTEGER DEFAULT 1;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "stack_height" INTEGER DEFAULT 1;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "max_quantity" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "min_quantity" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "reorder_quantity" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "position_x" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "position_y" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "position_z" INTEGER;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "space_used_cm3" NUMERIC(15,2);
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "space_percent" NUMERIC(5,2);
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "is_permanent" BOOLEAN DEFAULT false;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "is_promotional" BOOLEAN DEFAULT false;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "valid_to" DATE;
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_location_assignments" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "zone_id" INTEGER;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "code" VARCHAR(30);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "barcode" VARCHAR(50);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "location_type" VARCHAR(30);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "aisle" VARCHAR(10);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "rack" VARCHAR(10);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "level" VARCHAR(10);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "position" VARCHAR(10);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "length_cm" NUMERIC(10,2);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "width_cm" NUMERIC(10,2);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(10,2);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "max_weight_kg" NUMERIC(10,2);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "volume_cm3" NUMERIC(15,2);
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "facing_slots" INTEGER;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "is_prime_location" BOOLEAN DEFAULT false;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "traffic_score" INTEGER;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "product_restrictions" TEXT;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "is_pickable" BOOLEAN DEFAULT true;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "is_storable" BOOLEAN DEFAULT true;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "is_countable" BOOLEAN DEFAULT true;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_locations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "request_id" INTEGER;
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "action" VARCHAR(50);
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "previous_status" VARCHAR(30);
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "new_status" VARCHAR(30);
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "performed_by" UUID;
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "performed_by_name" VARCHAR(200);
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "performed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "details" JSONB;
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "ip_address" inet;
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_material_request_history" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "request_id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "line_number" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "product_code" VARCHAR(50);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "quantity_requested" NUMERIC(15,4);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "quantity_reserved" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "quantity_dispatched" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "quantity_received" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "unit_of_measure" VARCHAR(20);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "line_status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "available_quantity" NUMERIC(15,4);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "available_in_transit" NUMERIC(15,4);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "expected_receipt_date" DATE;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "reserved_stock_id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "reserved_batch_id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "reserved_location_id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "suggested_alternative_id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "purchase_order_suggested" BOOLEAN DEFAULT false;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "purchase_request_id" INTEGER;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "total_value" NUMERIC(15,2);
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_material_request_lines" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "request_number" VARCHAR(50);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "requested_by" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "requester_department_id" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "requester_name" VARCHAR(200);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "requester_position" VARCHAR(200);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "destination_type" VARCHAR(30);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "destination_warehouse_id" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "destination_department_id" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "destination_employee_id" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "destination_project_code" VARCHAR(50);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "destination_notes" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "source_warehouse_id" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "request_date" DATE DEFAULT CURRENT_DATE;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "required_date" DATE;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "required_time" TIME;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "urgency_level" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "requires_approval" BOOLEAN DEFAULT true;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "approval_notes" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "rejected_by" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "rejected_at" TIMESTAMPTZ;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "reservation_status" VARCHAR(30);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "reserved_by" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "reserved_at" TIMESTAMPTZ;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "reservation_notes" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "prepared_by" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "prepared_at" TIMESTAMPTZ;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "dispatched_by" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "dispatched_at" TIMESTAMPTZ;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "received_by" UUID;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMPTZ;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "reception_notes" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "generated_document_type" VARCHAR(30);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "generated_document_id" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "purpose" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "cost_center" VARCHAR(50);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "project_code" VARCHAR(50);
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "priority_score" INTEGER;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "total_lines" INTEGER DEFAULT 0;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "estimated_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "notifications_sent" JSONB DEFAULT '[]';
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "internal_notes" TEXT;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "purchase_request_generated" BOOLEAN DEFAULT false;
ALTER TABLE "wms_material_requests" ADD COLUMN IF NOT EXISTS "purchase_request_ids" JSONB;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "expiry_check_enabled" BOOLEAN DEFAULT true;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "expiry_check_interval_hours" INTEGER DEFAULT 24;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "expiry_alert_days_default" INTEGER DEFAULT 30;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "expiry_imminent_days" INTEGER DEFAULT 7;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "fifo_enforcement_level" VARCHAR(20) DEFAULT 'warn';
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "fifo_apply_to_showroom_only" BOOLEAN DEFAULT true;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "alert_hierarchy" JSONB DEFAULT '["warehouse_manager", "operations_supervisor", "operations_manager"]';
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "last_expiry_check_at" TIMESTAMPTZ;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "last_expiry_check_result" JSONB;
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_monitoring_config" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "notification_type" VARCHAR(50);
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "target_user_ids" TEXT[];
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "target_roles" TEXT[];
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "target_warehouse_id" INTEGER;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "title" VARCHAR(200);
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "message" TEXT;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(50);
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "reference_id" INTEGER;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "action_url" TEXT;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "sent_at" TIMESTAMPTZ;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "error_message" TEXT;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMPTZ;
ALTER TABLE "wms_notification_queue" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "request_number" VARCHAR(50);
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "company_name" VARCHAR(255);
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "operation_type" VARCHAR(50);
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(50);
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "reference_id" INTEGER;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2);
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "total_quantity" INTEGER;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "urgency_level" VARCHAR(20);
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20);
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "current_level" INTEGER;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "required_levels" INTEGER;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "requested_at" TIMESTAMP;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMP;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "requested_by_name" TEXT;
ALTER TABLE "wms_pending_authorizations" ADD COLUMN IF NOT EXISTS "hours_pending" NUMERIC(12,2);
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "source_type" VARCHAR(30);
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "source_id" INTEGER;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "source_number" VARCHAR(50);
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "quantity_ordered" NUMERIC(15,4);
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "quantity_received" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "quantity_pending" NUMERIC(15,4);
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "expected_date" DATE;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "confirmed_date" DATE;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "supplier_name" VARCHAR(200);
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "reserved_for_requests" JSONB DEFAULT '[]';
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_pending_receipts" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "request_number" VARCHAR(50);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "source_warehouse_id" INTEGER;
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "required_date" DATE;
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "urgency_level" VARCHAR(20);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "requester_name" VARCHAR(200);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "requester_department" VARCHAR(100);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "destination_type" VARCHAR(30);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "total_lines" INTEGER;
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "estimated_value" NUMERIC(15,2);
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "urgency_status" TEXT;
ALTER TABLE "wms_pending_requests_dashboard" ADD COLUMN IF NOT EXISTS "days_until_required" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "wave_id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "source_location_id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "destination_location_id" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "quantity_required" NUMERIC(15,4);
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "quantity_picked" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "sequence_number" INTEGER;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "assigned_to" UUID;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "picked_at" TIMESTAMP;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "order_reference" VARCHAR(100);
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_pick_tasks" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "wave_number" VARCHAR(50);
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "wave_type" VARCHAR(20);
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'planned';
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 5;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "planned_start" TIMESTAMP;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "actual_start" TIMESTAMP;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "planned_end" TIMESTAMP;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "actual_end" TIMESTAMP;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "total_picks" INTEGER DEFAULT 0;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "completed_picks" INTEGER DEFAULT 0;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "total_lines" INTEGER DEFAULT 0;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "completed_lines" INTEGER DEFAULT 0;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "assigned_pickers" TEXT[];
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "estimated_duration_minutes" INTEGER;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "actual_duration_minutes" INTEGER;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "optimization_score" NUMERIC(5,2);
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_pick_waves" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_price_list_categories" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_price_list_categories" ADD COLUMN IF NOT EXISTS "price_list_id" INTEGER;
ALTER TABLE "wms_price_list_categories" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "wms_price_list_categories" ADD COLUMN IF NOT EXISTS "include_children" BOOLEAN DEFAULT true;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "is_mirror" BOOLEAN DEFAULT false;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "mirror_from_id" INTEGER;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "mirror_adjustment_type" VARCHAR(20);
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "mirror_adjustment_value" NUMERIC(10,4);
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "mirror_update_mode" VARCHAR(20) DEFAULT 'AUTOMATIC';
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "applies_to" VARCHAR(20) DEFAULT 'ALL';
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "currency_id" INTEGER;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "valid_to" DATE;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "rounding_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "rounding_type" VARCHAR(20) DEFAULT 'DECIMALS';
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "rounding_decimals" INTEGER DEFAULT 2;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "rounding_to_nearest" NUMERIC(10,2);
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "tax_included" BOOLEAN DEFAULT true;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "show_in_pos" BOOLEAN DEFAULT true;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "show_in_ecommerce" BOOLEAN DEFAULT false;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "requires_authorization" BOOLEAN DEFAULT false;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 0;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_price_lists" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "barcode" VARCHAR(50);
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "barcode_type" VARCHAR(20) DEFAULT 'EAN13';
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "description" VARCHAR(100);
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "is_primary" BOOLEAN DEFAULT false;
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_product_barcodes" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "change_type" VARCHAR(50);
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "field_name" VARCHAR(100);
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "old_value" TEXT;
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "new_value" TEXT;
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "changed_by" UUID;
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "changed_by_name" VARCHAR(200);
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "changed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "source" VARCHAR(50);
ALTER TABLE "wms_product_changes_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "product_cost_id" INTEGER;
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "tax_rate_id" INTEGER;
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "tax_code" VARCHAR(20);
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "tax_name" VARCHAR(100);
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "rate" NUMERIC(10,4);
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "base_amount" NUMERIC(15,4);
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(15,4);
ALTER TABLE "wms_product_cost_taxes" ADD COLUMN IF NOT EXISTS "calculation_order" INTEGER DEFAULT 1;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "purchase_cost" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "currency_id" INTEGER;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "exchange_rate" NUMERIC(15,6) DEFAULT 1;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "cost_in_local_currency" NUMERIC(15,4);
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "freight_cost" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "insurance_cost" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "customs_cost" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "other_costs" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "other_costs_description" TEXT;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "subtotal_before_tax" NUMERIC(15,4);
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "total_taxes" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "total_cost" NUMERIC(15,4);
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "effective_from" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "effective_to" TIMESTAMPTZ;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "is_current" BOOLEAN DEFAULT true;
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "wms_product_costs" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_product_kit_components" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_kit_components" ADD COLUMN IF NOT EXISTS "kit_product_id" INTEGER;
ALTER TABLE "wms_product_kit_components" ADD COLUMN IF NOT EXISTS "component_product_id" INTEGER;
ALTER TABLE "wms_product_kit_components" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4) DEFAULT 1;
ALTER TABLE "wms_product_kit_components" ADD COLUMN IF NOT EXISTS "is_optional" BOOLEAN DEFAULT false;
ALTER TABLE "wms_product_kit_components" ADD COLUMN IF NOT EXISTS "sort_order" INTEGER DEFAULT 0;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(100);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "event_type" VARCHAR(50);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "quantity_before" NUMERIC(15,4);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "quantity_after" NUMERIC(15,4);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(50);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "reference_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "reference_number" VARCHAR(100);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "source_warehouse_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "destination_warehouse_id" INTEGER;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "total_value" NUMERIC(15,4);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "performed_by" UUID;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "performed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "is_estimated" BOOLEAN DEFAULT false;
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "estimation_method" VARCHAR(50);
ALTER TABLE "wms_product_lifecycle" ADD COLUMN IF NOT EXISTS "metadata" JSONB;
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "price_list_id" INTEGER;
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "old_price" NUMERIC(15,4);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "new_price" NUMERIC(15,4);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "old_cost" NUMERIC(15,4);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "new_cost" NUMERIC(15,4);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "old_margin_percent" NUMERIC(10,4);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "new_margin_percent" NUMERIC(10,4);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "change_type" VARCHAR(20);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "change_reason" TEXT;
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "changed_by" VARCHAR(100);
ALTER TABLE "wms_product_price_history" ADD COLUMN IF NOT EXISTS "changed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "price_list_id" INTEGER;
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "markup_percent" NUMERIC(10,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "net_price" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "tax_amount" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "final_price" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "price_per_pack" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "actual_margin_amount" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "actual_margin_percent" NUMERIC(10,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "actual_margin_per_pack" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "suggested_price" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "was_rounded" BOOLEAN DEFAULT false;
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "rounding_difference" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "is_price_locked" BOOLEAN DEFAULT false;
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "lock_expires_at" TIMESTAMPTZ;
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "lock_reason" VARCHAR(200);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "is_manual_price" BOOLEAN DEFAULT false;
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "last_cost_used" NUMERIC(15,4);
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "last_updated" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_product_prices" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(100);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "internal_code" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "barcode" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "supplier_code" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "family_code" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "short_name" VARCHAR(100);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "brand_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "product_type" VARCHAR(20) DEFAULT 'RESALE';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "unit_of_measure_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "units_per_pack" INTEGER DEFAULT 1;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "packaging_type" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "size" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "color" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "flavor" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "weight_net" NUMERIC(12,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "weight_gross" NUMERIC(12,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_weighted" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "barcode_contains_weight" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "barcode_contains_price" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "barcode_article_digits" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "barcode_value_digits" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "barcode_value_decimals" INTEGER DEFAULT 3;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_perishable" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "shelf_life_days" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "requires_batch_tracking" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "requires_cold_chain" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "storage_temperature_min" NUMERIC(5,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "storage_temperature_max" NUMERIC(5,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_sellable" BOOLEAN DEFAULT true;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_purchasable" BOOLEAN DEFAULT true;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "allows_discount" BOOLEAN DEFAULT true;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "allows_returns" BOOLEAN DEFAULT true;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "commission_percent" NUMERIC(5,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_kit" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "parent_product_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "length_cm" NUMERIC(10,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "width_cm" NUMERIC(10,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(10,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "volume_cm3" NUMERIC(15,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "stacking_limit" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_price_locked" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "price_lock_expires_at" TIMESTAMPTZ;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "price_lock_reason" VARCHAR(200);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_blocked" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "blocked_reason" VARCHAR(100);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "image_url" VARCHAR(500);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "thumbnail_url" VARCHAR(500);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(100);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_catch_weight" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "nominal_weight" NUMERIC(15,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_serialized" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "volume_m3" NUMERIC(10,6);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "requires_expiry_control" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "expiry_alert_days" INTEGER DEFAULT 30;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "gondola_section" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "shelf_level" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "facing_count" INTEGER DEFAULT 1;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "shelf_depth_units" INTEGER DEFAULT 3;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "display_type" VARCHAR(30) DEFAULT 'standard';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(12,3);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(12,3);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(12,3);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "min_order_qty" NUMERIC(12,3) DEFAULT 1;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "order_multiple" NUMERIC(12,3) DEFAULT 1;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "lead_time_days" INTEGER DEFAULT 7;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_seasonal" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "season_start_month" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "season_end_month" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "seasonality_factor" JSONB DEFAULT '{}';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "abc_class" character;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "xyz_class" character;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "abc_xyz_last_calculated" TIMESTAMPTZ;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "avg_daily_sales" NUMERIC(12,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "sales_velocity" NUMERIC(10,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "days_of_supply" NUMERIC(10,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "stockout_probability" NUMERIC(5,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "iva_type" VARCHAR(20) DEFAULT 'gravado';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "iva_rate" NUMERIC(5,2) DEFAULT 21.00;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "internal_tax_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "perception_iva_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "perception_iibb_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "ncm_code" VARCHAR(20);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "hs_code" VARCHAR(20);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "country_of_origin" VARCHAR(3);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "customs_tariff_rate" NUMERIC(6,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "manufacturer_name" VARCHAR(200);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "manufacturer_code" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "alternate_part_number" VARCHAR(100);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "oem_code" VARCHAR(100);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "certifications" JSONB DEFAULT '[]';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "quality_inspection_required" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "quality_inspection_type" VARCHAR(50);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "quality_inspection_frequency" VARCHAR(20);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "quality_hold_days" INTEGER DEFAULT 0;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "handling_instructions" TEXT;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "storage_zone_type" VARCHAR(30);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_hazardous" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "hazmat_class" VARCHAR(20);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "hazmat_un_number" VARCHAR(10);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "hazmat_packing_group" VARCHAR(10);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "requires_fifo" BOOLEAN DEFAULT true;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "requires_fefo" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "shelf_life_percent_for_receipt" INTEGER DEFAULT 75;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "is_critical" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "criticality_level" VARCHAR(10) DEFAULT 'normal';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "economic_order_qty" NUMERIC(15,3);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "reorder_qty" NUMERIC(15,3);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "purchasing_cycle_days" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "preferred_supplier_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "alternate_supplier_ids" TEXT[];
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "last_purchase_date" DATE;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "last_purchase_price" NUMERIC(15,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "avg_purchase_price" NUMERIC(15,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "sales_unit_measure_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "conversion_factor" NUMERIC(15,6) DEFAULT 1;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "suggested_retail_price" NUMERIC(15,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "minimum_sale_price" NUMERIC(15,4);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "target_margin_percent" NUMERIC(5,2);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "allows_fractional_sales" BOOLEAN DEFAULT false;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "lifecycle_status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "phase_out_date" DATE;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "replacement_product_id" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "last_sale_date" DATE;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "days_without_movement" INTEGER;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "tags" VARCHAR(500);
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "keywords" TEXT;
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "custom_attributes" JSONB DEFAULT '{}';
ALTER TABLE "wms_products" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "internal_code" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "barcode" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "supplier_code" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "family_code" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "short_name" VARCHAR(100);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "brand_id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "product_type" VARCHAR(20);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "unit_of_measure_id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "units_per_pack" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "packaging_type" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "size" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "color" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "flavor" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "weight_net" NUMERIC(12,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "weight_gross" NUMERIC(12,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_weighted" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "barcode_contains_weight" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "barcode_contains_price" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "barcode_article_digits" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "barcode_value_digits" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "barcode_value_decimals" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_perishable" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "shelf_life_days" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "requires_batch_tracking" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "requires_cold_chain" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "storage_temperature_min" NUMERIC(5,2);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "storage_temperature_max" NUMERIC(5,2);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_sellable" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_purchasable" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "allows_discount" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "allows_returns" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "commission_percent" NUMERIC(5,2);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_kit" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "parent_product_id" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "length_cm" NUMERIC(10,2);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "width_cm" NUMERIC(10,2);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "height_cm" NUMERIC(10,2);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "volume_cm3" NUMERIC(15,2);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "stacking_limit" INTEGER;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_price_locked" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "price_lock_expires_at" TIMESTAMPTZ;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "price_lock_reason" VARCHAR(200);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "is_blocked" BOOLEAN;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "blocked_reason" VARCHAR(100);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "image_url" VARCHAR(500);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "thumbnail_url" VARCHAR(500);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ;
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "updated_by" VARCHAR(100);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "category_name" VARCHAR(100);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "category_path" VARCHAR(500);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "brand_name" VARCHAR(100);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "supplier_name" VARCHAR(150);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "unit_code" VARCHAR(10);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "unit_name" VARCHAR(50);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "quantity_on_hand" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "quantity_available" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "quantity_reserved" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "average_cost" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "total_value" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "inventory_status" VARCHAR(20);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "min_stock" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "current_cost" NUMERIC(15,4);
ALTER TABLE "wms_products_full_view" ADD COLUMN IF NOT EXISTS "current_total_cost" NUMERIC(15,4);
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "promotion_id" INTEGER;
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "item_type" VARCHAR(20);
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "category_id" INTEGER;
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "brand_id" INTEGER;
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "quantity_required" NUMERIC(15,4) DEFAULT 1;
ALTER TABLE "wms_promotion_items" ADD COLUMN IF NOT EXISTS "is_bonus_item" BOOLEAN DEFAULT false;
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "promotion_id" INTEGER;
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "min_quantity" NUMERIC(15,4);
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "max_quantity" NUMERIC(15,4);
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "discount_percent" NUMERIC(10,4);
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "discount_amount" NUMERIC(15,4);
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "wms_promotion_tiers" ADD COLUMN IF NOT EXISTS "tier_name" VARCHAR(50);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "code" VARCHAR(30);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "promotion_type" VARCHAR(30);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "discount_percent" NUMERIC(10,4);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "discount_amount" NUMERIC(15,4);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "buy_quantity" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "get_quantity" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "special_price" NUMERIC(15,4);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "min_quantity" NUMERIC(15,4);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "max_quantity" NUMERIC(15,4);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "min_amount" NUMERIC(15,4);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "max_discount_amount" NUMERIC(15,4);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "max_uses_total" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "max_uses_per_customer" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "max_uses_per_transaction" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "valid_from" TIMESTAMPTZ;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "valid_to" TIMESTAMPTZ;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "valid_days_of_week" VARCHAR(20);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "valid_time_from" TIME;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "valid_time_to" TIME;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "valid_until_stock_depleted" BOOLEAN DEFAULT false;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "stock_for_promotion" INTEGER;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "applies_to" VARCHAR(20) DEFAULT 'SELECTED';
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "applies_to_price_lists" VARCHAR(100);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "is_combinable" BOOLEAN DEFAULT false;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "priority" INTEGER DEFAULT 0;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "requires_coupon" BOOLEAN DEFAULT false;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "coupon_code" VARCHAR(30);
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "current_uses" INTEGER DEFAULT 0;
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_promotions" ADD COLUMN IF NOT EXISTS "created_by" VARCHAR(100);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "inspection_number" VARCHAR(30);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "inspection_point" VARCHAR(30);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(15,4);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "sample_quantity" NUMERIC(15,4);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "passed_quantity" NUMERIC(15,4);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "failed_quantity" NUMERIC(15,4);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "overall_result" VARCHAR(20);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "checkpoint_results" JSONB;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "photos" JSONB DEFAULT '[]';
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "inspected_by" UUID;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "disposition" VARCHAR(30);
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_qc_inspections" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "hold_reason" VARCHAR(100);
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "hold_type" VARCHAR(50);
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "quantity_held" NUMERIC(15,4);
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "placed_by" UUID;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "placed_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "released_by" UUID;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "released_at" TIMESTAMP;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "release_notes" TEXT;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "inspection_required" BOOLEAN DEFAULT true;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "inspection_result" TEXT;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "disposition" VARCHAR(50);
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "disposition_notes" TEXT;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "reference_document" VARCHAR(100);
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_quality_holds" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "unique_products" BIGINT;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "total_units" NUMERIC(12,2);
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "total_inventory_value" INTEGER;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "locations_used" INTEGER;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "total_locations" INTEGER;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "expired_batches" BIGINT;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "expiring_30_days" BIGINT;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "pending_transfers" BIGINT;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "active_holds" BIGINT;
ALTER TABLE "wms_realtime_kpis" ADD COLUMN IF NOT EXISTS "active_recalls" BIGINT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "recall_number" VARCHAR(50);
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "recall_type" VARCHAR(30);
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "severity_level" VARCHAR(20);
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "affected_batches" TEXT[];
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "affected_serial_numbers" TEXT[];
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "health_risk_description" TEXT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "discovery_date" DATE;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "notification_date" DATE;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "regulatory_agency" VARCHAR(200);
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "regulatory_reference" VARCHAR(200);
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "geographic_scope" TEXT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'initiated';
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "initiated_by" UUID;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "initiated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMP;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMP;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "total_units_affected" INTEGER;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "total_units_recovered" INTEGER;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "recovery_percentage" NUMERIC(5,2);
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "public_notice_required" BOOLEAN DEFAULT false;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "public_notice_date" DATE;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "corrective_actions" TEXT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "preventive_actions" TEXT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "root_cause_analysis" TEXT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "lessons_learned" TEXT;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_recall_requests" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "recall_id" INTEGER;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "quantity_affected" INTEGER;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "quantity_recovered" INTEGER DEFAULT 0;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "recovery_status" VARCHAR(30) DEFAULT 'pending';
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "customer_name" VARCHAR(200);
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "customer_contact" TEXT;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "recovery_date" DATE;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "recovery_method" VARCHAR(50);
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "disposition" VARCHAR(50);
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "disposition_date" DATE;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "disposition_reference" VARCHAR(200);
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_recall_tracking" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(15,4);
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(15,4);
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "economic_order_qty" NUMERIC(15,4);
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "max_stock_level" NUMERIC(15,4);
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "lead_time_days" INTEGER DEFAULT 7;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "service_level" NUMERIC(5,4) DEFAULT 0.95;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "avg_daily_demand" NUMERIC(15,4);
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "demand_std_deviation" NUMERIC(15,4);
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "last_calculated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "auto_generate_po" BOOLEAN DEFAULT false;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_reorder_points" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "replenishment_method" VARCHAR(30) DEFAULT 'MIN_MAX';
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "min_stock" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "reorder_quantity" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "service_level_target" NUMERIC(5,2) DEFAULT 95.00;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "lead_time_days" INTEGER DEFAULT 7;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "auto_generate_orders" BOOLEAN DEFAULT false;
ALTER TABLE "wms_replenishment_config" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "suggestion_type" VARCHAR(30);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'MEDIUM';
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "current_stock" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "suggested_quantity" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "optimal_quantity" NUMERIC(15,4);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "days_of_stock_current" INTEGER;
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "days_of_stock_after" INTEGER;
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "stockout_probability" NUMERIC(5,2);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "estimated_order_cost" NUMERIC(15,2);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "current_holding_cost_monthly" NUMERIC(15,2);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "net_benefit" NUMERIC(15,2);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "space_utilization_current" NUMERIC(5,2);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "capital_efficiency_improvement" NUMERIC(5,2);
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "generated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "expires_at" TIMESTAMPTZ;
ALTER TABLE "wms_replenishment_suggestions" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "policy_id" INTEGER;
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "entity_id" INTEGER;
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "action_type" VARCHAR(20);
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "action_date" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "action_by" UUID;
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "reason" TEXT;
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "approval_id" INTEGER;
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "original_data_hash" VARCHAR(128);
ALTER TABLE "wms_retention_actions" ADD COLUMN IF NOT EXISTS "archive_location" TEXT;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "entity_type" VARCHAR(50);
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "retention_years" INTEGER;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "legal_basis" TEXT;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "jurisdiction" VARCHAR(100);
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "archive_after_days" INTEGER;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "delete_after_archive" BOOLEAN DEFAULT false;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "requires_approval_to_delete" BOOLEAN DEFAULT true;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_retention_policies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "return_number" VARCHAR(30);
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "return_type" VARCHAR(20);
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "customer_id" INTEGER;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "original_document_number" VARCHAR(50);
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "reason_notes" TEXT;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PENDING';
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMPTZ;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "expected_quantity" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "received_quantity" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "total_value" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "credit_issued" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "carrier_name" VARCHAR(100);
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "tracking_number" VARCHAR(100);
ALTER TABLE "wms_returns" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "period_start" DATE;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "period_end" DATE;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "period_type" VARCHAR(20);
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "opening_stock" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "closing_stock" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "average_stock" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "total_receipts" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "total_shipments" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "inventory_turnover_ratio" NUMERIC(10,4);
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "days_inventory_outstanding" NUMERIC(10,2);
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "days_without_movement" INTEGER DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "storage_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "capital_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "depreciation_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "total_holding_cost" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "is_slow_moving" BOOLEAN DEFAULT false;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "is_dead_stock" BOOLEAN DEFAULT false;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "is_overstock" BOOLEAN DEFAULT false;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "anomaly_score" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "wms_rotation_metrics" ADD COLUMN IF NOT EXISTS "calculated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "sale_id" INTEGER;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "sale_line_id" INTEGER;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "sale_date" TIMESTAMPTZ;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(100);
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "quantity_allocated" NUMERIC(15,4);
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "allocation_method" VARCHAR(30) DEFAULT 'fifo_entry_date';
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "allocated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "is_estimated" BOOLEAN DEFAULT true;
ALTER TABLE "wms_sales_fifo_allocation" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'AVAILABLE';
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "manufacturing_date" DATE;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "warranty_expiry_date" DATE;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMPTZ;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "sold_at" TIMESTAMPTZ;
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "wms_serial_numbers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "quantity_on_hand" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "quantity_reserved" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "quantity_available" NUMERIC(15,4);
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "quantity_incoming" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "quantity_in_transit" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "average_cost" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "total_value" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(15,4);
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "min_stock" NUMERIC(15,4);
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "max_stock" NUMERIC(15,4);
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "safety_stock" NUMERIC(15,4);
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "inventory_status" VARCHAR(20) DEFAULT 'ACTIVE';
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "last_count_date" TIMESTAMPTZ;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "last_count_quantity" NUMERIC(15,4);
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "last_movement_date" TIMESTAMPTZ;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "last_sale_date" TIMESTAMPTZ;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "last_purchase_date" TIMESTAMPTZ;
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_stock" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "internal_code" VARCHAR(50);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "quantity_on_hand" NUMERIC(15,4);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "quantity_available" NUMERIC(15,4);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "reorder_point" NUMERIC(15,4);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "min_stock" NUMERIC(15,4);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "inventory_status" VARCHAR(20);
ALTER TABLE "wms_stock_alerts_view" ADD COLUMN IF NOT EXISTS "alert_type" TEXT;
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "product_name" VARCHAR(200);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "sku" VARCHAR(50);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "total_quantity" NUMERIC(15,4);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "batch_quantity" NUMERIC(12,2);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "available_quantity" NUMERIC(12,2);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "expired_quantity" NUMERIC(12,2);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "expiring_soon_quantity" NUMERIC(12,2);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "reserved_quantity" NUMERIC(15,4);
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "earliest_expiry" DATE;
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "requires_expiry_control" BOOLEAN;
ALTER TABLE "wms_stock_availability" ADD COLUMN IF NOT EXISTS "expiry_alert_days" INTEGER;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "batch_number" VARCHAR(50);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(50);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(50);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "quantity_reserved" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "quantity_available" NUMERIC(15,4);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "production_date" DATE;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "received_date" DATE;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "supplier_id" INTEGER;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "purchase_order_ref" VARCHAR(50);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "invoice_ref" VARCHAR(50);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'AVAILABLE';
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "wms_stock_batches" ADD COLUMN IF NOT EXISTS "current_quantity" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "movement_type" VARCHAR(30);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "movement_date" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "quantity_before" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "quantity_moved" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "quantity_after" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "unit_cost" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "total_cost" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "unit_price" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "total_price" NUMERIC(15,4);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "document_type" VARCHAR(30);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "document_number" VARCHAR(50);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "document_line" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "from_warehouse_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "to_warehouse_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "transfer_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "user_id" INTEGER;
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "user_name" VARCHAR(100);
ALTER TABLE "wms_stock_movements" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "stock_id" INTEGER;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "location_id" INTEGER;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "quantity_reserved" NUMERIC(15,4);
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "reserved_by" UUID;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "reservation_type" VARCHAR(30);
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "reference_type" VARCHAR(30);
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "reference_id" INTEGER;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'active';
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "completed_at" TIMESTAMPTZ;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "cancelled_at" TIMESTAMPTZ;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "material_request_id" INTEGER;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "material_request_line_id" INTEGER;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "auto_release_date" DATE;
ALTER TABLE "wms_stock_reservations" ADD COLUMN IF NOT EXISTS "is_auto_reservation" BOOLEAN DEFAULT false;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "name" VARCHAR(150);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "legal_name" VARCHAR(200);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "tax_id" VARCHAR(30);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "email" VARCHAR(100);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "contact_name" VARCHAR(100);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "payment_terms" INTEGER DEFAULT 30;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "currency_id" INTEGER;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "credit_limit" NUMERIC(15,2);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "visit_frequency_days" INTEGER;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "avg_lead_time_days" NUMERIC(5,2);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "lead_time_std_dev" NUMERIC(5,2);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "min_order_amount" NUMERIC(15,2);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "delivery_days" VARCHAR(20) DEFAULT '1,2,3,4,5';
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "order_cutoff_time" TIME;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "last_visit_date" DATE;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "next_expected_visit" DATE;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "product_categories" JSONB DEFAULT '[]';
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "portal_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "portal_activated_at" TIMESTAMPTZ;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_name" VARCHAR(100);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_account_type" VARCHAR(30);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_account_number" VARCHAR(50);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_cbu" VARCHAR(30);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_alias" VARCHAR(50);
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "rating_score" NUMERIC(3,2) DEFAULT 0;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "total_orders" INTEGER DEFAULT 0;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "total_amount" NUMERIC(15,2) DEFAULT 0;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "on_time_delivery_rate" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "quality_rate" NUMERIC(5,2) DEFAULT 100;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "claims_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_info_last_updated_at" TIMESTAMPTZ;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_info_last_updated_by" INTEGER;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_info_2fa_token_id" BIGINT;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "bank_info_readonly_for_company" BOOLEAN DEFAULT true;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "supplier_type" VARCHAR(30) DEFAULT 'standard';
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "aponnt_associate_id" UUID;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "aponnt_commission_percent" NUMERIC(5,2) DEFAULT 0.00;
ALTER TABLE "wms_suppliers" ADD COLUMN IF NOT EXISTS "is_marketplace_provider" BOOLEAN;
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "tax_item_id" INTEGER;
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "rate" NUMERIC(10,4);
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "name" VARCHAR(50);
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "description" VARCHAR(200);
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "is_exempt" BOOLEAN DEFAULT false;
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "valid_from" DATE;
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "valid_to" DATE;
ALTER TABLE "wms_tax_rates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "template_id" INTEGER;
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "tax_code" VARCHAR(20);
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "tax_name" VARCHAR(100);
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "tax_type" VARCHAR(20) DEFAULT 'PERCENTAGE';
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "default_rate" NUMERIC(10,4);
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "applies_to" VARCHAR(20) DEFAULT 'BOTH';
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "calculation_order" INTEGER DEFAULT 1;
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "is_included_in_price" BOOLEAN DEFAULT false;
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "is_recoverable" BOOLEAN DEFAULT true;
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "affects_cost" BOOLEAN DEFAULT true;
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "affects_price" BOOLEAN DEFAULT true;
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "account_code_purchase" VARCHAR(20);
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "account_code_sale" VARCHAR(20);
ALTER TABLE "wms_tax_template_items" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "country_id" INTEGER;
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "is_default" BOOLEAN DEFAULT false;
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_tax_templates" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "trace_code" VARCHAR(50);
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "movement_type" VARCHAR(30);
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "batch_id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "serial_number" VARCHAR(100);
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "quantity" NUMERIC(15,4);
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "from_warehouse_id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "to_warehouse_id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "from_location_id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "to_location_id" INTEGER;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "unit_cost_at_movement" NUMERIC(15,4);
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "performed_by" UUID;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "performed_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_traceability_log" ADD COLUMN IF NOT EXISTS "metadata" JSONB DEFAULT '{}';
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "transfer_id" INTEGER;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "product_id" INTEGER;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "source_stock_id" INTEGER;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "source_batch_id" INTEGER;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "quantity_requested" NUMERIC(15,4);
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "quantity_dispatched" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "quantity_received" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "quantity_confirmed" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "quantity_difference" NUMERIC(15,4);
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "difference_reason" TEXT;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "source_location_id" INTEGER;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "destination_location_id" INTEGER;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "lot_number" VARCHAR(100);
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "expiry_date" DATE;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "line_status" VARCHAR(20) DEFAULT 'pending';
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_transfer_lines" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "transfer_number" VARCHAR(50);
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "source_warehouse_id" INTEGER;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "destination_warehouse_id" INTEGER;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "status" VARCHAR(30) DEFAULT 'draft';
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "approved_at" TIMESTAMPTZ;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "dispatched_at" TIMESTAMPTZ;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "received_at" TIMESTAMPTZ;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "confirmed_at" TIMESTAMPTZ;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "cancelled_at" TIMESTAMPTZ;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "created_by" UUID;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "approved_by" UUID;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "dispatched_by" UUID;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "received_by" UUID;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "confirmed_by" UUID;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "cancelled_by" UUID;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "transfer_reason" TEXT;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "cancellation_reason" TEXT;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "rejection_reason" TEXT;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "reception_notes" TEXT;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(20) DEFAULT 'normal';
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "expected_delivery_date" DATE;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "fifo_warnings_ignored" BOOLEAN DEFAULT false;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "fifo_warning_details" JSONB;
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_transfers" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "code" VARCHAR(10);
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "name" VARCHAR(50);
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "name_plural" VARCHAR(50);
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "symbol" VARCHAR(10);
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "unit_type" VARCHAR(20) DEFAULT 'UNIT';
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "base_unit_id" INTEGER;
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "conversion_factor" NUMERIC(15,6) DEFAULT 1;
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "is_divisible" BOOLEAN DEFAULT true;
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "decimal_places" INTEGER DEFAULT 2;
ALTER TABLE "wms_units_of_measure" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "warehouse_name" VARCHAR(100);
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "requests_pending_approval" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "requests_to_reserve" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "requests_to_prepare" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "requests_ready_dispatch" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "requests_due_today" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "requests_overdue" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "transfers_pending" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "transfers_approved" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "total_products" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "products_critical_stock" BIGINT;
ALTER TABLE "wms_warehouse_operations_summary" ADD COLUMN IF NOT EXISTS "batches_expiring_7days" BIGINT;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "role_in_warehouse" VARCHAR(50) DEFAULT 'operator';
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "can_approve_requests" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "can_approve_transfers" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "can_approve_adjustments" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "can_dispatch" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "can_receive" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "approval_limit_amount" NUMERIC(15,2);
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "department_id" INTEGER;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "shift_start" TIME;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "shift_end" TIME;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "work_days" JSONB DEFAULT '["mon", "tue", "wed", "thu", "fri"]';
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "is_primary" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "receive_low_stock_alerts" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "receive_request_alerts" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "receive_expiry_alerts" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_warehouse_staff" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(30);
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "storage_conditions" JSONB;
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "required_certifications" TEXT[];
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouse_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT now();
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "zone_type" VARCHAR(30);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "total_area_m2" NUMERIC(10,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "total_volume_m3" NUMERIC(10,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "usable_area_m2" NUMERIC(10,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "temperature_controlled" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "temperature_min" NUMERIC(5,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "temperature_max" NUMERIC(5,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "humidity_min" NUMERIC(5,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "humidity_max" NUMERIC(5,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "max_weight_kg" NUMERIC(15,2);
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouse_zones" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "branch_id" INTEGER;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "code" VARCHAR(20);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "warehouse_type" VARCHAR(30) DEFAULT 'GENERAL';
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "mirror_catalog_from_id" INTEGER;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "mirror_prices" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "price_adjustment_type" VARCHAR(20);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "price_adjustment_value" NUMERIC(10,4);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "mirror_categories" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "allows_negative_stock" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "track_batches" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "track_expiry" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "track_serial_numbers" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "track_locations" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "costing_method" VARCHAR(20) DEFAULT 'WEIGHTED_AVG';
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "address" TEXT;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "manager_name" VARCHAR(100);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "manager_email" VARCHAR(100);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "rotation_policy" VARCHAR(10) DEFAULT 'FIFO';
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "storage_cost_per_m3_day" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "capital_cost_rate_annual" NUMERIC(5,4) DEFAULT 0.12;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "max_days_without_rotation" INTEGER DEFAULT 90;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "alert_days_before_expiry" INTEGER DEFAULT 30;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "require_approval_for_adjustments" BOOLEAN DEFAULT true;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "warehouse_category" VARCHAR(50) DEFAULT 'storage';
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "is_sales_point" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "sub_type" VARCHAR(50);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "max_capacity" NUMERIC(15,2);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "current_occupation" NUMERIC(15,2);
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "auto_replenish" BOOLEAN DEFAULT false;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "manager_user_id" UUID;
ALTER TABLE "wms_warehouses" ADD COLUMN IF NOT EXISTS "warehouse_type_id" INTEGER;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "warehouse_id" INTEGER;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "wave_number" VARCHAR(30);
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "status" VARCHAR(20) DEFAULT 'PLANNED';
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "order_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "line_count" INTEGER DEFAULT 0;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "total_units" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "planned_start" TIMESTAMPTZ;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "planned_end" TIMESTAMPTZ;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "actual_start" TIMESTAMPTZ;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "actual_end" TIMESTAMPTZ;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "lines_picked" INTEGER DEFAULT 0;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "units_picked" NUMERIC(15,4) DEFAULT 0;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "progress_percentage" NUMERIC(5,2) DEFAULT 0;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "assigned_pickers" TEXT[];
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "released_by" UUID;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "released_at" TIMESTAMPTZ;
ALTER TABLE "wms_waves" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMPTZ DEFAULT now();
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "contingency_type" VARCHAR(50);
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "name" VARCHAR(200);
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "auto_activate" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "activation_criteria" JSONB;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "force_work_arrangement_id" INTEGER;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "affected_departments" TEXT[];
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "exempted_roles" TEXT[];
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "notify_all_employees" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "notify_supervisors" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "notify_hr" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "notification_message" TEXT;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "activated_at" TIMESTAMP;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "deactivated_at" TIMESTAMP;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "activated_by" UUID;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "deactivated_by" UUID;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "auto_revert_enabled" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "auto_revert_after_days" INTEGER;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "work_arrangement_contingency_plans" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "user_id" UUID;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "previous_arrangement_id" INTEGER;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "new_arrangement_id" INTEGER;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "change_reason" VARCHAR(50);
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "change_reason_detail" TEXT;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "changed_by" UUID;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "changed_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "reported_in_hcr" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "hcr_period" VARCHAR(20);
ALTER TABLE "work_arrangement_history" ADD COLUMN IF NOT EXISTS "iso_30414_category" VARCHAR(50);
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "company_id" INTEGER;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "work_arrangement_type_id" INTEGER;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "policy_name" VARCHAR(200);
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "min_hours_per_day" NUMERIC(4,2);
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "max_hours_per_day" NUMERIC(4,2);
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "flexible_schedule" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "core_hours_start" TIME;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "core_hours_end" TIME;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "min_office_days_per_week" INTEGER;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "max_remote_days_per_week" INTEGER;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "required_office_days" TEXT[];
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "requires_daily_checkin" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "requires_gps_verification" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "requires_vpn" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "requires_time_tracking_tool" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "enable_webcam_presence_detection" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "webcam_detection_interval_minutes" INTEGER DEFAULT 30;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "webcam_absence_retry_minutes" INTEGER DEFAULT 5;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "webcam_absence_threshold_minutes" INTEGER DEFAULT 10;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "webcam_detection_azure_face" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "webcam_respect_break_periods" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "webcam_image_retention_days" INTEGER DEFAULT 30;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "requires_explicit_consent" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "includes_office_space" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "includes_remote_stipend" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "remote_stipend_amount" NUMERIC(10,2);
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "includes_commute_allowance" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "commute_allowance_amount" NUMERIC(10,2);
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "pandemic_override_arrangement_id" INTEGER;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "emergency_override_arrangement_id" INTEGER;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "gdpr_compliant" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "bipa_compliant" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "argentina_ley_25326_compliant" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "consent_document_template_url" VARCHAR(500);
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "work_arrangement_policies" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "id" INTEGER;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "code" VARCHAR(50);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "name" VARCHAR(100);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "name_en" VARCHAR(100);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "icon" VARCHAR(10);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "category" VARCHAR(50);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "requires_physical_attendance" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "requires_gps_tracking" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "allows_flexible_hours" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "requires_webcam_presence_detection" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "minimum_presence_days_per_week" INTEGER;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "maximum_remote_days_per_week" INTEGER;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "tax_classification" VARCHAR(50);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "requires_contract_type" VARCHAR(50);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "compliance_requirements" JSONB DEFAULT '{"eu": {"articles": ["Art. 6", "Art. 9"], "gdpr_compliant": true}, "usa": {"law": "FLSA", "bipa_compliant": false}, "argentina": {"ley": "Ley 20.744 LCT", "articles": ["Art. 1", "Art. 21"]}}';
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "usable_during_pandemic" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "usable_during_emergency" BOOLEAN DEFAULT false;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "fallback_arrangement_id" INTEGER;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "iso_30414_aligned" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "iso_30414_category" VARCHAR(50);
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "is_active" BOOLEAN DEFAULT true;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE "work_arrangement_types" ADD COLUMN IF NOT EXISTS "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP;