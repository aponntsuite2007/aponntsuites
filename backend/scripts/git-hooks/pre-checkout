#!/bin/bash

# ğŸ›¡ï¸ PRE-CHECKOUT HOOK - BLOQUEA CHECKOUTS PELIGROSOS
# VersiÃ³n: 1.0
# Fecha: 2026-01-04

# Este hook se ejecuta ANTES de cada git checkout
# BLOQUEA el checkout si hay cambios sin commitear

CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
CHANGES=$(git status --porcelain)

# Si hay cambios sin commitear
if [ -n "$CHANGES" ]; then
    echo ""
    echo "ğŸš¨ ============================================== ğŸš¨"
    echo "ğŸš¨  CHECKOUT BLOQUEADO - PROTECCIÃ“N ACTIVADA    ğŸš¨"
    echo "ğŸš¨ ============================================== ğŸš¨"
    echo ""
    echo "âŒ NO podÃ©s hacer checkout porque tenÃ©s cambios sin commitear"
    echo ""
    echo "ğŸ“Š Cambios pendientes:"
    git status --short
    echo ""
    echo "âœ… SOLUCIÃ“N: CommiteÃ¡ primero tus cambios"
    echo ""
    echo "   git add -A"
    echo "   git commit -m \"Tu mensaje\""
    echo ""
    echo "DespuÃ©s podÃ©s hacer checkout tranquilo."
    echo ""

    exit 1  # BLOQUEAR el checkout
fi

# Si no hay cambios, permitir checkout
exit 0
