/**
 * ============================================================================
 * MEDICAL LEAVE WORKFLOW - AUTO-GENERATED
 * ============================================================================
 *
 * ⚠️ ARCHIVO AUTO-GENERADO - NO EDITAR MANUALMENTE
 *
 * Este archivo es regenerado automáticamente por UniversalWorkflowGenerator
 * cuando cambia el código de los servicios relacionados.
 *
 * FUENTES:
 * * - MedicalLeaveService.js
 * * - MedicalCertificateService.js
 *
 * Brain detecta este archivo via LIVE_CODE_SCAN y extrae los STAGES.
 * Cualquier cambio en los servicios fuente regenerará este archivo.
 *
 * Generado: 2025-12-15T17:51:00.573Z
 * Versión: 2.0.20251215-auto
 * Módulo: medical
 *
 * ESTADÍSTICAS:
 * - Total stages: 6
 * - Core: 3
 * - Existentes: 0
 * - Auto-generados: 0
 * - Estados finales: 2
 *
 * ============================================================================
 */

class MedicalWorkflowGenerated {
    /**
     * STAGES - Detectados automáticamente por Brain via LIVE_CODE_SCAN
     */
    static STAGES = {
        CERTIFICATE_UPLOADED: {
            name: 'Certificado Cargado',
            order: 1,
            category: 'intake',
            description: 'Stage core de Medical Leave Workflow',
            transitions_to: [],
            isCore: true,
        },

        VALIDATION: {
            name: 'Validación',
            order: 2,
            category: 'validation',
            description: 'Stage core de Medical Leave Workflow',
            transitions_to: [],
            isCore: true,
        },

        APPROVED: {
            name: 'Aprobado',
            order: 3,
            category: 'outcome',
            description: 'Stage core de Medical Leave Workflow',
            transitions_to: [],
            isCore: true,
        },

        LEAVE_APPROVED: {
            name: 'Licencia Aprobada',
            order: 4,
            category: 'success',
            description: 'Estado final',
            transitions_to: [],
            is_final: true,
            is_success: true,
        },

        LEAVE_REJECTED: {
            name: 'Licencia Rechazada',
            order: 5,
            category: 'rejection',
            description: 'Estado final',
            transitions_to: [],
            is_final: true,
            is_rejection: true,
        },

        LEAVE_EXTENDED: {
            name: 'Licencia Extendida',
            order: 6,
            category: 'process',
            description: 'Estado final',
            transitions_to: [],
        },

    };

    /**
     * WORKFLOW METADATA
     */
    static WORKFLOW_METADATA = {
        name: 'Medical Leave Workflow',
        module: 'medical',
        version: '2.0.20251215-auto',
        isAutoGenerated: true,
        generatedAt: '2025-12-15T17:51:00.573Z',
        sourceFiles: ["MedicalLeaveService.js","MedicalCertificateService.js"],
        entry_point: 'CERTIFICATE_UPLOADED',
        final_states: {
            success: ["LEAVE_APPROVED"],
            rejection: ["LEAVE_REJECTED"]
        },
        stats: {"total":6,"core":3,"existing":0,"autoGenerated":0,"outcomes":2}
    };

    /**
     * Obtener stages en orden
     */
    static getStagesInOrder() {
        return Object.entries(this.STAGES)
            .map(([key, stage]) => ({ key, ...stage }))
            .sort((a, b) => (a.order || 999) - (b.order || 999));
    }

    /**
     * Obtener stages finales
     */
    static getFinalStages() {
        return Object.entries(this.STAGES)
            .filter(([_, stage]) => stage.is_final)
            .map(([key, stage]) => ({ key, ...stage }));
    }

    /**
     * Validar transición
     */
    static isValidTransition(fromStage, toStage) {
        const from = this.STAGES[fromStage];
        if (!from || !from.transitions_to) return false;
        return from.transitions_to.includes(toStage);
    }

    /**
     * Obtener siguiente stage sugerido
     */
    static getNextSuggestedStage(currentStage) {
        const current = this.STAGES[currentStage];
        if (!current || !current.transitions_to || current.transitions_to.length === 0) return null;
        return current.transitions_to[0];
    }

    /**
     * Obtener tutorial steps para este workflow
     */
    static getTutorialSteps() {
        return this.getStagesInOrder()
            .filter(s => !s.is_final)
            .map((stage, index) => ({
                step: index + 1,
                stageId: stage.key,
                title: stage.name,
                description: stage.description || '',
                category: stage.category,
                validations: stage.validations || [],
                nextStages: stage.transitions_to || []
            }));
    }
}

module.exports = MedicalWorkflowGenerated;
