/**
 * ============================================================================
 * NOTIFICATION WORKFLOW - AUTO-GENERATED
 * ============================================================================
 *
 * ⚠️ ARCHIVO AUTO-GENERADO - NO EDITAR MANUALMENTE
 *
 * Este archivo es regenerado automáticamente por UniversalWorkflowGenerator
 * cuando cambia el código de los servicios relacionados.
 *
 * FUENTES:
 * * - NotificationUnifiedService.js
 * * - ProactiveNotificationService.js
 *
 * Brain detecta este archivo via LIVE_CODE_SCAN y extrae los STAGES.
 * Cualquier cambio en los servicios fuente regenerará este archivo.
 *
 * Generado: 2026-02-03T05:34:48.310Z
 * Versión: 2.0.20260203-auto
 * Módulo: notifications
 *
 * ESTADÍSTICAS:
 * - Total stages: 48
 * - Core: 4
 * - Existentes: 0
 * - Auto-generados: 41
 * - Estados finales: 3
 *
 * ============================================================================
 */

class NotificationsWorkflowGenerated {
    /**
     * STAGES - Detectados automáticamente por Brain via LIVE_CODE_SCAN
     */
    static STAGES = {
        NOTIFICATION_CREATED: {
            name: 'Notificación Creada',
            order: 1,
            category: 'intake',
            description: 'Stage core de Notification Workflow',
            transitions_to: [],
            isCore: true,
        },

        CHANNEL_SELECTION: {
            name: 'Selección de Canal',
            order: 2,
            category: 'routing',
            description: 'Stage core de Notification Workflow',
            transitions_to: [],
            isCore: true,
        },

        DELIVERY: {
            name: 'Entrega',
            order: 3,
            category: 'delivery',
            description: 'Stage core de Notification Workflow',
            transitions_to: [],
            isCore: true,
        },

        ACKNOWLEDGMENT: {
            name: 'Confirmación',
            order: 4,
            category: 'outcome',
            description: 'Stage core de Notification Workflow',
            transitions_to: [],
            isCore: true,
        },

        GET_THREADS: {
            name: 'Get Threads',
            order: 5,
            category: 'lookup',
            description: 'Auto-detectado desde NotificationUnifiedService.getThreads()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'getThreads',
                line: 64
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CREATE_THREAD: {
            name: 'Create Thread',
            order: 6,
            category: 'persistence',
            description: 'Auto-detectado desde NotificationUnifiedService.createThread()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'createThread',
                line: 141
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_THREAD_MESSAGES: {
            name: 'Get Thread Messages',
            order: 7,
            category: 'lookup',
            description: 'Auto-detectado desde NotificationUnifiedService.getThreadMessages()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'getThreadMessages',
                line: 179
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        SEND: {
            name: 'Send',
            order: 8,
            category: 'notification',
            description: 'Auto-detectado desde NotificationUnifiedService.send()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'send',
                line: 226
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_FOR_USER: {
            name: 'Get For User',
            order: 9,
            category: 'lookup',
            description: 'Auto-detectado desde NotificationUnifiedService.getForUser()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'getForUser',
                line: 371
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_STATS: {
            name: 'Get Stats',
            order: 10,
            category: 'lookup',
            description: 'Auto-detectado desde NotificationUnifiedService.getStats()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'getStats',
                line: 442
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        PROCESS_ACTION: {
            name: 'Process Action',
            order: 11,
            category: 'process',
            description: 'Auto-detectado desde NotificationUnifiedService.processAction()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'processAction',
                line: 517
            },
            validations: ["notification"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        RESOLVE_APPROVER_BY_HIERARCHY: {
            name: 'Resolve Approver By Hierarchy',
            order: 12,
            category: 'decision',
            description: 'Auto-detectado desde NotificationUnifiedService.resolveApproverByHierarchy()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'resolveApproverByHierarchy',
                line: 607
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_COMPLETE_ESCALATION_CHAIN: {
            name: 'Get Complete Escalation Chain',
            order: 13,
            category: 'lookup',
            description: 'Auto-detectado desde NotificationUnifiedService.getCompleteEscalationChain()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'getCompleteEscalationChain',
                line: 730
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        PROCESS_WORKFLOW_STEP: {
            name: 'Process Workflow Step',
            order: 14,
            category: 'process',
            description: 'Auto-detectado desde NotificationUnifiedService.processWorkflowStep()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'processWorkflowStep',
                line: 830
            },
            validations: ["workflow"],
            transitions_to: ["FAILED"],
            isAutoGenerated: true,
        },

        SEND_FROM_TEMPLATE: {
            name: 'Send From Template',
            order: 15,
            category: 'notification',
            description: 'Auto-detectado desde NotificationUnifiedService.sendFromTemplate()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'sendFromTemplate',
                line: 1075
            },
            validations: ["template"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        SEND_FROM_APONNT: {
            name: 'Send From Aponnt',
            order: 16,
            category: 'notification',
            description: 'Auto-detectado desde NotificationUnifiedService.sendFromAponnt()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'sendFromAponnt',
                line: 1127
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        SEND_TO_APONNT: {
            name: 'Send To Aponnt',
            order: 17,
            category: 'notification',
            description: 'Auto-detectado desde NotificationUnifiedService.sendToAponnt()',
            source: {
                file: 'NotificationUnifiedService.js',
                function: 'sendToAponnt',
                line: 1175
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        EXECUTE_ALL_RULES: {
            name: 'Execute All Rules',
            order: 18,
            category: 'process',
            description: 'Auto-detectado desde ProactiveNotificationService.executeAllRules()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'executeAllRules',
                line: 69
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        EXECUTE_RULE: {
            name: 'Execute Rule',
            order: 19,
            category: 'process',
            description: 'Auto-detectado desde ProactiveNotificationService.executeRule()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'executeRule',
                line: 123
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CHECK_VACATION_EXPIRY: {
            name: 'Check Vacation Expiry',
            order: 20,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.checkVacationExpiry()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'checkVacationExpiry',
                line: 193
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CHECK_OVERTIME_LIMIT: {
            name: 'Check Overtime Limit',
            order: 21,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.checkOvertimeLimit()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'checkOvertimeLimit',
                line: 231
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CHECK_REST_VIOLATION_RISK: {
            name: 'Check Rest Violation Risk',
            order: 22,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.checkRestViolationRisk()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'checkRestViolationRisk',
                line: 273
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CHECK_DOCUMENT_EXPIRY: {
            name: 'Check Document Expiry',
            order: 23,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.checkDocumentExpiry()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'checkDocumentExpiry',
                line: 322
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CHECK_CERTIFICATE_EXPIRY: {
            name: 'Check Certificate Expiry',
            order: 24,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.checkCertificateExpiry()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'checkCertificateExpiry',
                line: 361
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CHECK_CONSENT_RENEWAL: {
            name: 'Check Consent Renewal',
            order: 25,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.checkConsentRenewal()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'checkConsentRenewal',
                line: 402
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        EXECUTE_AUTO_ACTION: {
            name: 'Execute Auto Action',
            order: 26,
            category: 'process',
            description: 'Auto-detectado desde ProactiveNotificationService.executeAutoAction()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'executeAutoAction',
                line: 466
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CREATE_NOTIFICATIONS: {
            name: 'Create Notifications',
            order: 27,
            category: 'persistence',
            description: 'Auto-detectado desde ProactiveNotificationService.createNotifications()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'createNotifications',
                line: 499
            },
            validations: ["matches.length === 0"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        FIND_EXISTING_THREAD: {
            name: 'Find Existing Thread',
            order: 28,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.findExistingThread()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'findExistingThread',
                line: 579
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_SUPERVISOR_FROM_HIERARCHY: {
            name: 'Get Supervisor From Hierarchy',
            order: 29,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.getSupervisorFromHierarchy()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'getSupervisorFromHierarchy',
                line: 644
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_ESCALATION_CHAIN_FROM_HIERARCHY: {
            name: 'Get Escalation Chain From Hierarchy',
            order: 30,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.getEscalationChainFromHierarchy()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'getEscalationChainFromHierarchy',
                line: 660
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CHECK_SUPERVISOR_AVAILABILITY: {
            name: 'Check Supervisor Availability',
            order: 31,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.checkSupervisorAvailability()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'checkSupervisorAvailability',
                line: 677
            },
            validations: ["result || result.length === 0","supervisor.is_on_sick_leave","supervisor.is_on_vacation","supervisor.has_attendance_today"],
            transitions_to: ["COMPLETED"],
            isAutoGenerated: true,
        },

        FIND_R_R_H_H_BY_POSITION: {
            name: 'Find R R H H By Position',
            order: 32,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.findRRHHByPosition()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'findRRHHByPosition',
                line: 760
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        ESCALATE_TO_NEXT_LEVEL: {
            name: 'Escalate To Next Level',
            order: 33,
            category: 'escalation',
            description: 'Auto-detectado desde ProactiveNotificationService.escalateToNextLevel()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'escalateToNextLevel',
                line: 1010
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CREATE_ESCALATED_NOTIFICATION: {
            name: 'Create Escalated Notification',
            order: 34,
            category: 'persistence',
            description: 'Auto-detectado desde ProactiveNotificationService.createEscalatedNotification()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'createEscalatedNotification',
                line: 1066
            },
            validations: ["originalNotif.length"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        CAN_APPROVE_FROM_HIERARCHY: {
            name: 'Can Approve From Hierarchy',
            order: 35,
            category: 'decision',
            description: 'Auto-detectado desde ProactiveNotificationService.canApproveFromHierarchy()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'canApproveFromHierarchy',
                line: 1127
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_SUBORDINATES_FROM_HIERARCHY: {
            name: 'Get Subordinates From Hierarchy',
            order: 36,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.getSubordinatesFromHierarchy()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'getSubordinatesFromHierarchy',
                line: 1149
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        NOTIFY_ENTIRE_CHAIN: {
            name: 'Notify Entire Chain',
            order: 37,
            category: 'notification',
            description: 'Auto-detectado desde ProactiveNotificationService.notifyEntireChain()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'notifyEntireChain',
                line: 1167
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        UPDATE_GROUP_METADATA: {
            name: 'Update Group Metadata',
            order: 38,
            category: 'process',
            description: 'Auto-detectado desde ProactiveNotificationService.updateGroupMetadata()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'updateGroupMetadata',
                line: 1243
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        SEND_ALERTS: {
            name: 'Send Alerts',
            order: 39,
            category: 'notification',
            description: 'Auto-detectado desde ProactiveNotificationService.sendAlerts()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'sendAlerts',
                line: 1262
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        UPDATE_LAST_CHECKED: {
            name: 'Update Last Checked',
            order: 40,
            category: 'validation',
            description: 'Auto-detectado desde ProactiveNotificationService.updateLastChecked()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'updateLastChecked',
                line: 1312
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_ACTIVE_RULES: {
            name: 'Get Active Rules',
            order: 41,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.getActiveRules()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'getActiveRules',
                line: 1328
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CREATE_RULE: {
            name: 'Create Rule',
            order: 42,
            category: 'persistence',
            description: 'Auto-detectado desde ProactiveNotificationService.createRule()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'createRule',
                line: 1348
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        UPDATE_RULE: {
            name: 'Update Rule',
            order: 43,
            category: 'process',
            description: 'Auto-detectado desde ProactiveNotificationService.updateRule()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'updateRule',
                line: 1390
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_EXECUTION_HISTORY: {
            name: 'Get Execution History',
            order: 44,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.getExecutionHistory()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'getExecutionHistory',
                line: 1446
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_PROACTIVE_DASHBOARD: {
            name: 'Get Proactive Dashboard',
            order: 45,
            category: 'lookup',
            description: 'Auto-detectado desde ProactiveNotificationService.getProactiveDashboard()',
            source: {
                file: 'ProactiveNotificationService.js',
                function: 'getProactiveDashboard',
                line: 1466
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        DELIVERED: {
            name: 'Entregada',
            order: 46,
            category: 'success',
            description: 'Estado final',
            transitions_to: [],
            is_final: true,
            is_success: true,
        },

        FAILED: {
            name: 'Fallida',
            order: 47,
            category: 'rejection',
            description: 'Estado final',
            transitions_to: [],
            is_final: true,
            is_rejection: true,
        },

        EXPIRED: {
            name: 'Expirada',
            order: 48,
            category: 'final',
            description: 'Estado final',
            transitions_to: [],
            is_final: true,
        },

    };

    /**
     * WORKFLOW METADATA
     */
    static WORKFLOW_METADATA = {
        name: 'Notification Workflow',
        module: 'notifications',
        version: '2.0.20260203-auto',
        isAutoGenerated: true,
        generatedAt: '2026-02-03T05:34:48.310Z',
        sourceFiles: ["NotificationUnifiedService.js","ProactiveNotificationService.js"],
        entry_point: 'NOTIFICATION_CREATED',
        final_states: {
            success: ["DELIVERED"],
            rejection: ["FAILED"]
        },
        stats: {"total":48,"core":4,"existing":0,"autoGenerated":41,"outcomes":3}
    };

    /**
     * Obtener stages en orden
     */
    static getStagesInOrder() {
        return Object.entries(this.STAGES)
            .map(([key, stage]) => ({ key, ...stage }))
            .sort((a, b) => (a.order || 999) - (b.order || 999));
    }

    /**
     * Obtener stages finales
     */
    static getFinalStages() {
        return Object.entries(this.STAGES)
            .filter(([_, stage]) => stage.is_final)
            .map(([key, stage]) => ({ key, ...stage }));
    }

    /**
     * Validar transición
     */
    static isValidTransition(fromStage, toStage) {
        const from = this.STAGES[fromStage];
        if (!from || !from.transitions_to) return false;
        return from.transitions_to.includes(toStage);
    }

    /**
     * Obtener siguiente stage sugerido
     */
    static getNextSuggestedStage(currentStage) {
        const current = this.STAGES[currentStage];
        if (!current || !current.transitions_to || current.transitions_to.length === 0) return null;
        return current.transitions_to[0];
    }

    /**
     * Obtener tutorial steps para este workflow
     */
    static getTutorialSteps() {
        return this.getStagesInOrder()
            .filter(s => !s.is_final)
            .map((stage, index) => ({
                step: index + 1,
                stageId: stage.key,
                title: stage.name,
                description: stage.description || '',
                category: stage.category,
                validations: stage.validations || [],
                nextStages: stage.transitions_to || []
            }));
    }
}

module.exports = NotificationsWorkflowGenerated;
