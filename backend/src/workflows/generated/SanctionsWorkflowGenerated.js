/**
 * ============================================================================
 * SANCTIONS WORKFLOW - AUTO-GENERATED
 * ============================================================================
 *
 * ⚠️ ARCHIVO AUTO-GENERADO - NO EDITAR MANUALMENTE
 *
 * Este archivo es regenerado automáticamente por UniversalWorkflowGenerator
 * cuando cambia el código de los servicios relacionados.
 *
 * FUENTES:
 * * - SanctionsService.js
 * * - SanctionWorkflowService.js
 *
 * Brain detecta este archivo via LIVE_CODE_SCAN y extrae los STAGES.
 * Cualquier cambio en los servicios fuente regenerará este archivo.
 *
 * Generado: 2026-01-26T23:36:37.325Z
 * Versión: 2.0.20260126-auto
 * Módulo: sanctions
 *
 * ESTADÍSTICAS:
 * - Total stages: 19
 * - Core: 3
 * - Existentes: 0
 * - Auto-generados: 13
 * - Estados finales: 2
 *
 * ============================================================================
 */

class SanctionsWorkflowGenerated {
    /**
     * STAGES - Detectados automáticamente por Brain via LIVE_CODE_SCAN
     */
    static STAGES = {
        INCIDENT_REPORTED: {
            name: 'Incidente Reportado',
            order: 1,
            category: 'intake',
            description: 'Stage core de Sanctions Workflow',
            transitions_to: [],
            isCore: true,
        },

        INVESTIGATION: {
            name: 'Investigación',
            order: 2,
            category: 'process',
            description: 'Stage core de Sanctions Workflow',
            transitions_to: [],
            isCore: true,
        },

        DECISION: {
            name: 'Decisión',
            order: 3,
            category: 'outcome',
            description: 'Stage core de Sanctions Workflow',
            transitions_to: [],
            isCore: true,
        },

        GET_SANCTION_TYPES: {
            name: 'Get Sanction Types',
            order: 4,
            category: 'lookup',
            description: 'Auto-detectado desde SanctionWorkflowService.getSanctionTypes()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'getSanctionTypes',
                line: 81
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CREATE_SANCTION_TYPE: {
            name: 'Create Sanction Type',
            order: 5,
            category: 'persistence',
            description: 'Auto-detectado desde SanctionWorkflowService.createSanctionType()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'createSanctionType',
                line: 108
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        CREATE_SANCTION_REQUEST: {
            name: 'Create Sanction Request',
            order: 6,
            category: 'persistence',
            description: 'Auto-detectado desde SanctionWorkflowService.createSanctionRequest()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'createSanctionRequest',
                line: 145
            },
            validations: ["employee"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        LAWYER_APPROVE: {
            name: 'Lawyer Approve',
            order: 7,
            category: 'decision',
            description: 'Auto-detectado desde SanctionWorkflowService.lawyerApprove()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'lawyerApprove',
                line: 350
            },
            validations: ["sanction","sanction.workflow_status !== WORKFLOW_STATUS.PENDING_LAWYER"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        LAWYER_REJECT: {
            name: 'Lawyer Reject',
            order: 8,
            category: 'decision',
            description: 'Auto-detectado desde SanctionWorkflowService.lawyerReject()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'lawyerReject',
                line: 448
            },
            validations: ["sanction","sanction.workflow_status !== WORKFLOW_STATUS.PENDING_LAWYER"],
            transitions_to: ["FAILED"],
            isAutoGenerated: true,
        },

        LAWYER_MODIFY_DESCRIPTION: {
            name: 'Lawyer Modify Description',
            order: 9,
            category: 'process',
            description: 'Auto-detectado desde SanctionWorkflowService.lawyerModifyDescription()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'lawyerModifyDescription',
                line: 535
            },
            validations: ["sanction","sanction.workflow_status !== WORKFLOW_STATUS.PENDING_LAWYER"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_PENDING_REVIEWS: {
            name: 'Get Pending Reviews',
            order: 10,
            category: 'lookup',
            description: 'Auto-detectado desde SanctionWorkflowService.getPendingReviews()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'getPendingReviews',
                line: 930
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_EMPLOYEE_DISCIPLINARY_HISTORY: {
            name: 'Get Employee Disciplinary History',
            order: 11,
            category: 'lookup',
            description: 'Auto-detectado desde SanctionWorkflowService.getEmployeeDisciplinaryHistory()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'getEmployeeDisciplinaryHistory',
                line: 971
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_SANCTION_HISTORY: {
            name: 'Get Sanction History',
            order: 12,
            category: 'lookup',
            description: 'Auto-detectado desde SanctionWorkflowService.getSanctionHistory()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'getSanctionHistory',
                line: 1005
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_SANCTION_STATS: {
            name: 'Get Sanction Stats',
            order: 13,
            category: 'lookup',
            description: 'Auto-detectado desde SanctionWorkflowService.getSanctionStats()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'getSanctionStats',
                line: 1030
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_SANCTION_DETAIL: {
            name: 'Get Sanction Detail',
            order: 14,
            category: 'lookup',
            description: 'Auto-detectado desde SanctionWorkflowService.getSanctionDetail()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: 'getSanctionDetail',
                line: 1050
            },
            validations: ["sanction"],
            transitions_to: [],
            isAutoGenerated: true,
        },

        SEND_SANCTION_NOTIFICATION: {
            name: 'Send Sanction Notification',
            order: 15,
            category: 'notification',
            description: 'Auto-detectado desde SanctionWorkflowService._sendSanctionNotification()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: '_sendSanctionNotification',
                line: 1103
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        GET_USERS_BY_ROLE: {
            name: 'Get Users By Role',
            order: 16,
            category: 'lookup',
            description: 'Auto-detectado desde SanctionWorkflowService._getUsersByRole()',
            source: {
                file: 'SanctionWorkflowService.js',
                function: '_getUsersByRole',
                line: 1228
            },
            transitions_to: [],
            isAutoGenerated: true,
        },

        SANCTION_APPLIED: {
            name: 'Sanción Aplicada',
            order: 17,
            category: 'success',
            description: 'Estado final',
            transitions_to: [],
            is_final: true,
            is_success: true,
        },

        SANCTION_DISMISSED: {
            name: 'Sanción Desestimada',
            order: 18,
            category: 'rejection',
            description: 'Estado final',
            transitions_to: [],
            is_final: true,
            is_rejection: true,
        },

        APPEAL_PENDING: {
            name: 'Apelación Pendiente',
            order: 19,
            category: 'process',
            description: 'Estado final',
            transitions_to: [],
        },

    };

    /**
     * WORKFLOW METADATA
     */
    static WORKFLOW_METADATA = {
        name: 'Sanctions Workflow',
        module: 'sanctions',
        version: '2.0.20260126-auto',
        isAutoGenerated: true,
        generatedAt: '2026-01-26T23:36:37.325Z',
        sourceFiles: ["SanctionsService.js","SanctionWorkflowService.js"],
        entry_point: 'INCIDENT_REPORTED',
        final_states: {
            success: ["SANCTION_APPLIED"],
            rejection: ["SANCTION_DISMISSED"]
        },
        stats: {"total":19,"core":3,"existing":0,"autoGenerated":13,"outcomes":2}
    };

    /**
     * Obtener stages en orden
     */
    static getStagesInOrder() {
        return Object.entries(this.STAGES)
            .map(([key, stage]) => ({ key, ...stage }))
            .sort((a, b) => (a.order || 999) - (b.order || 999));
    }

    /**
     * Obtener stages finales
     */
    static getFinalStages() {
        return Object.entries(this.STAGES)
            .filter(([_, stage]) => stage.is_final)
            .map(([key, stage]) => ({ key, ...stage }));
    }

    /**
     * Validar transición
     */
    static isValidTransition(fromStage, toStage) {
        const from = this.STAGES[fromStage];
        if (!from || !from.transitions_to) return false;
        return from.transitions_to.includes(toStage);
    }

    /**
     * Obtener siguiente stage sugerido
     */
    static getNextSuggestedStage(currentStage) {
        const current = this.STAGES[currentStage];
        if (!current || !current.transitions_to || current.transitions_to.length === 0) return null;
        return current.transitions_to[0];
    }

    /**
     * Obtener tutorial steps para este workflow
     */
    static getTutorialSteps() {
        return this.getStagesInOrder()
            .filter(s => !s.is_final)
            .map((stage, index) => ({
                step: index + 1,
                stageId: stage.key,
                title: stage.name,
                description: stage.description || '',
                category: stage.category,
                validations: stage.validations || [],
                nextStages: stage.transitions_to || []
            }));
    }
}

module.exports = SanctionsWorkflowGenerated;
