{
  "timestamp": "2025-12-08T16:21:20.018Z",
  "companyId": 11,
  "categories": [
    {
      "category": "medical_tables_existence",
      "tests": [
        {
          "test": "table_user_medical_exams_exists",
          "passed": true,
          "details": "âœ… Tabla user_medical_exams existe"
        },
        {
          "test": "table_user_medical_exams_has_columns",
          "passed": true,
          "details": "ðŸ“Š user_medical_exams tiene 13 columnas",
          "columns": [
            "id",
            "user_id",
            "company_id",
            "exam_type",
            "exam_date",
            "result",
            "observations",
            "next_exam_date",
            "medical_center",
            "examining_doctor",
            "certificate_url",
            "created_at",
            "updated_at"
          ]
        },
        {
          "test": "table_user_work_restrictions_exists",
          "passed": true,
          "details": "âœ… Tabla user_work_restrictions existe"
        },
        {
          "test": "table_user_work_restrictions_has_columns",
          "passed": true,
          "details": "ðŸ“Š user_work_restrictions tiene 14 columnas",
          "columns": [
            "id",
            "user_id",
            "company_id",
            "restriction_type",
            "description",
            "start_date",
            "end_date",
            "is_permanent",
            "medical_certificate_url",
            "issuing_doctor",
            "affects_current_role",
            "accommodation_needed",
            "created_at",
            "updated_at"
          ]
        },
        {
          "test": "table_absence_cases_exists",
          "passed": true,
          "details": "âœ… Tabla absence_cases existe"
        },
        {
          "test": "table_absence_cases_has_columns",
          "passed": true,
          "details": "ðŸ“Š absence_cases tiene 30 columnas",
          "columns": [
            "id",
            "company_id",
            "employee_id",
            "absence_type",
            "start_date",
            "end_date",
            "requested_days",
            "approved_days",
            "assigned_doctor_id",
            "assignment_date",
            "case_status",
            "certificate_id",
            "employee_description",
            "employee_attachments",
            "medical_conclusion",
            "final_diagnosis",
            "is_justified",
            "justification_reason",
            "doctor_response_date",
            "case_closed_date",
            "closed_by",
            "notify_art",
            "art_notified",
            "art_notification_date",
            "art_case_number",
            "created_at",
            "updated_at",
            "created_by",
            "last_modified_by",
            "notification_group_id"
          ]
        },
        {
          "test": "table_medical_records_exists",
          "passed": true,
          "details": "âœ… Tabla medical_records existe"
        },
        {
          "test": "table_medical_records_has_columns",
          "passed": true,
          "details": "ðŸ“Š medical_records tiene 39 columnas",
          "columns": [
            "id",
            "company_id",
            "employee_id",
            "record_type",
            "template_id",
            "title",
            "description",
            "exam_date",
            "expiration_date",
            "result",
            "result_details",
            "observations",
            "restrictions",
            "attachments",
            "completed_studies",
            "submitted_documents",
            "digital_signature",
            "signature_timestamp",
            "signature_data",
            "signed_by",
            "editable_until",
            "is_locked",
            "locked_at",
            "locked_by",
            "locked_reason",
            "edit_count",
            "last_edited_by",
            "last_edited_at",
            "is_deleted",
            "deleted_at",
            "deleted_by",
            "deletion_reason",
            "deletion_authorized_by",
            "deletion_authorization_id",
            "created_by",
            "created_at",
            "updated_at",
            "metadata",
            "version"
          ]
        },
        {
          "test": "table_medical_certificates_exists",
          "passed": true,
          "details": "âœ… Tabla medical_certificates existe"
        },
        {
          "test": "table_medical_certificates_has_columns",
          "passed": true,
          "details": "ðŸ“Š medical_certificates tiene 73 columnas",
          "columns": [
            "id",
            "company_id",
            "user_id",
            "certificate_number",
            "issue_date",
            "start_date",
            "end_date",
            "requested_days",
            "diagnosis_code",
            "diagnosis",
            "symptoms",
            "has_visited_doctor",
            "medical_center",
            "attending_physician",
            "medical_prescription",
            "questionnaire",
            "status",
            "auditor_id",
            "auditor_response",
            "final_diagnosis",
            "diagnosis_category",
            "doctor_observations",
            "medical_recommendations",
            "follow_up_required",
            "follow_up_date",
            "treating_physician",
            "treating_physician_license",
            "medical_institution",
            "notify_art",
            "art_notified",
            "art_notification_date",
            "approved_days",
            "needs_audit",
            "is_justified",
            "audit_date",
            "attachments",
            "created_by",
            "last_modified_by",
            "created_at",
            "updated_at",
            "userId",
            "certificateNumber",
            "issueDate",
            "startDate",
            "endDate",
            "requestedDays",
            "diagnosisCode",
            "hasVisitedDoctor",
            "medicalCenter",
            "attendingPhysician",
            "medicalPrescription",
            "auditorId",
            "auditorResponse",
            "finalDiagnosis",
            "diagnosisCategory",
            "doctorObservations",
            "medicalRecommendations",
            "followUpRequired",
            "followUpDate",
            "treatingPhysician",
            "treatingPhysicianLicense",
            "medicalInstitution",
            "notifyART",
            "artNotified",
            "artNotificationDate",
            "approvedDays",
            "needsAudit",
            "isJustified",
            "auditDate",
            "createdBy",
            "lastModifiedBy",
            "createdAt",
            "updatedAt"
          ]
        },
        {
          "test": "table_user_documents_exists",
          "passed": true,
          "details": "âœ… Tabla user_documents existe"
        },
        {
          "test": "table_user_documents_has_columns",
          "passed": true,
          "details": "ðŸ“Š user_documents tiene 13 columnas",
          "columns": [
            "id",
            "user_id",
            "company_id",
            "document_type",
            "document_number",
            "issue_date",
            "expiration_date",
            "issuing_authority",
            "file_url",
            "is_verified",
            "notes",
            "created_at",
            "updated_at"
          ]
        }
      ],
      "passed": true
    },
    {
      "category": "check_constraints_mismatch",
      "tests": [
        {
          "test": "absence_cases.case_status_values",
          "passed": true,
          "details": "âœ… Todos los valores son vÃ¡lidos"
        },
        {
          "test": "medical_certificates.status_values",
          "passed": true,
          "details": "âœ… Todos los valores son vÃ¡lidos"
        }
      ],
      "passed": true
    },
    {
      "category": "medical_endpoint_validation",
      "tests": [
        {
          "test": "medical_endpoint_query_corrected",
          "passed": true,
          "details": "âœ… Query corregida funciona (10 filas)",
          "rowCount": 10
        },
        {
          "test": "corrected_query_status_values",
          "passed": true,
          "details": "âœ… Query corregido funciona (valores de case_status vÃ¡lidos)",
          "note": "Bug corregido en medicalCaseRoutes.js - usa valores correctos del CHECK constraint"
        }
      ],
      "passed": true
    },
    {
      "category": "absence_endpoint_validation",
      "tests": [
        {
          "test": "shift_assignments_query",
          "passed": true,
          "details": "âœ… 10 empleados con turno asignado"
        },
        {
          "test": "todays_attendance_query",
          "passed": true,
          "details": "âœ… 2 empleados presentes hoy"
        },
        {
          "test": "absence_calculation",
          "passed": true,
          "details": "âœ… CÃ¡lculo de ausentes correcto",
          "metrics": {
            "expectedToWork": 998,
            "present": 2,
            "absent": 997,
            "absenceRate": "99.90%"
          }
        }
      ],
      "passed": true
    },
    {
      "category": "referential_integrity",
      "tests": [
        {
          "test": "users_valid_department",
          "passed": true,
          "details": "âœ… Todos los usuarios tienen departamento vÃ¡lido"
        },
        {
          "test": "attendances_valid_user",
          "passed": true,
          "details": "âœ… Todas las asistencias tienen usuario vÃ¡lido"
        },
        {
          "test": "shift_assignments_valid",
          "passed": true,
          "details": "âœ… Todas las asignaciones de turno son vÃ¡lidas"
        }
      ],
      "passed": true
    },
    {
      "category": "enum_values_documentation",
      "tests": [
        {
          "test": "enum_absence_cases_absence_cases_absence_type_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ absence_cases: 8 valores permitidos",
          "allowedValues": [
            "medical_illness",
            "work_accident",
            "non_work_accident",
            "occupational_disease",
            "maternity",
            "family_care",
            "authorized_leave",
            "unauthorized"
          ],
          "constraint": "absence_cases_absence_type_check"
        },
        {
          "test": "enum_absence_cases_absence_cases_case_status_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ absence_cases: 7 valores permitidos",
          "allowedValues": [
            "pending",
            "under_review",
            "awaiting_docs",
            "needs_follow_up",
            "justified",
            "not_justified",
            "closed"
          ],
          "constraint": "absence_cases_case_status_check"
        },
        {
          "test": "enum_user_documents_user_documents_document_type_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ user_documents: 6 valores permitidos",
          "allowedValues": [
            "dni",
            "pasaporte",
            "licencia_conducir",
            "visa",
            "certificado_antecedentes",
            "otro"
          ],
          "constraint": "user_documents_document_type_check"
        },
        {
          "test": "enum_user_medical_exams_user_medical_exams_exam_type_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ user_medical_exams: 5 valores permitidos",
          "allowedValues": [
            "preocupacional",
            "periodico",
            "reingreso",
            "retiro",
            "especial"
          ],
          "constraint": "user_medical_exams_exam_type_check"
        },
        {
          "test": "enum_user_medical_exams_user_medical_exams_result_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ user_medical_exams: 4 valores permitidos",
          "allowedValues": [
            "apto",
            "apto_con_observaciones",
            "no_apto",
            "pendiente"
          ],
          "constraint": "user_medical_exams_result_check"
        },
        {
          "test": "enum_vacation_requests_vacation_requests_request_type_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ vacation_requests: 8 valores permitidos",
          "allowedValues": [
            "vacation",
            "personal_leave",
            "sick_leave",
            "maternity",
            "paternity",
            "bereavement",
            "study",
            "other"
          ],
          "constraint": "vacation_requests_request_type_check"
        },
        {
          "test": "enum_vacation_requests_vacation_requests_source_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ vacation_requests: 5 valores permitidos",
          "allowedValues": [
            "web",
            "mobile-apk",
            "mobile_app",
            "manual",
            "system"
          ],
          "constraint": "vacation_requests_source_check"
        },
        {
          "test": "enum_vacation_requests_vacation_requests_status_check",
          "passed": true,
          "isInfo": true,
          "details": "ðŸ“‹ vacation_requests: 5 valores permitidos",
          "allowedValues": [
            "pending",
            "approved",
            "rejected",
            "cancelled",
            "completed"
          ],
          "constraint": "vacation_requests_status_check"
        }
      ],
      "passed": true
    }
  ],
  "totalTests": 30,
  "passed": 30,
  "failed": 0,
  "warnings": 0,
  "successRate": "100.0"
}